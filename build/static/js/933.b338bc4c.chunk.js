"use strict";(self.webpackChunkmoviea=self.webpackChunkmoviea||[]).push([[933],{8002:(e,i,l)=>{l.d(i,{Z:()=>n});var s=l(7313),a=l(6417);const n=function(e){const[i,l]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{let i=!0;l(!1);const s=new Image;return s.onload=()=>{i&&l(!0)},s.src=e.src,()=>{i=!1,s.onload=null}}),[e.src]),(0,a.jsxs)(a.Fragment,{children:[!i&&(0,a.jsx)("div",{className:"skeleton-box"}),i&&(0,a.jsx)("img",{src:e.src,...e})]})}},9625:(e,i,l)=>{l.d(i,{Z:()=>n});var s=l(7313),a=l(6417);const n=function(e){let{text:i,max:l}=e;const[n,o]=(0,s.useState)(!1);return(0,a.jsxs)("p",{className:"reviewText",children:[n?i:null===i||void 0===i?void 0:i.substring(0,l)," ",(null===i||void 0===i?void 0:i.length)>=l&&(0,a.jsx)("span",{onClick:()=>o(!n),className:"showMoreBtn",children:n?"See less":"... See more"})]})}},8491:(e,i,l)=>{l.d(i,{Z:()=>v});var s=l(7313),a=l(2855),n=l(2135),o=l(9625),t=l(2539),d=l(3749),r=l(3283),c=l(2036),u=l(6417);const v=function(e){var i,l,v,m,h,p,x,g,j,w;let{review:f,user:y,level:b,currentUser:N}=e;const S=y||N||{name:null===f||void 0===f?void 0:f.name,picture:null===f||void 0===f?void 0:f.picture,profileBase64:null},[k,C]=(0,s.useState)(!1);return(0,u.jsxs)("div",{className:"Review",children:[k&&(0,u.jsxs)("div",{className:"optionsHolder",children:[(0,u.jsxs)("div",{onClick:()=>{C(!1)},children:[(0,u.jsx)(t.U$P,{})," Edit Review"]}),(0,u.jsxs)("div",{onClick:()=>{(async()=>{C(!1),await(0,d.oe)((0,d.JU)(r.db,"reviews",f.id)),c.Am.success("Review Deleted \ud83d\ude0a !",{position:"bottom-left",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"})})()},children:[(0,u.jsx)(t.ZkW,{})," Delete Review"]}),(0,u.jsxs)("div",{onClick:()=>{C(!1)},children:[(0,u.jsx)(t.KQY,{})," Share Review"]})]}),(0,u.jsxs)("div",{className:"ReviewHeader",children:[(0,u.jsxs)("span",{children:[(0,u.jsx)("img",{src:(null===S||void 0===S?void 0:S.profileBase64)||(null===S||void 0===S?void 0:S.picture)||"https://via.placeholder.com/40",alt:(null===S||void 0===S?void 0:S.name)||"User"}),(0,u.jsxs)("span",{children:[(0,u.jsx)("h1",{children:null!==S&&void 0!==S&&null!==(i=S.name)&&void 0!==i&&i.includes("@")?null===S||void 0===S?void 0:S.nickname:(null===S||void 0===S?void 0:S.name)||"Anonymous"}),(0,u.jsx)("h2",{children:(new Date).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})==(null===f||void 0===f?void 0:f.date)?"Today, "+(null===f||void 0===f?void 0:f.time):null===f||void 0===f||null===(l=f.date)||void 0===l?void 0:l.slice((null===f||void 0===f||null===(v=f.date)||void 0===v?void 0:v.indexOf(","))+1)})]})]}),"user"!==b&&(0,u.jsxs)("div",{className:"optionsBtn",onClick:()=>C(!k),children:[(0,u.jsx)("span",{}),!k&&(0,u.jsx)("span",{}),(0,u.jsx)("span",{})]}),"user"===b&&(0,u.jsxs)("div",{className:"optionsBtn",children:[(0,u.jsx)("span",{}),(0,u.jsx)("span",{}),(0,u.jsx)("span",{})]})]}),(0,u.jsx)(o.Z,{text:(null===f||void 0===f?void 0:f.reviewText)||(null===f||void 0===f?void 0:f.content),max:80}),(null===f||void 0===f||null===(m=f.selectedMedia)||void 0===m?void 0:m.backdrop_path)&&(0,u.jsx)("img",{src:a.Z.image_api+f.selectedMedia.backdrop_path,className:"mediaImage",alt:(null===f||void 0===f||null===(h=f.selectedMedia)||void 0===h?void 0:h.title)||(null===f||void 0===f||null===(p=f.selectedMedia)||void 0===p?void 0:p.name)||"Media"}),(0,u.jsxs)("div",{className:"mediaInfoHolder",children:[(0,u.jsxs)("span",{children:["movie"===(null===f||void 0===f?void 0:f.mediaType)?null===f||void 0===f||null===(x=f.selectedMedia)||void 0===x?void 0:x.title:(null===f||void 0===f||null===(g=f.selectedSeason)||void 0===g?void 0:g.name)||(null===f||void 0===f||null===(j=f.selectedMedia)||void 0===j?void 0:j.original_name)||(null===f||void 0===f?void 0:f.title),(null===f||void 0===f?void 0:f.mediaType)&&" (".concat(f.mediaType,")"),!(null!==f&&void 0!==f&&f.mediaType)&&(null===f||void 0===f?void 0:f.type)&&" (".concat(f.type,")")]}),(null===f||void 0===f?void 0:f.mediaType)&&(null===f||void 0===f||null===(w=f.selectedMedia)||void 0===w?void 0:w.id)&&(0,u.jsx)(n.rU,{to:"/all-about/".concat(f.mediaType,"/").concat(f.selectedMedia.id),children:"watch now"})]})]})}},3258:(e,i,l)=>{l.d(i,{Z:()=>n});var s=l(2135),a=(l(7313),l(6417));const n=function(e){var i;let{user:l,onFollow:n,onUnfollow:o,isFollowing:t}=e;const d=(null===l||void 0===l?void 0:l.uid)||(null===l||void 0===l?void 0:l.sub),r=(null===l||void 0===l?void 0:l.displayName)||(null===l||void 0===l?void 0:l.name)||(null===l||void 0===l||null===(i=l.email)||void 0===i?void 0:i.split("@")[0]),c=(null===l||void 0===l?void 0:l.photoURL)||(null===l||void 0===l?void 0:l.profileBase64)||(null===l||void 0===l?void 0:l.picture)||"https://via.placeholder.com/150";return(0,a.jsxs)("div",{className:"userCard",children:[(0,a.jsx)("img",{src:c,alt:r||"User"}),(0,a.jsx)("span",{children:null!==r&&void 0!==r&&r.includes("@")?(null===l||void 0===l?void 0:l.nickname)||(null===r||void 0===r?void 0:r.split("@")[0]):r}),t?(0,a.jsx)("a",{onClick:o,children:"Unfollow"}):(0,a.jsx)("a",{onClick:n,children:"Follow"}),(0,a.jsx)(s.rU,{to:"/user/".concat(d),children:"Profile"})]})}},6933:(e,i,l)=>{l.r(i),l.d(i,{default:()=>b});var s=l(7313),a=l(424),n=l(3283),o=l(4850),t=l(3749),d=l(1942),r=l(6367),c=l(2036),u=l(8002),v=(l(1962),l(3258)),m=l(8491),h=l(7211),p=l(2135),x=l(7864),g=l(2916),j=l(8821),w=l(2855),f=l(798),y=(l(8197),l(6417));const b=function(){var e,i,l,b,N,S,k,C;const{sub:T}=(0,a.UO)(),U=T?decodeURIComponent(T):T,{currentUser:_,userProfile:I,updateUserProfile:B,logout:R,loginWithGoogle:M}=(0,o.aC)(),L=(0,a.s0)(),D=(0,r.useMediaQuery)({query:"(max-width: 563px)"}),[F,E]=(0,s.useState)({}),[A,P]=(0,s.useState)([]),[Z,H]=(0,s.useState)(!1),[J,W]=(0,s.useState)([]),[Y,O]=(0,s.useState)(!1),[V,G]=(0,s.useState)(!1),[z,K]=(0,s.useState)([]),[Q,q]=(0,s.useState)(!1),[$,X]=(0,s.useState)(""),[ee,ie]=(0,s.useState)(""),[le,se]=(0,s.useState)([]),[ae,ne]=(0,s.useState)(""),[oe,te]=(0,s.useState)([]),[de,re]=(0,s.useState)(!1),[ce,ue]=(0,s.useState)(""),[ve,me]=(0,s.useState)(""),[he,pe]=(0,s.useState)("movie"),[xe,ge]=(0,s.useState)(5),[je,we]=(0,s.useState)({}),[fe,ye]=(0,s.useState)({}),[be,Ne]=(0,s.useState)(""),[Se,ke]=(0,s.useState)([]),[Ce,Te]=(0,s.useState)(!1),[Ue,_e]=(0,s.useState)(null),[Ie,Be]=(0,s.useState)(""),[Re,Me]=(0,s.useState)(!1),[Le,De]=(0,s.useState)(""),[Fe,Ee]=(0,s.useState)(""),[Ae,Pe]=(0,s.useState)([]),[Ze,He]=(0,s.useState)([]),[Je,We]=(0,s.useState)(!1),{data:Ye}=(0,d.z)(w.Z.fetchTrending,(e=>[e.results[Math.floor(Math.random()*e.results.length)]])),Oe=(0,s.useMemo)((()=>!U||_&&U===_.uid),[U,_]);(0,s.useEffect)((()=>{const e=new AbortController,i=e.signal,l=async()=>{if(Y){We(!0);try{const[e,l]=await Promise.all([f.Z.get("https://api.themoviedb.org/3/trending/movie/day?api_key=".concat(w.Z.apiKey),{signal:i,timeout:5e3}),f.Z.get("https://api.themoviedb.org/3/trending/tv/day?api_key=".concat(w.Z.apiKey),{signal:i,timeout:5e3})]),s=e.data.results.filter((e=>e&&e.id&&e.title&&e.poster_path)).slice(0,6).map((e=>({...e,mediaType:"movie"}))),a=l.data.results.filter((e=>e&&e.id&&e.name&&e.poster_path)).slice(0,6).map((e=>({...e,mediaType:"tv"})));i.aborted||(Pe(s),He(a))}catch(e){f.Z.isCancel(e)||(console.error("Error fetching trending media:",e),Ae.length||Ze.length||(Pe([]),He([])))}finally{i.aborted||We(!1)}}};return l(),window.fetchTrendingMedia=l,()=>{e.abort(),window.fetchTrendingMedia=null}}),[Y,Ae.length,Ze.length]),(0,s.useEffect)((()=>{U&&_&&U!==_.uid&&L("/user/".concat(U))}),[U,_,L]),(0,s.useEffect)((()=>{(async()=>{if(!_&&!U)return void L("/login");const e=U||(null===_||void 0===_?void 0:_.uid);if(!e)return;null!==_&&void 0!==_&&_.displayName&&Be(_.displayName);const i=(0,t.IO)((0,t.hJ)(n.db,"users"),(0,t.ar)("uid","==",e)),l=(0,t.cf)(i,(i=>{if(i.docs.length>0){const e=i.docs[0].data();E(e),X(e.bio||"")}else console.log("No user found with uid:",e)})),s=(0,t.IO)((0,t.hJ)(n.db,"reviews"),(0,t.ar)("userId","==",e)),a=(0,t.cf)(s,(e=>{se(e.docs.map((e=>({...e.data(),id:e.id}))))}));if(Oe){const i=(0,t.IO)((0,t.hJ)(n.db,"users"),(0,t.b9)(5)),s=(0,t.cf)(i,(i=>{const l=i.docs.map((e=>({...e.data(),uid:e.data().uid||e.id,id:e.id}))).filter((i=>(i.uid||i.id)!==e)).slice(0,4);P(l)}));return()=>{l(),a(),s()}}})()}),[_,U,L,Oe]),(0,s.useEffect)((()=>{Ye&&Ye.length>0&&ye(Ye[0])}),[Ye]),(0,s.useEffect)((()=>{if(!_)return;const e=(0,t.JU)(n.db,"users",_.uid),i=(0,t.cf)(e,(e=>{e.exists()&&we(e.data())}));return()=>{i&&i()}}),[_]);const Ve=async()=>{if(_&&U)try{const e=(0,t.JU)(n.db,"users",_.uid);await(0,t.pl)(e,{followList:(0,t.vr)(U)},{merge:!0});const i=(0,t.JU)(n.db,"users",U);await(0,t.pl)(i,{followersList:(0,t.vr)(_.uid)},{merge:!0})}catch(Le){console.error("Error following user:",Le)}else M()},Ge=async()=>{if(_&&U)try{const e=(0,t.JU)(n.db,"users",_.uid),i=(0,t.JU)(n.db,"users",U);await(0,t.pl)(e,{followList:(0,t.Ab)(U)},{merge:!0}),await(0,t.pl)(i,{followersList:(0,t.Ab)(_.uid)},{merge:!0})}catch(Le){console.error("Error unfollowing user:",Le)}},ze=e=>{var i;return(null===je||void 0===je||null===(i=je.followList)||void 0===i?void 0:i.includes(e))||!1},Ke=async()=>{var e;!z.length&&null!==F&&void 0!==F&&null!==(e=F.followersList)&&void 0!==e&&e.length&&F.followersList.map((e=>(async e=>{const i=(0,t.JU)(n.db,"users",e);(0,t.QT)(i).then((e=>K((i=>[...i,e.data()]))))})(e))),G(!V)},Qe=async()=>{var e;!J.length&&null!==F&&void 0!==F&&null!==(e=F.followList)&&void 0!==e&&e.length&&F.followList.map((e=>(async e=>{const i=(0,t.JU)(n.db,"users",e);(0,t.QT)(i).then((e=>W((i=>[...i,e.data()]))))})(e))),H(!Z)},qe=e=>{_e(e),pe(e.mediaType),me("".concat(e.title||e.name," Review")),ke([]),Ne("")},$e=()=>{me(""),ue(""),pe("movie"),ge(5),_e(null),Ne(""),ke([]),O(!1)};return Oe||_?(0,y.jsxs)("div",{className:"UserProfilePage Account",children:[(0,y.jsx)(c.Ix,{position:"bottom-right",autoClose:3e3}),(0,y.jsx)(h.Z,{open:Z,style:{zIndex:99,padding:"1em"},onClick:()=>H(!1),children:(0,y.jsxs)("div",{className:"followingListHolder",children:[(0,y.jsx)("h1",{children:"Following"}),null===J||void 0===J?void 0:J.map(((e,i)=>{var l,s;return(0,y.jsxs)("div",{children:[(0,y.jsxs)("span",{children:[(0,y.jsx)("img",{src:(null===e||void 0===e?void 0:e.photoURL)||(null===e||void 0===e?void 0:e.picture)||(null===e||void 0===e?void 0:e.profileBase64),alt:(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.name)||"User"}),null!==(l=(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.name))&&void 0!==l&&l.includes("@")?null===e||void 0===e||null===(s=e.email)||void 0===s?void 0:s.split("@")[0]:(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.name)]}),(0,y.jsx)(p.rU,{to:"/user/".concat((null===e||void 0===e?void 0:e.uid)||(null===e||void 0===e?void 0:e.sub)),children:"View"})]},"following-".concat(i))})),!(null!==J&&void 0!==J&&J.length)&&"No following yet"]})}),(0,y.jsx)(h.Z,{open:V,style:{zIndex:99,padding:"1em"},onClick:()=>G(!1),children:(0,y.jsxs)("div",{className:"followingListHolder",children:[(0,y.jsx)("h1",{children:"Followers"}),null===z||void 0===z?void 0:z.map(((e,i)=>{var l,s;return(0,y.jsxs)("div",{children:[(0,y.jsxs)("span",{children:[(0,y.jsx)("img",{src:(null===e||void 0===e?void 0:e.photoURL)||(null===e||void 0===e?void 0:e.picture)||(null===e||void 0===e?void 0:e.profileBase64),alt:(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.name)||"User"}),null!==(l=(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.name))&&void 0!==l&&l.includes("@")?null===e||void 0===e||null===(s=e.email)||void 0===s?void 0:s.split("@")[0]:(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.name)]}),(0,y.jsx)(p.rU,{to:"/user/".concat((null===e||void 0===e?void 0:e.uid)||(null===e||void 0===e?void 0:e.sub)),children:"View"})]},"follower-".concat(i))})),!(null!==z&&void 0!==z&&z.length)&&"No followers yet"]})}),(0,y.jsxs)("div",{className:"accountHeader",children:[(0,y.jsx)("div",{className:"imageHolderAcc",children:(0,y.jsx)(u.Z,{src:w.Z.image_api+((null===fe||void 0===fe?void 0:fe.backdrop_path)||""),className:"accountHeaderImage",alt:"cover"})}),(0,y.jsx)("span",{className:"movieCoverTitle",children:(null===fe||void 0===fe?void 0:fe.title)||(null===fe||void 0===fe?void 0:fe.name)}),(0,y.jsxs)("div",{className:"profileInfosHolder",children:[(0,y.jsxs)("div",{className:"GlobalInfoHolder",children:[(0,y.jsxs)("div",{className:"profileImageContainer",children:[(0,y.jsx)("img",{src:ee||(null===F||void 0===F?void 0:F.profileBase64)||(null===F||void 0===F?void 0:F.photoURL)||(null===F||void 0===F?void 0:F.picture),alt:(null===F||void 0===F?void 0:F.displayName)||(null===F||void 0===F?void 0:F.name)||"User"}),Oe&&(0,y.jsx)("input",{id:"profileImageInput",type:"file",accept:"image/*",onChange:e=>{const i=e.target.files[0];if(!i)return;const l=new FileReader;l.onload=async e=>{if(ie(e.target.result),_)try{const i=(0,t.JU)(n.db,"users",_.uid);await(0,t.r7)(i,{profileBase64:e.target.result,updatedAt:(0,t.Bt)()}),c.Am.success("Profile image updated!")}catch(i){console.error("Error updating profile image:",i),c.Am.error("Error: ".concat(i.message))}},l.readAsDataURL(i)},style:{display:"none"}})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{children:(null===F||void 0===F?void 0:F.displayName)||(null===F||void 0===F?void 0:F.name)||(null===F||void 0===F?void 0:F.email)&&(null===F||void 0===F?void 0:F.email.split("@")[0])}),D&&!Oe&&(0,y.jsx)("div",{className:"loveBtn",onClick:()=>{var e;return null!==je&&void 0!==je&&null!==(e=je.followList)&&void 0!==e&&e.includes(U)?Ge():Ve()},children:null!==je&&void 0!==je&&null!==(e=je.followList)&&void 0!==e&&e.includes(U)?(0,y.jsxs)("span",{children:[(0,y.jsx)(x.M_L,{})," Followed"]}):(0,y.jsxs)("span",{children:[(0,y.jsx)(x.lo,{})," Follow"]})}),(0,y.jsxs)("h2",{children:[le.length," Reviews \u2022",(0,y.jsxs)("span",{className:"followingBtn",onClick:Ke,children:[(null===F||void 0===F||null===(i=F.followersList)||void 0===i?void 0:i.length)||"0"," followers"]})," \u2022",(0,y.jsxs)("span",{onClick:Qe,className:"followingBtn",children:[(null===F||void 0===F||null===(l=F.followList)||void 0===l?void 0:l.length)||"0"," following"]})]})]})]}),!D&&!Oe&&(0,y.jsx)("div",{className:"loveBtn",onClick:()=>{var e;return null!==je&&void 0!==je&&null!==(e=je.followList)&&void 0!==e&&e.includes(U)?Ge():Ve()},children:null!==je&&void 0!==je&&null!==(b=je.followList)&&void 0!==b&&b.includes(U)?(0,y.jsxs)("span",{children:[(0,y.jsx)(x.M_L,{})," Followed"]}):(0,y.jsxs)("span",{children:[(0,y.jsx)(x.lo,{})," Follow"]})}),Oe&&(0,y.jsx)("button",{className:"logoutButton",onClick:async()=>{try{await R(),L("/login")}catch(e){console.error("Error logging out:",e),c.Am.error("Failed to log out. Please try again.")}},children:"Logout"})]}),D&&(0,y.jsxs)("div",{className:"smallScreenInfoHolder",children:[(0,y.jsxs)("span",{children:[(0,y.jsx)("span",{children:le.length}),(0,y.jsx)("span",{children:"Reviews"})]}),(0,y.jsxs)("span",{onClick:Ke,children:[(0,y.jsx)("span",{children:(null===F||void 0===F||null===(N=F.followersList)||void 0===N?void 0:N.length)||"0"}),(0,y.jsx)("span",{children:"Followers"})]}),(0,y.jsxs)("span",{onClick:Qe,children:[(0,y.jsx)("span",{children:(null===F||void 0===F||null===(S=F.followList)||void 0===S?void 0:S.length)||"0"}),(0,y.jsx)("span",{children:"Following"})]})]})]}),(0,y.jsxs)("div",{className:"downSection",children:[(0,y.jsx)("div",{className:"sideSection",children:(0,y.jsxs)("div",{className:"stikcyWrapper",children:[(0,y.jsxs)("div",{className:"bioHolder",children:[(0,y.jsxs)("div",{className:"bioHeader",children:[(0,y.jsx)("h1",{children:"About"}),Oe&&(0,y.jsx)("button",{onClick:()=>q(!Q),className:"editBioBtn",children:(0,y.jsx)(g.vPQ,{})})]}),Q?(0,y.jsxs)("div",{className:"bioEditor",children:[(0,y.jsx)("textarea",{value:$,onChange:e=>X(e.target.value),placeholder:"Tell us about yourself...",maxLength:500}),(0,y.jsxs)("div",{className:"bioActions",children:[(0,y.jsx)("button",{onClick:()=>q(!1),children:"Cancel"}),(0,y.jsx)("button",{onClick:async()=>{if(_)try{Me(!0);const e=(0,t.JU)(n.db,"users",_.uid);await(0,t.r7)(e,{bio:$,updatedAt:(0,t.Bt)()}),q(!1),c.Am.success("Bio updated successfully!")}catch(e){console.error("Error updating bio:",e),c.Am.error("Error: ".concat(e.message))}finally{Me(!1)}else De("You must be logged in to update your profile")},disabled:Re,children:Re?"Saving...":"Save"})]})]}):(0,y.jsx)("p",{children:(null===F||void 0===F?void 0:F.bio)||"Hey, Welcome To Moviea. This profile has no bio yet."})]}),Oe&&(0,y.jsxs)("div",{className:"profileDetails",children:[(0,y.jsx)("h1",{children:"Profile Details"}),(0,y.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),_)try{Me(!0),De(""),Ee(""),await B({displayName:Ie}),c.Am.success("Profile updated successfully!"),Ee("Profile updated successfully!")}catch(i){console.error("Error updating profile:",i),De(i.message),c.Am.error("Error: ".concat(i.message))}finally{Me(!1)}else De("You must be logged in to update your profile")},children:[(0,y.jsxs)("div",{className:"formGroup",children:[(0,y.jsx)("label",{htmlFor:"displayName",children:"Display Name"}),(0,y.jsx)("input",{type:"text",id:"displayName",value:Ie,onChange:e=>Be(e.target.value),placeholder:"Display Name"})]}),(0,y.jsxs)("div",{className:"formGroup",children:[(0,y.jsx)("label",{htmlFor:"email",children:"Email"}),(0,y.jsx)("input",{type:"email",id:"email",value:(null===F||void 0===F?void 0:F.email)||"",disabled:!0,className:"disabledInput"}),(0,y.jsx)("small",{children:"Email cannot be changed"})]}),Le&&(0,y.jsx)("div",{className:"errorMessage",children:Le}),Fe&&(0,y.jsx)("div",{className:"successMessage",children:Fe}),(0,y.jsx)("button",{type:"submit",className:"updateProfileBtn",disabled:Re,children:Re?"Updating...":"Update Profile"})]})]}),(null===F||void 0===F||null===(k=F.recentlyWatched)||void 0===k?void 0:k.length)>=1&&"public"===(null===F||void 0===F?void 0:F.recentlyWatchedPrivacy)&&(0,y.jsxs)("div",{className:"latestHolder",children:[(0,y.jsx)("h1",{children:"Recently Watched"}),(0,y.jsx)("div",{className:"wrapperLatest",children:null===F||void 0===F||null===(C=F.recentlyWatched)||void 0===C?void 0:C.map(((e,i)=>(0,y.jsxs)(p.rU,{to:null===e||void 0===e?void 0:e.redirectToWatch,className:"latest",children:[(0,y.jsx)("img",{src:null===e||void 0===e?void 0:e.image,alt:"latest"}),(0,y.jsxs)("span",{children:[(null===e||void 0===e?void 0:e.nameWhenTn)||(null===e||void 0===e?void 0:e.name),e.episode?" Ep - "+e.episode:""]}),(0,y.jsx)(x.Wxs,{})]},i)))})]}),Oe&&A.length>0&&(0,y.jsxs)("div",{className:"suggestedUsers",children:[(0,y.jsx)("h1",{children:"Suggested Users"}),(0,y.jsx)("div",{className:"suggestedUsersList",children:A.map((e=>{const i=e.uid||e.id;return(0,y.jsx)(v.Z,{user:e,onFollow:()=>(async e=>{if(_)if(e)try{const i=(0,t.JU)(n.db,"users",_.uid);await(0,t.pl)(i,{followList:(0,t.vr)(e)},{merge:!0});const l=(0,t.JU)(n.db,"users",e);await(0,t.pl)(l,{followersList:(0,t.vr)(_.uid)},{merge:!0})}catch(Le){console.error("Error following user:",Le)}else console.error("User ID is undefined");else M()})(i),onUnfollow:()=>(async e=>{if(_&&e)try{const i=(0,t.JU)(n.db,"users",_.uid),l=(0,t.JU)(n.db,"users",e);await(0,t.pl)(i,{followList:(0,t.Ab)(e)},{merge:!0}),await(0,t.pl)(l,{followersList:(0,t.Ab)(_.uid)},{merge:!0})}catch(Le){console.error("Error unfollowing user:",Le)}})(i),isFollowing:ze(i)},i)}))})]})]})}),(0,y.jsxs)("div",{className:"reviewSection",children:["          ",Oe&&(0,y.jsx)("div",{className:"createReviewBtnContainer",children:(0,y.jsxs)("button",{className:"createReviewBtn",onClick:()=>O(!0),children:[(0,y.jsx)(j.Kix,{className:"createReviewBtnIcon"})," Write a Review"]})}),(0,y.jsx)(h.Z,{open:Y,className:"reviewBackdrop",onClick:()=>$e(),style:{animation:Y?"fadeIn 0.3s":"none"},"aria-modal":"true","aria-label":"Create Review Modal",children:(0,y.jsxs)("div",{className:"createReview",onClick:e=>e.stopPropagation(),tabIndex:-1,style:{animation:Y?"fadeIn 0.3s":"none"},children:[(0,y.jsxs)("div",{className:"createReviewHeader",children:[(0,y.jsx)("img",{src:(null===F||void 0===F?void 0:F.profileBase64)||(null===F||void 0===F?void 0:F.photoURL)||(null===F||void 0===F?void 0:F.picture),alt:(null===F||void 0===F?void 0:F.displayName)||(null===F||void 0===F?void 0:F.name)||"User"}),(0,y.jsx)("h3",{className:"createReviewPrompt",children:"What did you watch?"})]}),(0,y.jsxs)("div",{className:"tmdbSearchContainer",children:[(0,y.jsx)("h3",{children:"Search for a Movie or TV Show"}),(0,y.jsxs)("div",{className:"tmdbSearchBar",children:[(0,y.jsx)("input",{type:"text",value:be,onChange:e=>{const i=e.target.value;Ne(i),window.tmdbSearchTimeout&&clearTimeout(window.tmdbSearchTimeout),window.tmdbSearchTimeout=setTimeout((()=>{!async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;if(e.trim()){Te(!0);try{const i=(await f.Z.get("https://api.themoviedb.org/3/search/multi?api_key=20108f1c4ed38f7457c479849a9999cc&query=".concat(encodeURIComponent(e)))).data.results.filter((e=>"movie"===e.media_type||"tv"===e.media_type)).map((e=>({...e,mediaType:e.media_type}))).slice(0,10);ke(i)}catch(i){console.error("TMDB Search error:",i),c.Am.error("Error searching TMDB. Please try again.")}finally{Te(!1)}}else ke([])}(i)}),500)},placeholder:"Search TMDB for movies and TV shows...",disabled:Ue,"aria-label":"Search TMDB",autoFocus:!0}),Ce&&(0,y.jsx)("div",{className:"searchSpinner","aria-label":"Searching"})]}),Ce&&(0,y.jsx)("div",{className:"tmdbSearching",children:"Searching..."}),"                ",!Ue&&0===Se.length&&!be&&(0,y.jsx)("div",{className:"trendingSuggestionsContainer",children:Je?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h4",{children:"Loading Popular Content"}),(0,y.jsx)("div",{className:"trendingItemsGrid",children:[...Array(6)].map(((e,i)=>(0,y.jsx)("div",{className:"trendingItemSkeleton",style:{animationDelay:"".concat(.1*i,"s")}},"skeleton-".concat(i))))}),(0,y.jsx)("div",{style:{marginTop:"15px"}}),(0,y.jsx)("div",{className:"trendingItemsGrid",children:[...Array(6)].map(((e,i)=>(0,y.jsx)("div",{className:"trendingItemSkeleton",style:{animationDelay:"".concat(.1*(i+6),"s")}},"skeleton-tv-".concat(i))))})]}):(0,y.jsxs)(y.Fragment,{children:[Ae.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("h4",{children:[(0,y.jsx)("i",{className:"fa fa-film",style:{marginRight:"7px"},"aria-hidden":"true"}),"Popular Movies"]}),(0,y.jsx)("div",{className:"trendingItemsGrid",children:Ae.map(((e,i)=>(0,y.jsxs)("div",{className:"trendingItem",onClick:()=>qe(e),tabIndex:0,"aria-label":"Select movie ".concat(e.title),onKeyDown:i=>{"Enter"!==i.key&&" "!==i.key||(i.preventDefault(),qe(e))},style:{animationDelay:"".concat(.05*i,"s"),outline:"none"},onFocus:e=>e.currentTarget.style.boxShadow="0 0 0 2px rgba(4, 28, 50, 0.5)",onBlur:e=>e.currentTarget.style.boxShadow="0 3px 8px rgba(0,0,0,0.12)",children:[(0,y.jsx)("img",{src:e.poster_path?"https://image.tmdb.org/t/p/w154".concat(e.poster_path):"https://via.placeholder.com/154x231?text=No+Image",alt:e.title,loading:"lazy"}),(0,y.jsxs)("div",{className:"trendingItemOverlay",children:[(0,y.jsx)("h5",{children:e.title}),(0,y.jsxs)("p",{children:[(0,y.jsx)("span",{className:"yearBadge",children:e.release_date?new Date(e.release_date).getFullYear():"Unknown"}),(0,y.jsx)("span",{className:"mediaTypeBadge",children:"Movie"}),e.vote_average>0&&(0,y.jsxs)("span",{className:"ratingBadge",children:["\u2605 ",e.vote_average.toFixed(1)]})]})]})]},"movie-".concat(e.id))))})]}),Ze.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:{height:"1px",background:"rgba(4, 28, 50, 0.08)",margin:"18px 0 15px"},"aria-hidden":"true"}),(0,y.jsxs)("h4",{style:{marginTop:"15px"},children:[(0,y.jsx)("i",{className:"fa fa-television",style:{marginRight:"7px"},"aria-hidden":"true"}),"Popular TV Shows"]}),(0,y.jsx)("div",{className:"trendingItemsGrid",children:Ze.map(((e,i)=>(0,y.jsxs)("div",{className:"trendingItem",onClick:()=>qe(e),tabIndex:0,"aria-label":"Select TV show ".concat(e.name),onKeyDown:i=>{"Enter"!==i.key&&" "!==i.key||(i.preventDefault(),qe(e))},style:{animationDelay:"".concat(.05*i,"s"),outline:"none"},onFocus:e=>e.currentTarget.style.boxShadow="0 0 0 2px rgba(4, 28, 50, 0.5)",onBlur:e=>e.currentTarget.style.boxShadow="0 3px 8px rgba(0,0,0,0.12)",children:[(0,y.jsx)("img",{src:e.poster_path?"https://image.tmdb.org/t/p/w154".concat(e.poster_path):"https://via.placeholder.com/154x231?text=No+Image",alt:e.name,loading:"lazy"}),(0,y.jsxs)("div",{className:"trendingItemOverlay",children:[(0,y.jsx)("h5",{children:e.name}),(0,y.jsxs)("p",{children:[(0,y.jsx)("span",{className:"yearBadge",children:e.first_air_date?new Date(e.first_air_date).getFullYear():"Unknown"}),(0,y.jsx)("span",{className:"mediaTypeBadge",children:"TV"}),e.vote_average>0&&(0,y.jsxs)("span",{className:"ratingBadge",children:["\u2605 ",e.vote_average.toFixed(1)]})]})]})]},"tv-".concat(e.id))))})]}),0===Ae.length&&0===Ze.length&&(0,y.jsxs)("div",{className:"noTrendingContent",children:[(0,y.jsx)("p",{children:"Unable to load trending content. Try searching for a title instead."}),"                            ",(0,y.jsx)("button",{onClick:()=>{We(!0),window.fetchTrendingMedia&&window.fetchTrendingMedia()},className:"retryButton",children:"Retry"})]})]})}),Se.length>0&&(0,y.jsx)("div",{className:"tmdbSearchResults",children:Se.map((e=>(0,y.jsxs)("div",{className:"tmdbSearchResultItem",onClick:()=>qe(e),tabIndex:0,"aria-label":"Select ".concat(e.title||e.name),onKeyDown:i=>{"Enter"===i.key&&qe(e)},children:[(0,y.jsx)("img",{src:e.poster_path?"https://image.tmdb.org/t/p/w92".concat(e.poster_path):"https://via.placeholder.com/92x138?text=No+Image",alt:e.title||e.name}),(0,y.jsxs)("div",{className:"tmdbMediaInfo",children:[(0,y.jsx)("h4",{children:e.title||e.name}),(0,y.jsxs)("p",{children:["movie"===e.mediaType?"Movie":"TV Show"," \u2022",e.release_date||e.first_air_date?new Date(e.release_date||e.first_air_date).getFullYear():"Unknown Year"]})]})]},"".concat(e.mediaType,"-").concat(e.id))))}),Le&&(0,y.jsx)("div",{className:"errorMessage",style:{color:"#e74c3c",marginTop:10},children:Le}),Ue&&(0,y.jsxs)("div",{className:"selectedMediaContainer","aria-live":"polite",children:[(0,y.jsxs)("h3",{children:["Selected ","movie"===Ue.mediaType?"Movie":"TV Show"]}),(0,y.jsxs)("div",{className:"selectedMediaItem",children:[(0,y.jsx)("img",{src:Ue.poster_path?"https://image.tmdb.org/t/p/w154".concat(Ue.poster_path):"https://via.placeholder.com/154x231?text=No+Image",alt:Ue.title||Ue.name,loading:"lazy"}),(0,y.jsxs)("div",{className:"selectedMediaInfo",children:[(0,y.jsx)("h4",{children:Ue.title||Ue.name}),(0,y.jsx)("p",{className:"selectedMediaYear",children:Ue.release_date||Ue.first_air_date?new Date(Ue.release_date||Ue.first_air_date).getFullYear():"Unknown Year"}),(0,y.jsx)("p",{className:"selectedMediaOverview",children:Ue.overview}),(0,y.jsx)("button",{className:"changeMediaBtn",onClick:()=>_e(null),"aria-label":"Change Selection",children:"Change Selection"})]})]})]})]}),Ue&&(0,y.jsx)("div",{className:"ReviewSteps",children:(0,y.jsxs)("div",{className:"reviewFormContent",children:[(0,y.jsxs)("div",{className:"ratingStarsContainer",children:[(0,y.jsx)("h4",{children:"Your Rating:"}),(0,y.jsxs)("div",{className:"ratingStars",children:[[1,2,3,4,5,6,7,8,9,10].map((e=>(0,y.jsx)("button",{className:"ratingStar ".concat(xe>=e?"active":""),onClick:()=>ge(e),"aria-label":"Set rating to ".concat(e),tabIndex:0,children:"\u2605"},e))),(0,y.jsxs)("span",{className:"ratingValue",children:[xe,"/10"]})]})]}),(0,y.jsx)("textarea",{value:ce,onChange:e=>ue(e.target.value),placeholder:"Write your review here... What did you like or dislike? How does this compare to other movies or shows you've seen?",rows:5,className:"reviewTextarea","aria-label":"Review Content"})]})}),(0,y.jsxs)("div",{className:"ReviewButtonHolder",children:[(0,y.jsx)("button",{onClick:()=>$e(),"aria-label":"Cancel Review",children:"Cancel"}),(0,y.jsx)("button",{onClick:async()=>{if(ve.trim()&&ce.trim())if(Ue)try{const e={title:ve,content:ce,type:Ue.mediaType,rating:xe,createdAt:(0,t.Bt)(),userId:_.uid,userDisplayName:F.displayName||F.name||_.email.split("@")[0],userProfilePic:F.profileBase64||F.photoURL||F.picture,mediaId:Ue.id,mediaType:Ue.mediaType,mediaTitle:Ue.title||Ue.name,mediaPoster:Ue.poster_path,mediaBackdrop:Ue.backdrop_path,mediaOverview:Ue.overview,mediaReleaseDate:Ue.release_date||Ue.first_air_date},i=(0,t.hJ)(n.db,"reviews");await(0,t.ET)(i,e),se([...le,{...e,createdAt:new Date}]),$e(),c.Am.success("Review posted successfully!")}catch(Le){console.error("Error posting review:",Le),c.Am.error("Failed to post review. Please try again.")}else c.Am.error("Please select a movie or TV show to review");else c.Am.error("Please fill in both title and content fields")},disabled:!Ue||!ce.trim(),"aria-label":"Submit Review",children:"Submit Review"})]})]})}),(0,y.jsxs)("div",{className:"reviewsHolder",children:[(0,y.jsx)("h1",{children:"Reviews"}),(0,y.jsxs)("div",{className:"reviewsContainer",children:[le.map(((e,i)=>(0,y.jsx)(m.Z,{level:"user",review:e,user:F},i))),!le.length&&(0,y.jsx)("div",{className:"noReviewHolder",children:Oe?"You haven't posted any reviews yet.":"This user hasn't posted any reviews yet."})]})]})]})]})]}):(L("/login"),null)}},1942:(e,i,l)=>{l.d(i,{z:()=>o});var s=l(7313),a=l(798);const n=new Map,o=(e,i)=>{const[l,o]=(0,s.useState)(null),[t,d]=(0,s.useState)(!0),[r,c]=(0,s.useState)(null),u=(0,s.useCallback)((async()=>{try{d(!0);const l=n.get(e);if(l&&Date.now()-l.timestamp<3e5)return o(l.data),void d(!1);const s=await a.Z.get(e),t=i?i(s.data):s.data;n.set(e,{data:t,timestamp:Date.now()}),o(t),c(null)}catch(l){c(l),console.error("Error fetching data:",l)}finally{d(!1)}}),[e,i]);(0,s.useEffect)((()=>{u()}),[u]);return{data:l,loading:t,error:r,refetch:(0,s.useCallback)((()=>{n.delete(e),u()}),[u,e])}}},8197:()=>{}}]);