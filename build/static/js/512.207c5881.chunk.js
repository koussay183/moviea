/*! For license information please see 512.207c5881.chunk.js.LICENSE.txt */
(self.webpackChunkmoviea=self.webpackChunkmoviea||[]).push([[512],{5296:(t,e,r)=>{"use strict";r.d(e,{Z:()=>it});var n=function(){function t(t){var e=this;this._insertTag=function(t){var r;r=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,r),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{r.insertRule(t,r.cssRules.length)}catch(n){0}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),this.tags=[],this.ctr=0},t}(),i=Math.abs,s=String.fromCharCode,a=Object.assign;function o(t){return t.trim()}function c(t,e,r){return t.replace(e,r)}function l(t,e){return t.indexOf(e)}function u(t,e){return 0|t.charCodeAt(e)}function h(t,e,r){return t.slice(e,r)}function d(t){return t.length}function f(t){return t.length}function p(t,e){return e.push(t),t}var g=1,m=1,v=0,y=0,b=0,E="";function w(t,e,r,n,i,s,a){return{value:t,root:e,parent:r,type:n,props:i,children:s,line:g,column:m,length:a,return:""}}function T(t,e){return a(w("",null,null,"",null,null,0),t,{length:-t.length},e)}function S(){return b=y>0?u(E,--y):0,m--,10===b&&(m=1,g--),b}function _(){return b=y<v?u(E,y++):0,m++,10===b&&(m=1,g++),b}function A(){return u(E,y)}function R(){return y}function C(t,e){return h(E,t,e)}function k(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function O(t){return g=m=1,v=d(E=t),y=0,[]}function I(t){return E="",t}function D(t){return o(C(y-1,P(91===t?t+2:40===t?t+1:t)))}function x(t){for(;(b=A())&&b<33;)_();return k(t)>2||k(b)>3?"":" "}function L(t,e){for(;--e&&_()&&!(b<48||b>102||b>57&&b<65||b>70&&b<97););return C(t,R()+(e<6&&32==A()&&32==_()))}function P(t){for(;_();)switch(b){case t:return y;case 34:case 39:34!==t&&39!==t&&P(b);break;case 40:41===t&&P(t);break;case 92:_()}return y}function N(t,e){for(;_()&&t+b!==57&&(t+b!==84||47!==A()););return"/*"+C(e,y-1)+"*"+s(47===t?t:_())}function M(t){for(;!k(A());)_();return C(t,y)}var F="-ms-",U="-moz-",B="-webkit-",j="comm",V="rule",G="decl",K="@keyframes";function H(t,e){for(var r="",n=f(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function z(t,e,r,n){switch(t.type){case"@layer":if(t.children.length)break;case"@import":case G:return t.return=t.return||t.value;case j:return"";case K:return t.return=t.value+"{"+H(t.children,n)+"}";case V:t.value=t.props.join(",")}return d(r=H(t.children,n))?t.return=t.value+"{"+r+"}":""}function q(t){return I(W("",null,null,null,[""],t=O(t),0,[0],t))}function W(t,e,r,n,i,a,o,h,f){for(var g=0,m=0,v=o,y=0,b=0,E=0,w=1,T=1,C=1,k=0,O="",I=i,P=a,F=n,U=O;T;)switch(E=k,k=_()){case 40:if(108!=E&&58==u(U,v-1)){-1!=l(U+=c(D(k),"&","&\f"),"&\f")&&(C=-1);break}case 34:case 39:case 91:U+=D(k);break;case 9:case 10:case 13:case 32:U+=x(E);break;case 92:U+=L(R()-1,7);continue;case 47:switch(A()){case 42:case 47:p(Z(N(_(),R()),e,r),f);break;default:U+="/"}break;case 123*w:h[g++]=d(U)*C;case 125*w:case 59:case 0:switch(k){case 0:case 125:T=0;case 59+m:-1==C&&(U=c(U,/\f/g,"")),b>0&&d(U)-v&&p(b>32?X(U+";",n,r,v-1):X(c(U," ","")+";",n,r,v-2),f);break;case 59:U+=";";default:if(p(F=Y(U,e,r,g,m,i,h,O,I=[],P=[],v),a),123===k)if(0===m)W(U,e,F,F,I,a,v,h,P);else switch(99===y&&110===u(U,3)?100:y){case 100:case 108:case 109:case 115:W(t,F,F,n&&p(Y(t,F,F,0,0,i,h,O,i,I=[],v),P),i,P,v,h,n?I:P);break;default:W(U,F,F,F,[""],P,0,h,P)}}g=m=b=0,w=C=1,O=U="",v=o;break;case 58:v=1+d(U),b=E;default:if(w<1)if(123==k)--w;else if(125==k&&0==w++&&125==S())continue;switch(U+=s(k),k*w){case 38:C=m>0?1:(U+="\f",-1);break;case 44:h[g++]=(d(U)-1)*C,C=1;break;case 64:45===A()&&(U+=D(_())),y=A(),m=v=d(O=U+=M(R())),k++;break;case 45:45===E&&2==d(U)&&(w=0)}}return a}function Y(t,e,r,n,s,a,l,u,d,p,g){for(var m=s-1,v=0===s?a:[""],y=f(v),b=0,E=0,T=0;b<n;++b)for(var S=0,_=h(t,m+1,m=i(E=l[b])),A=t;S<y;++S)(A=o(E>0?v[S]+" "+_:c(_,/&\f/g,v[S])))&&(d[T++]=A);return w(t,e,r,0===s?V:u,d,p,g)}function Z(t,e,r){return w(t,e,r,j,s(b),h(t,2,-2),0)}function X(t,e,r,n){return w(t,e,r,G,h(t,0,n),h(t,n+1,-1),n)}var Q=function(t,e,r){for(var n=0,i=0;n=i,i=A(),38===n&&12===i&&(e[r]=1),!k(i);)_();return C(t,y)},$=function(t,e){return I(function(t,e){var r=-1,n=44;do{switch(k(n)){case 0:38===n&&12===A()&&(e[r]=1),t[r]+=Q(y-1,e,r);break;case 2:t[r]+=D(n);break;case 4:if(44===n){t[++r]=58===A()?"&\f":"",e[r]=t[r].length;break}default:t[r]+=s(n)}}while(n=_());return t}(O(t),e))},J=new WeakMap,tt=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,r=t.parent,n=t.column===r.column&&t.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||J.get(r))&&!n){J.set(t,!0);for(var i=[],s=$(e,i),a=r.props,o=0,c=0;o<s.length;o++)for(var l=0;l<a.length;l++,c++)t.props[c]=i[o]?s[o].replace(/&\f/g,a[l]):a[l]+" "+s[o]}}},et=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}};function rt(t,e){switch(function(t,e){return 45^u(t,0)?(((e<<2^u(t,0))<<2^u(t,1))<<2^u(t,2))<<2^u(t,3):0}(t,e)){case 5103:return B+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return B+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return B+t+U+t+F+t+t;case 6828:case 4268:return B+t+F+t+t;case 6165:return B+t+F+"flex-"+t+t;case 5187:return B+t+c(t,/(\w+).+(:[^]+)/,B+"box-$1$2"+F+"flex-$1$2")+t;case 5443:return B+t+F+"flex-item-"+c(t,/flex-|-self/,"")+t;case 4675:return B+t+F+"flex-line-pack"+c(t,/align-content|flex-|-self/,"")+t;case 5548:return B+t+F+c(t,"shrink","negative")+t;case 5292:return B+t+F+c(t,"basis","preferred-size")+t;case 6060:return B+"box-"+c(t,"-grow","")+B+t+F+c(t,"grow","positive")+t;case 4554:return B+c(t,/([^-])(transform)/g,"$1"+B+"$2")+t;case 6187:return c(c(c(t,/(zoom-|grab)/,B+"$1"),/(image-set)/,B+"$1"),t,"")+t;case 5495:case 3959:return c(t,/(image-set\([^]*)/,B+"$1$`$1");case 4968:return c(c(t,/(.+:)(flex-)?(.*)/,B+"box-pack:$3"+F+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+B+t+t;case 4095:case 3583:case 4068:case 2532:return c(t,/(.+)-inline(.+)/,B+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(d(t)-1-e>6)switch(u(t,e+1)){case 109:if(45!==u(t,e+4))break;case 102:return c(t,/(.+:)(.+)-([^]+)/,"$1"+B+"$2-$3$1"+U+(108==u(t,e+3)?"$3":"$2-$3"))+t;case 115:return~l(t,"stretch")?rt(c(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==u(t,e+1))break;case 6444:switch(u(t,d(t)-3-(~l(t,"!important")&&10))){case 107:return c(t,":",":"+B)+t;case 101:return c(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+B+(45===u(t,14)?"inline-":"")+"box$3$1"+B+"$2$3$1"+F+"$2box$3")+t}break;case 5936:switch(u(t,e+11)){case 114:return B+t+F+c(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return B+t+F+c(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return B+t+F+c(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return B+t+F+t+t}return t}var nt=[function(t,e,r,n){if(t.length>-1&&!t.return)switch(t.type){case G:t.return=rt(t.value,t.length);break;case K:return H([T(t,{value:c(t.value,"@","@"+B)})],n);case V:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t,e){return(t=e.exec(t))?t[0]:t}(e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return H([T(t,{props:[c(e,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return H([T(t,{props:[c(e,/:(plac\w+)/,":"+B+"input-$1")]}),T(t,{props:[c(e,/:(plac\w+)/,":-moz-$1")]}),T(t,{props:[c(e,/:(plac\w+)/,F+"input-$1")]})],n)}return""}))}}],it=function(t){var e=t.key;if("css"===e){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var i=t.stylisPlugins||nt;var s,a,o={},c=[];s=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),r=1;r<e.length;r++)o[e[r]]=!0;c.push(t)}));var l,u,h=[z,(u=function(t){l.insert(t)},function(t){t.root||(t=t.return)&&u(t)})],d=function(t){var e=f(t);return function(r,n,i,s){for(var a="",o=0;o<e;o++)a+=t[o](r,n,i,s)||"";return a}}([tt,et].concat(i,h));a=function(t,e,r,n){l=r,H(q(t?t+"{"+e.styles+"}":e.styles),d),n&&(p.inserted[e.name]=!0)};var p={key:e,sheet:new n({key:e,container:s,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:a};return p.sheet.hydrate(c),p}},1816:(t,e,r)=>{"use strict";function n(t){var e=Object.create(null);return function(r){return void 0===e[r]&&(e[r]=t(r)),e[r]}}r.d(e,{Z:()=>n})},3346:(t,e,r)=>{"use strict";r.d(e,{T:()=>o,w:()=>a});var n=r(7313),i=r(5296),s=(r(1086),r(5696),n.createContext("undefined"!==typeof HTMLElement?(0,i.Z)({key:"css"}):null));s.Provider;var a=function(t){return(0,n.forwardRef)((function(e,r){var i=(0,n.useContext)(s);return t(e,i,r)}))};var o=n.createContext({})},1086:(t,e,r)=>{"use strict";r.d(e,{O:()=>p});var n={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},i=r(1816),s=/[A-Z]|^ms/g,a=/_EMO_([^_]+?)_([^]*?)_EMO_/g,o=function(t){return 45===t.charCodeAt(1)},c=function(t){return null!=t&&"boolean"!==typeof t},l=(0,i.Z)((function(t){return o(t)?t:t.replace(s,"-$&").toLowerCase()})),u=function(t,e){switch(t){case"animation":case"animationName":if("string"===typeof e)return e.replace(a,(function(t,e,r){return d={name:e,styles:r,next:d},e}))}return 1===n[t]||o(t)||"number"!==typeof e||0===e?e:e+"px"};function h(t,e,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return d={name:r.name,styles:r.styles,next:d},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)d={name:n.name,styles:n.styles,next:d},n=n.next;return r.styles+";"}return function(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=h(t,e,r[i])+";";else for(var s in r){var a=r[s];if("object"!==typeof a)null!=e&&void 0!==e[a]?n+=s+"{"+e[a]+"}":c(a)&&(n+=l(s)+":"+u(s,a)+";");else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=e&&void 0!==e[a[0]]){var o=h(t,e,a);switch(s){case"animation":case"animationName":n+=l(s)+":"+o+";";break;default:n+=s+"{"+o+"}"}}else for(var d=0;d<a.length;d++)c(a[d])&&(n+=l(s)+":"+u(s,a[d])+";")}return n}(t,e,r);case"function":if(void 0!==t){var i=d,s=r(t);return d=i,h(t,e,s)}}if(null==e)return r;var a=e[r];return void 0!==a?a:r}var d,f=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var p=function(t,e,r){if(1===t.length&&"object"===typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var n=!0,i="";d=void 0;var s=t[0];null==s||void 0===s.raw?(n=!1,i+=h(r,e,s)):i+=s[0];for(var a=1;a<t.length;a++)i+=h(r,e,t[a]),n&&(i+=s[a]);f.lastIndex=0;for(var o,c="";null!==(o=f.exec(i));)c+="-"+o[1];var l=function(t){for(var e,r=0,n=0,i=t.length;i>=4;++n,i-=4)e=1540483477*(65535&(e=255&t.charCodeAt(n)|(255&t.charCodeAt(++n))<<8|(255&t.charCodeAt(++n))<<16|(255&t.charCodeAt(++n))<<24))+(59797*(e>>>16)<<16),r=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(i){case 3:r^=(255&t.charCodeAt(n+2))<<16;case 2:r^=(255&t.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(i)+c;return{name:l,styles:i,next:d}}},5696:(t,e,r)=>{"use strict";var n;r.d(e,{L:()=>a});var i=r(7313),s=!!(n||(n=r.t(i,2))).useInsertionEffect&&(n||(n=r.t(i,2))).useInsertionEffect,a=s||function(t){return t()};s||i.useLayoutEffect},851:(t,e,r)=>{"use strict";r.d(e,{ET:()=>Kh,Ab:()=>Yh,vr:()=>Wh,hJ:()=>Lu,oe:()=>Gh,JU:()=>Pu,QT:()=>Uh,ad:()=>Uu,b9:()=>Rh,cf:()=>Hh,IO:()=>wh,pl:()=>jh,r7:()=>Vh,ar:()=>Sh});var n,i=r(904),s=r(2339),a=r(2413),o=r(4766),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},l={},u=u||{},h=c||self;function d(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var p="closure_uid_"+(1e9*Math.random()>>>0),g=0;function m(t,e,r){return t.call.apply(t.bind,arguments)}function v(t,e,r){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function y(t,e,r){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:v).apply(null,arguments)}function b(t,e){var r=Array.prototype.slice.call(arguments,1);return function(){var e=r.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function r(){}r.prototype=e.prototype,t.$=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.ac=function(t,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[r].apply(t,i)}}function w(){this.s=this.s,this.o=this.o}w.prototype.s=!1,w.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,p)&&t[p]||(t[p]=++g))},w.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const T=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(let r=0;r<t.length;r++)if(r in t&&t[r]===e)return r;return-1};function S(t){const e=t.length;if(0<e){const r=Array(e);for(let n=0;n<e;n++)r[n]=t[n];return r}return[]}function _(t,e){for(let r=1;r<arguments.length;r++){const e=arguments[r];if(d(e)){const r=t.length||0,n=e.length||0;t.length=r+n;for(let i=0;i<n;i++)t[r+i]=e[i]}else t.push(e)}}function A(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{h.addEventListener("test",(()=>{}),e),h.removeEventListener("test",(()=>{}),e)}catch(r){}return t}();function C(t){return/^[\s\xa0]*$/.test(t)}function k(){var t=h.navigator;return t&&(t=t.userAgent)?t:""}function O(t){return-1!=k().indexOf(t)}function I(t){return I[" "](t),t}I[" "]=function(){};var D,x,L=O("Opera"),P=O("Trident")||O("MSIE"),N=O("Edge"),M=N||P,F=O("Gecko")&&!(-1!=k().toLowerCase().indexOf("webkit")&&!O("Edge"))&&!(O("Trident")||O("MSIE"))&&!O("Edge"),U=-1!=k().toLowerCase().indexOf("webkit")&&!O("Edge");function B(){var t=h.document;return t?t.documentMode:void 0}t:{var j="",V=function(){var t=k();return F?/rv:([^\);]+)(\)|;)/.exec(t):N?/Edge\/([\d\.]+)/.exec(t):P?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):U?/WebKit\/(\S+)/.exec(t):L?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(V&&(j=V?V[1]:""),P){var G=B();if(null!=G&&G>parseFloat(j)){D=String(G);break t}}D=j}if(h.document&&P){var K=B();x=K||(parseInt(D,10)||void 0)}else x=void 0;var H=x;function z(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var r=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(F){t:{try{I(e.nodeName);var i=!0;break t}catch(s){}i=!1}i||(e=null)}}else"mouseover"==r?e=t.fromElement:"mouseout"==r&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:q[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&z.$.h.call(this)}}E(z,A);var q={2:"touch",3:"pen",4:"mouse"};z.prototype.h=function(){z.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Z(t,e,r,n,i){this.listener=t,this.proxy=null,this.src=e,this.type=r,this.capture=!!n,this.la=i,this.key=++Y,this.fa=this.ia=!1}function X(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Q(t,e,r){for(const n in t)e.call(r,t[n],n,t)}function $(t){const e={};for(const r in t)e[r]=t[r];return e}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){let r,n;for(let i=1;i<arguments.length;i++){for(r in n=arguments[i],n)t[r]=n[r];for(let e=0;e<J.length;e++)r=J[e],Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}}function et(t){this.src=t,this.g={},this.h=0}function rt(t,e){var r=e.type;if(r in t.g){var n,i=t.g[r],s=T(i,e);(n=0<=s)&&Array.prototype.splice.call(i,s,1),n&&(X(e),0==t.g[r].length&&(delete t.g[r],t.h--))}}function nt(t,e,r,n){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!r&&s.la==n)return i}return-1}et.prototype.add=function(t,e,r,n,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var a=nt(t,e,n,i);return-1<a?(e=t[a],r||(e.ia=!1)):((e=new Z(e,this.src,s,!!n,i)).ia=r,t.push(e)),e};var it="closure_lm_"+(1e6*Math.random()|0),st={};function at(t,e,r,n,i){if(n&&n.once)return ct(t,e,r,n,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)at(t,e[s],r,n,i);return null}return r=gt(r),t&&t[W]?t.O(e,r,f(n)?!!n.capture:!!n,i):ot(t,e,r,!1,n,i)}function ot(t,e,r,n,i,s){if(!e)throw Error("Invalid event type");var a=f(i)?!!i.capture:!!i,o=ft(t);if(o||(t[it]=o=new et(t)),(r=o.add(e,r,n,a,s)).proxy)return r;if(n=function(){function t(r){return e.call(t.src,t.listener,r)}const e=dt;return t}(),r.proxy=n,n.src=t,n.listener=r,t.addEventListener)R||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),n,i);else if(t.attachEvent)t.attachEvent(ht(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return r}function ct(t,e,r,n,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)ct(t,e[s],r,n,i);return null}return r=gt(r),t&&t[W]?t.P(e,r,f(n)?!!n.capture:!!n,i):ot(t,e,r,!0,n,i)}function lt(t,e,r,n,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)lt(t,e[s],r,n,i);else n=f(n)?!!n.capture:!!n,r=gt(r),t&&t[W]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(r=nt(s=t.g[e],r,n,i))&&(X(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete t.g[e],t.h--)))):t&&(t=ft(t))&&(e=t.g[e.toString()],t=-1,e&&(t=nt(e,r,n,i)),(r=-1<t?e[t]:null)&&ut(r))}function ut(t){if("number"!==typeof t&&t&&!t.fa){var e=t.src;if(e&&e[W])rt(e.i,t);else{var r=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(r,n,t.capture):e.detachEvent?e.detachEvent(ht(r),n):e.addListener&&e.removeListener&&e.removeListener(n),(r=ft(e))?(rt(r,t),0==r.h&&(r.src=null,e[it]=null)):X(t)}}}function ht(t){return t in st?st[t]:st[t]="on"+t}function dt(t,e){if(t.fa)t=!0;else{e=new z(e,this);var r=t.listener,n=t.la||t.src;t.ia&&ut(t),t=r.call(n,e)}return t}function ft(t){return(t=t[it])instanceof et?t:null}var pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function gt(t){return"function"===typeof t?t:(t[pt]||(t[pt]=function(e){return t.handleEvent(e)}),t[pt])}function mt(){w.call(this),this.i=new et(this),this.S=this,this.J=null}function vt(t,e){var r,n=t.J;if(n)for(r=[];n;n=n.J)r.push(n);if(t=t.S,n=e.type||e,"string"===typeof e)e=new A(e,t);else if(e instanceof A)e.target=e.target||t;else{var i=e;tt(e=new A(n,t),i)}if(i=!0,r)for(var s=r.length-1;0<=s;s--){var a=e.g=r[s];i=yt(a,n,!0,e)&&i}if(i=yt(a=e.g=t,n,!0,e)&&i,i=yt(a,n,!1,e)&&i,r)for(s=0;s<r.length;s++)i=yt(a=e.g=r[s],n,!1,e)&&i}function yt(t,e,r,n){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==r){var o=a.listener,c=a.la||a.src;a.ia&&rt(t.i,a),i=!1!==o.call(c,n)&&i}}return i&&!n.defaultPrevented}E(mt,w),mt.prototype[W]=!0,mt.prototype.removeEventListener=function(t,e,r,n){lt(this,t,e,r,n)},mt.prototype.N=function(){if(mt.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var r=e.g[t],n=0;n<r.length;n++)X(r[n]);delete e.g[t],e.h--}}this.J=null},mt.prototype.O=function(t,e,r,n){return this.i.add(String(t),e,!1,r,n)},mt.prototype.P=function(t,e,r,n){return this.i.add(String(t),e,!0,r,n)};var bt=h.JSON.stringify;function Et(){var t=Ct;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var wt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Tt),(t=>t.reset()));class Tt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function St(t){var e=1;t=t.split(":");const r=[];for(;0<e&&t.length;)r.push(t.shift()),e--;return t.length&&r.push(t.join(":")),r}function _t(t){h.setTimeout((()=>{throw t}),0)}let At,Rt=!1,Ct=new class{constructor(){this.h=this.g=null}add(t,e){const r=wt.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}},kt=()=>{const t=h.Promise.resolve(void 0);At=()=>{t.then(Ot)}};var Ot=()=>{for(var t;t=Et();){try{t.h.call(t.g)}catch(r){_t(r)}var e=wt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Rt=!1};function It(t,e){mt.call(this),this.h=t||1,this.g=e||h,this.j=y(this.qb,this),this.l=Date.now()}function Dt(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function xt(t,e,r){if("function"===typeof t)r&&(t=y(t,r));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=y(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function Lt(t){t.g=xt((()=>{t.g=null,t.i&&(t.i=!1,Lt(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}E(It,mt),(n=It.prototype).ga=!1,n.T=null,n.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),vt(this,"tick"),this.ga&&(Dt(this),this.start()))}},n.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},n.N=function(){It.$.N.call(this),Dt(this),delete this.g};class Pt extends w{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Lt(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nt(t){w.call(this),this.h=t,this.g={}}E(Nt,w);var Mt=[];function Ft(t,e,r,n){Array.isArray(r)||(r&&(Mt[0]=r.toString()),r=Mt);for(var i=0;i<r.length;i++){var s=at(e,r[i],n||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Ut(t){Q(t.g,(function(t,e){this.g.hasOwnProperty(e)&&ut(t)}),t),t.g={}}function Bt(){this.g=!0}function jt(t,e,r,n){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var r=JSON.parse(e);if(r)for(t=0;t<r.length;t++)if(Array.isArray(r[t])){var n=r[t];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return bt(r)}catch(o){return e}}(t,r)+(n?" "+n:"")}))}Nt.prototype.N=function(){Nt.$.N.call(this),Ut(this)},Nt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Bt.prototype.Ea=function(){this.g=!1},Bt.prototype.info=function(){};var Vt={},Gt=null;function Kt(){return Gt=Gt||new mt}function Ht(t){A.call(this,Vt.Ta,t)}function zt(t){const e=Kt();vt(e,new Ht(e))}function qt(t,e){A.call(this,Vt.STAT_EVENT,t),this.stat=e}function Wt(t){const e=Kt();vt(e,new qt(e,t))}function Yt(t,e){A.call(this,Vt.Ua,t),this.size=e}function Zt(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return h.setTimeout((function(){t()}),e)}Vt.Ta="serverreachability",E(Ht,A),Vt.STAT_EVENT="statevent",E(qt,A),Vt.Ua="timingevent",E(Yt,A);var Xt={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Qt={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function $t(){}function Jt(t){return t.h||(t.h=t.i())}function te(){}$t.prototype.h=null;var ee,re={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ne(){A.call(this,"d")}function ie(){A.call(this,"c")}function se(){}function ae(t,e,r,n){this.l=t,this.j=e,this.m=r,this.W=n||1,this.U=new Nt(this),this.P=ce,t=M?125:void 0,this.V=new It(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new oe}function oe(){this.i=null,this.g="",this.h=!1}E(ne,A),E(ie,A),E(se,$t),se.prototype.g=function(){return new XMLHttpRequest},se.prototype.i=function(){return{}},ee=new se;var ce=45e3,le={},ue={};function he(t,e,r){t.L=1,t.v=Ie(Ae(e)),t.s=r,t.S=!0,de(t,null)}function de(t,e){t.G=Date.now(),me(t),t.A=Ae(t.v);var r=t.A,n=t.W;Array.isArray(n)||(n=[String(n)]),Ke(r.i,"t",n),t.C=0,r=t.l.J,t.h=new oe,t.g=Hr(t.l,r?e:null,!t.s),0<t.O&&(t.M=new Pt(y(t.Pa,t,t.g),t.O)),Ft(t.U,t.g,"readystatechange",t.nb),e=t.I?$(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),zt(),function(t,e,r,n,i,s){t.info((function(){if(t.g)if(s)for(var a="",o=s.split("&"),c=0;c<o.length;c++){var l=o[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");a=2<=h.length&&"type"==h[1]?a+(u+"=")+l+"&":a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+r+"\n"+a}))}(t.j,t.u,t.A,t.m,t.W,t.s)}function fe(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.l.Ha)}function pe(t,e,r){let n,i=!0;for(;!t.J&&t.C<r.length;){if(n=ge(t,r),n==ue){4==e&&(t.o=4,Wt(14),i=!1),jt(t.j,t.m,null,"[Incomplete Response]");break}if(n==le){t.o=4,Wt(15),jt(t.j,t.m,r,"[Invalid Chunk]"),i=!1;break}jt(t.j,t.m,n,null),we(t,n)}fe(t)&&n!=ue&&n!=le&&(t.h.g="",t.C=0),4!=e||0!=r.length||t.h.h||(t.o=1,Wt(16),i=!1),t.i=t.i&&i,i?0<r.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+r.length),Mr(e),e.M=!0,Wt(11))):(jt(t.j,t.m,r,"[Invalid Chunked Response]"),Ee(t),be(t))}function ge(t,e){var r=t.C,n=e.indexOf("\n",r);return-1==n?ue:(r=Number(e.substring(r,n)),isNaN(r)?le:(n+=1)+r>e.length?ue:(e=e.slice(n,n+r),t.C=n+r,e))}function me(t){t.Y=Date.now()+t.P,ve(t,t.P)}function ve(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Zt(y(t.lb,t),e)}function ye(t){t.B&&(h.clearTimeout(t.B),t.B=null)}function be(t){0==t.l.H||t.J||Br(t.l,t)}function Ee(t){ye(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Dt(t.V),Ut(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function we(t,e){try{var r=t.l;if(0!=r.H&&(r.g==t||Xe(r.i,t)))if(!t.K&&Xe(r.i,t)&&3==r.H){try{var n=r.Ja.g.parse(e)}catch(l){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){t:if(!r.u){if(r.g){if(!(r.g.G+3e3<t.G))break t;Ur(r),kr(r)}Nr(r),Wt(18)}}else r.Fa=i[1],0<r.Fa-r.V&&37500>i[2]&&r.G&&0==r.A&&!r.v&&(r.v=Zt(y(r.ib,r),6e3));if(1>=Ze(r.i)&&r.oa){try{r.oa()}catch(l){}r.oa=void 0}}else Vr(r,11)}else if((t.K||r.g==t)&&Ur(r),!C(e))for(i=r.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(r.V=l[0],l=l[1],2==r.H)if("c"==l[0]){r.K=l[1],r.pa=l[2];const e=l[3];null!=e&&(r.ra=e,r.l.info("VER="+r.ra));const i=l[4];null!=i&&(r.Ga=i,r.l.info("SVER="+r.Ga));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(n=1.5*u,r.L=n,r.l.info("backChannelRequestTimeoutMs_="+n)),n=r;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=n.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Qe(s,s.h),s.h=null))}if(n.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(n.Da=t,Oe(n.I,n.F,t))}}r.H=3,r.h&&r.h.Ba(),r.ca&&(r.S=Date.now()-t.G,r.l.info("Handshake RTT: "+r.S+"ms"));var a=t;if((n=r).wa=Kr(n,n.J?n.pa:null,n.Y),a.K){$e(n.i,a);var o=a,c=n.L;c&&o.setTimeout(c),o.B&&(ye(o),me(o)),n.g=a}else Pr(n);0<r.j.length&&Ir(r)}else"stop"!=l[0]&&"close"!=l[0]||Vr(r,7);else 3==r.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Vr(r,7):Cr(r):"noop"!=l[0]&&r.h&&r.h.Aa(l),r.A=0)}zt()}catch(l){}}function Te(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"===typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var r=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!==typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!==typeof Set&&t instanceof Set)){if(d(t)||"string"===typeof t){var e=[];t=t.length;for(var r=0;r<t;r++)e.push(r);return e}e=[],r=0;for(const n in t)e[r++]=n;return e}}}(t),n=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!==typeof Map&&t instanceof Map||"undefined"!==typeof Set&&t instanceof Set)return Array.from(t.values());if("string"===typeof t)return t.split("");if(d(t)){for(var e=[],r=t.length,n=0;n<r;n++)e.push(t[n]);return e}for(n in e=[],r=0,t)e[r++]=t[n];return e}(t),i=n.length,s=0;s<i;s++)e.call(void 0,n[s],r&&r[s],t)}(n=ae.prototype).setTimeout=function(t){this.P=t},n.nb=function(t){t=t.target;const e=this.M;e&&3==wr(t)?e.l():this.Pa(t)},n.Pa=function(t){try{if(t==this.g)t:{const u=wr(this.g);var e=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||M||this.g&&(this.h.h||this.g.ja()||Tr(this.g)))){this.J||4!=u||7==e||zt(),ye(this);var r=this.g.da();this.ca=r;e:if(fe(this)){var n=Tr(this.g);t="";var i=n.length,s=4==wr(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ee(this),be(this);var a="";break e}this.h.i=new h.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:s&&e==i-1});n.splice(0,i),this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=200==r,function(t,e,r,n,i,s,a){t.info((function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+r+"\n"+s+" "+a}))}(this.j,this.u,this.A,this.m,this.W,u,r),this.i){if(this.aa&&!this.K){e:{if(this.g){var o,c=this.g;if((o=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(o)){var l=o;break e}}l=null}if(!(r=l)){this.i=!1,this.o=3,Wt(12),Ee(this),be(this);break t}jt(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,we(this,r)}this.S?(pe(this,u,a),M&&this.i&&3==u&&(Ft(this.U,this.V,"tick",this.mb),this.V.start())):(jt(this.j,this.m,a,null),we(this,a)),4==u&&Ee(this),this.i&&!this.J&&(4==u?Br(this.l,this):(this.i=!1,me(this)))}else(function(t){const e={};t=(t.g&&2<=wr(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<t.length;n++){if(C(t[n]))continue;var r=St(t[n]);const i=r[0];if("string"!==typeof(r=r[1]))continue;r=r.trim();const s=e[i]||[];e[i]=s,s.push(r)}!function(t,e){for(const r in t)e.call(void 0,t[r],r,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==r&&0<a.indexOf("Unknown SID")?(this.o=3,Wt(12)):(this.o=0,Wt(13)),Ee(this),be(this)}}}catch(u){}},n.mb=function(){if(this.g){var t=wr(this.g),e=this.g.ja();this.C<e.length&&(ye(this),pe(this,t,e),this.i&&4!=t&&me(this))}},n.cancel=function(){this.J=!0,Ee(this)},n.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.L&&(zt(),Wt(17)),Ee(this),this.o=2,be(this)):ve(this,this.Y-t)};var Se=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _e(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof _e){this.h=t.h,Re(this,t.j),this.s=t.s,this.g=t.g,Ce(this,t.m),this.l=t.l;var e=t.i,r=new Be;r.i=e.i,e.g&&(r.g=new Map(e.g),r.h=e.h),ke(this,r),this.o=t.o}else t&&(e=String(t).match(Se))?(this.h=!1,Re(this,e[1]||"",!0),this.s=De(e[2]||""),this.g=De(e[3]||"",!0),Ce(this,e[4]),this.l=De(e[5]||"",!0),ke(this,e[6]||"",!0),this.o=De(e[7]||"")):(this.h=!1,this.i=new Be(null,this.h))}function Ae(t){return new _e(t)}function Re(t,e,r){t.j=r?De(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ce(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ke(t,e,r){e instanceof Be?(t.i=e,function(t,e){e&&!t.j&&(je(t),t.i=null,t.g.forEach((function(t,e){var r=e.toLowerCase();e!=r&&(Ve(this,e),Ke(this,r,t))}),t)),t.j=e}(t.i,t.h)):(r||(e=xe(e,Fe)),t.i=new Be(e,t.h))}function Oe(t,e,r){t.i.set(e,r)}function Ie(t){return Oe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function De(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function xe(t,e,r){return"string"===typeof t?(t=encodeURI(t).replace(e,Le),r&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Le(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}_e.prototype.toString=function(){var t=[],e=this.j;e&&t.push(xe(e,Pe,!0),":");var r=this.g;return(r||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(xe(e,Pe,!0),"@"),t.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.m)&&t.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&t.push("/"),t.push(xe(r,"/"==r.charAt(0)?Me:Ne,!0))),(r=this.i.toString())&&t.push("?",r),(r=this.o)&&t.push("#",xe(r,Ue)),t.join("")};var Pe=/[#\/\?@]/g,Ne=/[#\?:]/g,Me=/[#\?]/g,Fe=/[#\?@]/g,Ue=/#/g;function Be(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function je(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var r=0;r<t.length;r++){var n=t[r].indexOf("="),i=null;if(0<=n){var s=t[r].substring(0,n);i=t[r].substring(n+1)}else s=t[r];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,r){t.add(decodeURIComponent(e.replace(/\+/g," ")),r)})))}function Ve(t,e){je(t),e=He(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ge(t,e){return je(t),e=He(t,e),t.g.has(e)}function Ke(t,e,r){Ve(t,e),0<r.length&&(t.i=null,t.g.set(He(t,e),S(r)),t.h+=r.length)}function He(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(n=Be.prototype).add=function(t,e){je(this),this.i=null,t=He(this,t);var r=this.g.get(t);return r||this.g.set(t,r=[]),r.push(e),this.h+=1,this},n.forEach=function(t,e){je(this),this.g.forEach((function(r,n){r.forEach((function(r){t.call(e,r,n,this)}),this)}),this)},n.ta=function(){je(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),r=[];for(let n=0;n<e.length;n++){const i=t[n];for(let t=0;t<i.length;t++)r.push(e[n])}return r},n.Z=function(t){je(this);let e=[];if("string"===typeof t)Ge(this,t)&&(e=e.concat(this.g.get(He(this,t))));else{t=Array.from(this.g.values());for(let r=0;r<t.length;r++)e=e.concat(t[r])}return e},n.set=function(t,e){return je(this),this.i=null,Ge(this,t=He(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},n.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var r=0;r<e.length;r++){var n=e[r];const s=encodeURIComponent(String(n)),a=this.Z(n);for(n=0;n<a.length;n++){var i=s;""!==a[n]&&(i+="="+encodeURIComponent(String(a[n]))),t.push(i)}}return this.i=t.join("&")};var ze=class{constructor(t,e){this.g=t,this.map=e}};function qe(t){this.l=t||We,h.PerformanceNavigationTiming?t=0<(t=h.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(h.g&&h.g.Ka&&h.g.Ka()&&h.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var We=10;function Ye(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ze(t){return t.h?1:t.g?t.g.size:0}function Xe(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Qe(t,e){t.g?t.g.add(e):t.h=e}function $e(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Je(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const r of t.g.values())e=e.concat(r.F);return e}return S(t.i)}qe.prototype.cancel=function(){if(this.i=Je(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var tr,er=class{stringify(t){return h.JSON.stringify(t,void 0)}parse(t){return h.JSON.parse(t,void 0)}};function rr(){this.g=new er}function nr(t,e,r){const n=r||"";try{Te(t,(function(t,r){let i=t;f(t)&&(i=bt(t)),e.push(n+r+"="+encodeURIComponent(i))}))}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function ir(t,e,r,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch(s){}}function sr(t){this.l=t.fc||null,this.j=t.ob||!1}function ar(t,e){mt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=or,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}E(sr,$t),sr.prototype.g=function(){return new ar(this.l,this.j)},sr.prototype.i=(tr={},function(){return tr}),E(ar,mt);var or=0;function cr(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function lr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ur(t)}function ur(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(n=ar.prototype).open=function(t,e){if(this.readyState!=or)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ur(this)},n.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||h).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},n.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,lr(this)),this.readyState=or},n.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ur(this)),this.g&&(this.readyState=3,ur(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof h.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;cr(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},n.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?lr(this):ur(this),3==this.readyState&&cr(this)}},n.Za=function(t){this.g&&(this.response=this.responseText=t,lr(this))},n.Ya=function(t){this.g&&(this.response=t,lr(this))},n.ka=function(){this.g&&lr(this)},n.setRequestHeader=function(t,e){this.v.append(t,e)},n.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var r=e.next();!r.done;)r=r.value,t.push(r[0]+": "+r[1]),r=e.next();return t.join("\r\n")},Object.defineProperty(ar.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var hr=h.JSON.parse;function dr(t){mt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=fr,this.L=this.M=!1}E(dr,mt);var fr="",pr=/^https?$/i,gr=["POST","PUT"];function mr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,vr(t),br(t)}function vr(t){t.F||(t.F=!0,vt(t,"complete"),vt(t,"error"))}function yr(t){if(t.h&&"undefined"!=typeof u&&(!t.C[1]||4!=wr(t)||2!=t.da()))if(t.v&&4==wr(t))xt(t.La,0,t);else if(vt(t,"readystatechange"),4==wr(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var r;if(!(r=e)){var n;if(n=0===o){var i=String(t.I).match(Se)[1]||null;!i&&h.self&&h.self.location&&(i=h.self.location.protocol.slice(0,-1)),n=!pr.test(i?i.toLowerCase():"")}r=n}if(r)vt(t,"complete"),vt(t,"success");else{t.m=6;try{var s=2<wr(t)?t.g.statusText:""}catch(a){s=""}t.j=s+" ["+t.da()+"]",vr(t)}}finally{br(t)}}}function br(t,e){if(t.g){Er(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||vt(t,"ready");try{n.onreadystatechange=i}catch(r){}}}function Er(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(h.clearTimeout(t.A),t.A=null)}function wr(t){return t.g?t.g.readyState:0}function Tr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case fr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(kn){return null}}function Sr(t){let e="";return Q(t,(function(t,r){e+=r,e+=":",e+=t,e+="\r\n"})),e}function _r(t,e,r){t:{for(n in r){var n=!1;break t}n=!0}n||(r=Sr(r),"string"===typeof t?null!=r&&encodeURIComponent(String(r)):Oe(t,e,r))}function Ar(t,e,r){return r&&r.internalChannelParams&&r.internalChannelParams[t]||e}function Rr(t){this.Ga=0,this.j=[],this.l=new Bt,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ar("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ar("baseRetryDelayMs",5e3,t),this.hb=Ar("retryDelaySeedMs",1e4,t),this.eb=Ar("forwardChannelMaxRetries",2,t),this.xa=Ar("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new qe(t&&t.concurrentRequestLimit),this.Ja=new rr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Cr(t){if(Or(t),3==t.H){var e=t.W++,r=Ae(t.I);if(Oe(r,"SID",t.K),Oe(r,"RID",e),Oe(r,"TYPE","terminate"),xr(t,r),(e=new ae(t,t.l,e)).L=2,e.v=Ie(Ae(r)),r=!1,h.navigator&&h.navigator.sendBeacon)try{r=h.navigator.sendBeacon(e.v.toString(),"")}catch(n){}!r&&h.Image&&((new Image).src=e.v,r=!0),r||(e.g=Hr(e.l,null),e.g.ha(e.v)),e.G=Date.now(),me(e)}Gr(t)}function kr(t){t.g&&(Mr(t),t.g.cancel(),t.g=null)}function Or(t){kr(t),t.u&&(h.clearTimeout(t.u),t.u=null),Ur(t),t.i.cancel(),t.m&&("number"===typeof t.m&&h.clearTimeout(t.m),t.m=null)}function Ir(t){if(!Ye(t.i)&&!t.m){t.m=!0;var e=t.Na;At||kt(),Rt||(At(),Rt=!0),Ct.add(e,t),t.C=0}}function Dr(t,e){var r;r=e?e.m:t.W++;const n=Ae(t.I);Oe(n,"SID",t.K),Oe(n,"RID",r),Oe(n,"AID",t.V),xr(t,n),t.o&&t.s&&_r(n,t.o,t.s),r=new ae(t,t.l,r,t.C+1),null===t.o&&(r.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Lr(t,r,1e3),r.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Qe(t.i,r),he(r,n,e)}function xr(t,e){t.na&&Q(t.na,(function(t,r){Oe(e,r,t)})),t.h&&Te({},(function(t,r){Oe(e,r,t)}))}function Lr(t,e,r){r=Math.min(t.j.length,r);var n=t.h?y(t.h.Va,t.h,t):null;t:{var i=t.j;let e=-1;for(;;){const t=["count="+r];-1==e?0<r?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let a=0;a<r;a++){let r=i[a].g;const o=i[a].map;if(r-=e,0>r)e=Math.max(0,i[a].g-100),s=!1;else try{nr(o,t,"req"+r+"_")}catch(Bn){n&&n(o)}}if(s){n=t.join("&");break t}}}return t=t.j.splice(0,r),e.F=t,n}function Pr(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;At||kt(),Rt||(At(),Rt=!0),Ct.add(e,t),t.A=0}}function Nr(t){return!(t.g||t.u||3<=t.A)&&(t.ba++,t.u=Zt(y(t.Ma,t),jr(t,t.A)),t.A++,!0)}function Mr(t){null!=t.B&&(h.clearTimeout(t.B),t.B=null)}function Fr(t){t.g=new ae(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Ae(t.wa);Oe(e,"RID","rpc"),Oe(e,"SID",t.K),Oe(e,"AID",t.V),Oe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Oe(e,"TO",t.qa),Oe(e,"TYPE","xmlhttp"),xr(t,e),t.o&&t.s&&_r(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var r=t.g;t=t.pa,r.L=1,r.v=Ie(Ae(e)),r.s=null,r.S=!0,de(r,t)}function Ur(t){null!=t.v&&(h.clearTimeout(t.v),t.v=null)}function Br(t,e){var r=null;if(t.g==e){Ur(t),Mr(t),t.g=null;var n=2}else{if(!Xe(t.i,e))return;r=e.F,$e(t.i,e),n=1}if(0!=t.H)if(e.i)if(1==n){r=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;vt(n=Kt(),new Yt(n,r)),Ir(t)}else Pr(t);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function(t,e){return!(Ze(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.j=e.F.concat(t.j),!0):!(1==t.H||2==t.H||t.C>=(t.cb?0:t.eb))&&(t.m=Zt(y(t.Na,t,e),jr(t,t.C)),t.C++,!0))}(t,e)||2==n&&Nr(t)))switch(r&&0<r.length&&(e=t.i,e.i=e.i.concat(r)),i){case 1:Vr(t,5);break;case 4:Vr(t,10);break;case 3:Vr(t,6);break;default:Vr(t,2)}}function jr(t,e){let r=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(r*=2),r*e}function Vr(t,e){if(t.l.info("Error code "+e),2==e){var r=null;t.h&&(r=null);var n=y(t.pb,t);r||(r=new _e("//www.google.com/images/cleardot.gif"),h.location&&"http"==h.location.protocol||Re(r,"https"),Ie(r)),function(t,e){const r=new Bt;if(h.Image){const n=new Image;n.onload=b(ir,r,n,"TestLoadImage: loaded",!0,e),n.onerror=b(ir,r,n,"TestLoadImage: error",!1,e),n.onabort=b(ir,r,n,"TestLoadImage: abort",!1,e),n.ontimeout=b(ir,r,n,"TestLoadImage: timeout",!1,e),h.setTimeout((function(){n.ontimeout&&n.ontimeout()}),1e4),n.src=t}else e(!1)}(r.toString(),n)}else Wt(2);t.H=0,t.h&&t.h.za(e),Gr(t),Or(t)}function Gr(t){if(t.H=0,t.ma=[],t.h){const e=Je(t.i);0==e.length&&0==t.j.length||(_(t.ma,e),_(t.ma,t.j),t.i.i.length=0,S(t.j),t.j.length=0),t.h.ya()}}function Kr(t,e,r){var n=r instanceof _e?Ae(r):new _e(r);if(""!=n.g)e&&(n.g=e+"."+n.g),Ce(n,n.m);else{var i=h.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new _e(null);n&&Re(s,n),e&&(s.g=e),i&&Ce(s,i),r&&(s.l=r),n=s}return r=t.F,e=t.Da,r&&e&&Oe(n,r,e),Oe(n,"VER",t.ra),xr(t,n),n}function Hr(t,e,r){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=r&&t.Ha&&!t.va?new dr(new sr({ob:!0})):new dr(t.va)).Oa(t.J),e}function zr(){}function qr(){if(P&&!(10<=Number(H)))throw Error("Environmental error: no available transport.")}function Wr(t,e){mt.call(this),this.g=new Rr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!C(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!C(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Xr(this)}function Yr(t){ne.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const r in e){t=r;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Zr(){ie.call(this),this.status=1}function Xr(t){this.g=t}function Qr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function $r(t,e,r){r||(r=0);var n=Array(16);if("string"===typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(r++)|e.charCodeAt(r++)<<8|e.charCodeAt(r++)<<16|e.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;e=t.g[0],r=t.g[1],i=t.g[2];var s=t.g[3],a=e+(s^r&(i^s))+n[0]+3614090360&4294967295;a=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=(r=(i=(s=(e=r+(a<<7&4294967295|a>>>25))+((a=s+(i^e&(r^i))+n[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(e^r))+n[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=r+(e^i&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^r&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(r^i))+n[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(e^r))+n[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=r+(e^i&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^r&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(r^i))+n[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(e^r))+n[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=r+(e^i&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^r&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(r^i))+n[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(r^s&(e^r))+n[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=r+(e^i&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(i^s&(r^i))+n[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(e^r))+n[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^r&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^e&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(r^i))+n[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(e^r))+n[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^r&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^e&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(r^i))+n[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(e^r))+n[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^r&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^e&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(r^i))+n[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(r^i&(e^r))+n[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^r&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=r+(s^e&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(r^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^r^i)+n[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^r)+n[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(r^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^r^i)+n[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^r)+n[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(r^i^s)+n[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^r^i)+n[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^r)+n[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^e)+n[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(r^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^r^i)+n[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^r)+n[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=r+(i^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(i^(r|~s))+n[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~r))+n[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(r|~s))+n[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~r))+n[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(r|~s))+n[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~r))+n[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=r+(s^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(e=r+((a=e+(i^(r|~s))+n[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(r^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(e^(s|~r))+n[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+n[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function Jr(t,e){this.h=e;for(var r=[],n=!0,i=t.length-1;0<=i;i--){var s=0|t[i];n&&s==e||(r[i]=s,n=!1)}this.g=r}(n=dr.prototype).Oa=function(t){this.M=t},n.ha=function(t,e,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ee.g(),this.C=this.u?Jt(this.u):Jt(ee),this.g.onreadystatechange=y(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){return void mr(this,s)}if(t=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)r.set(i,n[i]);else{if("function"!==typeof n.keys||"function"!==typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const t of n.keys())r.set(t,n.get(t))}n=Array.from(r.keys()).find((t=>"content-type"==t.toLowerCase())),i=h.FormData&&t instanceof h.FormData,!(0<=T(gr,e))||n||i||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of r)this.g.setRequestHeader(a,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Er(this),0<this.B&&((this.L=function(t){return P&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=y(this.ua,this)):this.A=xt(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){mr(this,s)}},n.ua=function(){"undefined"!=typeof u&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,vt(this,"timeout"),this.abort(8))},n.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,vt(this,"complete"),vt(this,"abort"),br(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),br(this,!0)),dr.$.N.call(this)},n.La=function(){this.s||(this.G||this.v||this.l?yr(this):this.kb())},n.kb=function(){yr(this)},n.isActive=function(){return!!this.g},n.da=function(){try{return 2<wr(this)?this.g.status:-1}catch(tr){return-1}},n.ja=function(){try{return this.g?this.g.responseText:""}catch(tr){return""}},n.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),hr(e)}},n.Ia=function(){return this.m},n.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(n=Rr.prototype).ra=8,n.H=1,n.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new ae(this,this.l,t);let s=this.s;if(this.U&&(s?(s=$(s),tt(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)t:{for(var e=0,r=0;r<this.j.length;r++){var n=this.j[r];if(void 0===(n="__data__"in n.map&&"string"===typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=r;break t}if(4096===e||r===this.j.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=Lr(this,i,e),Oe(r=Ae(this.I),"RID",t),Oe(r,"CVER",22),this.F&&Oe(r,"X-HTTP-Session-Id",this.F),xr(this,r),s&&(this.O?e="headers="+encodeURIComponent(String(Sr(s)))+"&"+e:this.o&&_r(r,this.o,s)),Qe(this.i,i),this.bb&&Oe(r,"TYPE","init"),this.P?(Oe(r,"$req",e),Oe(r,"SID","null"),i.aa=!0,he(i,r,null)):he(i,r,e),this.H=2}}else 3==this.H&&(t?Dr(this,t):0==this.j.length||Ye(this.i)||Dr(this))},n.Ma=function(){if(this.u=null,Fr(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Zt(y(this.jb,this),t)}},n.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Wt(10),kr(this),Fr(this))},n.ib=function(){null!=this.v&&(this.v=null,kr(this),Nr(this),Wt(19))},n.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Wt(2)):(this.l.info("Failed to ping google.com"),Wt(1))},n.isActive=function(){return!!this.h&&this.h.isActive(this)},(n=zr.prototype).Ba=function(){},n.Aa=function(){},n.za=function(){},n.ya=function(){},n.isActive=function(){return!0},n.Va=function(){},qr.prototype.g=function(t,e){return new Wr(t,e)},E(Wr,mt),Wr.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,r=this.h||void 0;Wt(0),t.Y=e,t.na=r||{},t.G=t.aa,t.I=Kr(t,null,t.Y),Ir(t)},Wr.prototype.close=function(){Cr(this.g)},Wr.prototype.u=function(t){var e=this.g;if("string"===typeof t){var r={};r.__data__=t,t=r}else this.v&&((r={}).__data__=bt(t),t=r);e.j.push(new ze(e.fb++,t)),3==e.H&&Ir(e)},Wr.prototype.N=function(){this.g.h=null,delete this.j,Cr(this.g),delete this.g,Wr.$.N.call(this)},E(Yr,ne),E(Zr,ie),E(Xr,zr),Xr.prototype.Ba=function(){vt(this.g,"a")},Xr.prototype.Aa=function(t){vt(this.g,new Yr(t))},Xr.prototype.za=function(t){vt(this.g,new Zr)},Xr.prototype.ya=function(){vt(this.g,"b")},E(Qr,(function(){this.blockSize=-1})),Qr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Qr.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var r=e-this.blockSize,n=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=r;)$r(this,t,s),s+=this.blockSize;if("string"===typeof t){for(;s<e;)if(n[i++]=t.charCodeAt(s++),i==this.blockSize){$r(this,n),i=0;break}}else for(;s<e;)if(n[i++]=t[s++],i==this.blockSize){$r(this,n),i=0;break}}this.h=i,this.i+=e},Qr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var r=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&r,r/=256;for(this.j(t),t=Array(16),e=r=0;4>e;++e)for(var n=0;32>n;n+=8)t[r++]=this.g[e]>>>n&255;return t};var tn={};function en(t){return-128<=t&&128>t?function(t,e){var r=tn;return Object.prototype.hasOwnProperty.call(r,t)?r[t]:r[t]=e(t)}(t,(function(t){return new Jr([0|t],0>t?-1:0)})):new Jr([0|t],0>t?-1:0)}function rn(t){if(isNaN(t)||!isFinite(t))return sn;if(0>t)return un(rn(-t));for(var e=[],r=1,n=0;t>=r;n++)e[n]=t/r|0,r*=nn;return new Jr(e,0)}var nn=4294967296,sn=en(0),an=en(1),on=en(16777216);function cn(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function ln(t){return-1==t.h}function un(t){for(var e=t.g.length,r=[],n=0;n<e;n++)r[n]=~t.g[n];return new Jr(r,~t.h).add(an)}function hn(t,e){return t.add(un(e))}function dn(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function fn(t,e){this.g=t,this.h=e}function pn(t,e){if(cn(e))throw Error("division by zero");if(cn(t))return new fn(sn,sn);if(ln(t))return e=pn(un(t),e),new fn(un(e.g),un(e.h));if(ln(e))return e=pn(t,un(e)),new fn(un(e.g),e.h);if(30<t.g.length){if(ln(t)||ln(e))throw Error("slowDivide_ only works with positive integers.");for(var r=an,n=e;0>=n.X(t);)r=gn(r),n=gn(n);var i=mn(r,1),s=mn(n,1);for(n=mn(n,2),r=mn(r,2);!cn(n);){var a=s.add(n);0>=a.X(t)&&(i=i.add(r),s=a),n=mn(n,1),r=mn(r,1)}return e=hn(t,i.R(e)),new fn(i,e)}for(i=sn;0<=t.X(e);){for(r=Math.max(1,Math.floor(t.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(r)/Math.LN2))?1:Math.pow(2,n-48),a=(s=rn(r)).R(e);ln(a)||0<a.X(t);)a=(s=rn(r-=n)).R(e);cn(s)&&(s=an),i=i.add(s),t=hn(t,a)}return new fn(i,t)}function gn(t){for(var e=t.g.length+1,r=[],n=0;n<e;n++)r[n]=t.D(n)<<1|t.D(n-1)>>>31;return new Jr(r,t.h)}function mn(t,e){var r=e>>5;e%=32;for(var n=t.g.length-r,i=[],s=0;s<n;s++)i[s]=0<e?t.D(s+r)>>>e|t.D(s+r+1)<<32-e:t.D(s+r);return new Jr(i,t.h)}(n=Jr.prototype).ea=function(){if(ln(this))return-un(this).ea();for(var t=0,e=1,r=0;r<this.g.length;r++){var n=this.D(r);t+=(0<=n?n:nn+n)*e,e*=nn}return t},n.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(cn(this))return"0";if(ln(this))return"-"+un(this).toString(t);for(var e=rn(Math.pow(t,6)),r=this,n="";;){var i=pn(r,e).g,s=((0<(r=hn(r,i.R(e))).g.length?r.g[0]:r.h)>>>0).toString(t);if(cn(r=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},n.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},n.X=function(t){return ln(t=hn(this,t))?-1:cn(t)?0:1},n.abs=function(){return ln(this)?un(this):this},n.add=function(t){for(var e=Math.max(this.g.length,t.g.length),r=[],n=0,i=0;i<=e;i++){var s=n+(65535&this.D(i))+(65535&t.D(i)),a=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);n=a>>>16,s&=65535,a&=65535,r[i]=a<<16|s}return new Jr(r,-2147483648&r[r.length-1]?-1:0)},n.R=function(t){if(cn(this)||cn(t))return sn;if(ln(this))return ln(t)?un(this).R(un(t)):un(un(this).R(t));if(ln(t))return un(this.R(un(t)));if(0>this.X(on)&&0>t.X(on))return rn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,r=[],n=0;n<2*e;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<t.g.length;i++){var s=this.D(n)>>>16,a=65535&this.D(n),o=t.D(i)>>>16,c=65535&t.D(i);r[2*n+2*i]+=a*c,dn(r,2*n+2*i),r[2*n+2*i+1]+=s*c,dn(r,2*n+2*i+1),r[2*n+2*i+1]+=a*o,dn(r,2*n+2*i+1),r[2*n+2*i+2]+=s*o,dn(r,2*n+2*i+2)}for(n=0;n<e;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=e;n<2*e;n++)r[n]=0;return new Jr(r,0)},n.gb=function(t){return pn(this,t).h},n.and=function(t){for(var e=Math.max(this.g.length,t.g.length),r=[],n=0;n<e;n++)r[n]=this.D(n)&t.D(n);return new Jr(r,this.h&t.h)},n.or=function(t){for(var e=Math.max(this.g.length,t.g.length),r=[],n=0;n<e;n++)r[n]=this.D(n)|t.D(n);return new Jr(r,this.h|t.h)},n.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),r=[],n=0;n<e;n++)r[n]=this.D(n)^t.D(n);return new Jr(r,this.h^t.h)},qr.prototype.createWebChannel=qr.prototype.g,Wr.prototype.send=Wr.prototype.u,Wr.prototype.open=Wr.prototype.m,Wr.prototype.close=Wr.prototype.close,Xt.NO_ERROR=0,Xt.TIMEOUT=8,Xt.HTTP_ERROR=6,Qt.COMPLETE="complete",te.EventType=re,re.OPEN="a",re.CLOSE="b",re.ERROR="c",re.MESSAGE="d",mt.prototype.listen=mt.prototype.O,dr.prototype.listenOnce=dr.prototype.P,dr.prototype.getLastError=dr.prototype.Sa,dr.prototype.getLastErrorCode=dr.prototype.Ia,dr.prototype.getStatus=dr.prototype.da,dr.prototype.getResponseJson=dr.prototype.Wa,dr.prototype.getResponseText=dr.prototype.ja,dr.prototype.send=dr.prototype.ha,dr.prototype.setWithCredentials=dr.prototype.Oa,Qr.prototype.digest=Qr.prototype.l,Qr.prototype.reset=Qr.prototype.reset,Qr.prototype.update=Qr.prototype.j,Jr.prototype.add=Jr.prototype.add,Jr.prototype.multiply=Jr.prototype.R,Jr.prototype.modulo=Jr.prototype.gb,Jr.prototype.compare=Jr.prototype.X,Jr.prototype.toNumber=Jr.prototype.ea,Jr.prototype.toString=Jr.prototype.toString,Jr.prototype.getBits=Jr.prototype.D,Jr.fromNumber=rn,Jr.fromString=function t(e,r){if(0==e.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==e.charAt(0))return un(t(e.substring(1),r));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=rn(Math.pow(r,8)),i=sn,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),o=parseInt(e.substring(s,s+a),r);8>a?(a=rn(Math.pow(r,a)),i=i.R(a).add(rn(o))):i=(i=i.R(n)).add(rn(o))}return i};var vn=l.createWebChannelTransport=function(){return new qr},yn=l.getStatEventTarget=function(){return Kt()},bn=l.ErrorCode=Xt,En=l.EventType=Qt,wn=l.Event=Vt,Tn=l.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Sn=l.FetchXmlHttpFactory=sr,_n=l.WebChannel=te,An=l.XhrIo=dr,Rn=l.Md5=Qr,Cn=l.Integer=Jr;const kn="@firebase/firestore";class On{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}On.UNAUTHENTICATED=new On(null),On.GOOGLE_CREDENTIALS=new On("google-credentials-uid"),On.FIRST_PARTY=new On("first-party-uid"),On.MOCK_USER=new On("mock-user");let In="9.23.0";const Dn=new a.Yd("@firebase/firestore");function xn(){return Dn.logLevel}function Ln(t){if(Dn.logLevel<=a.in.DEBUG){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];const i=r.map(Mn);Dn.debug("Firestore (".concat(In,"): ").concat(t),...i)}}function Pn(t){if(Dn.logLevel<=a.in.ERROR){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];const i=r.map(Mn);Dn.error("Firestore (".concat(In,"): ").concat(t),...i)}}function Nn(t){if(Dn.logLevel<=a.in.WARN){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];const i=r.map(Mn);Dn.warn("Firestore (".concat(In,"): ").concat(t),...i)}}function Mn(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Fn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const e="FIRESTORE (".concat(In,") INTERNAL ASSERTION FAILED: ")+t;throw Pn(e),new Error(e)}function Un(t,e){t||Fn()}function Bn(t,e){return t}const jn={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vn extends o.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Gn{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Kn{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}}class Hn{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(On.UNAUTHENTICATED)))}shutdown(){}}class zn{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class qn{constructor(t){this.t=t,this.currentUser=On.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let r=this.i;const n=t=>this.i!==r?(r=this.i,e(t)):Promise.resolve();let i=new Gn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gn,t.enqueueRetryable((()=>n(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await n(this.currentUser)}))},a=t=>{Ln("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>a(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?a(t):(Ln("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gn)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ln("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Un("string"==typeof e.accessToken),new Kn(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Un(null===t||"string"==typeof t),new On(t)}}class Wn{constructor(t,e,r){this.h=t,this.l=e,this.m=r,this.type="FirstParty",this.user=On.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const t=this.p();return t&&this.g.set("Authorization",t),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Yn{constructor(t,e,r){this.h=t,this.l=e,this.m=r}getToken(){return Promise.resolve(new Wn(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(On.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Zn{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Xn{constructor(t){this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(t,e){const r=t=>{null!=t.error&&Ln("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));const r=t.token!==this.T;return this.T=t.token,Ln("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>r(e)))};const n=t=>{Ln("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.I.onInit((t=>n(t))),setTimeout((()=>{if(!this.appCheck){const t=this.I.getImmediate({optional:!0});t?n(t):Ln("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Un("string"==typeof t.token),this.T=t.token,new Zn(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Qn(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class $n{static A(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(256/62);let r="";for(;r.length<20;){const n=Qn(40);for(let i=0;i<n.length;++i)r.length<20&&n[i]<e&&(r+=t.charAt(n[i]%62))}return r}}function Jn(t,e){return t<e?-1:t>e?1:0}function ti(t,e,r){return t.length===e.length&&t.every(((t,n)=>r(t,e[n])))}class ei{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Vn(jn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Vn(jn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Vn(jn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Vn(jn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ei.fromMillis(Date.now())}static fromDate(t){return ei.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new ei(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Jn(this.nanoseconds,t.nanoseconds):Jn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ri{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ri(t)}static min(){return new ri(new ei(0,0))}static max(){return new ri(new ei(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ni{constructor(t,e,r){void 0===e?e=0:e>t.length&&Fn(),void 0===r?r=t.length-e:r>t.length-e&&Fn(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===ni.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof ni?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const r=t.get(n),i=e.get(n);if(r<i)return-1;if(r>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class ii extends ni{construct(t,e,r){return new ii(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const t=[];for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];for(const i of r){if(i.indexOf("//")>=0)throw new Vn(jn.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));t.push(...i.split("/").filter((t=>t.length>0)))}return new ii(t)}static emptyPath(){return new ii([])}}const si=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ai extends ni{construct(t,e,r){return new ai(t,e,r)}static isValidIdentifier(t){return si.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ai.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ai(["__name__"])}static fromServerFormat(t){const e=[];let r="",n=0;const i=()=>{if(0===r.length)throw new Vn(jn.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(r),r=""};let s=!1;for(;n<t.length;){const e=t[n];if("\\"===e){if(n+1===t.length)throw new Vn(jn.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[n+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Vn(jn.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=e,n+=2}else"`"===e?(s=!s,n++):"."!==e||s?(r+=e,n++):(i(),n++)}if(i(),s)throw new Vn(jn.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)}static emptyPath(){return new ai([])}}class oi{constructor(t){this.path=t}static fromPath(t){return new oi(ii.fromString(t))}static fromName(t){return new oi(ii.fromString(t).popFirst(5))}static empty(){return new oi(ii.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===ii.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return ii.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new oi(new ii(t.slice()))}}class ci{constructor(t,e,r,n){this.indexId=t,this.collectionGroup=e,this.fields=r,this.indexState=n}}ci.UNKNOWN_ID=-1;function li(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=ri.fromTimestamp(1e9===n?new ei(r+1,0):new ei(r,n));return new hi(i,oi.empty(),e)}function ui(t){return new hi(t.readTime,t.key,-1)}class hi{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new hi(ri.min(),oi.empty(),-1)}static max(){return new hi(ri.max(),oi.empty(),-1)}}function di(t,e){let r=t.readTime.compareTo(e.readTime);return 0!==r?r:(r=oi.comparator(t.documentKey,e.documentKey),0!==r?r:Jn(t.largestBatchId,e.largestBatchId))}const fi="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pi{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function gi(t){if(t.code!==jn.FAILED_PRECONDITION||t.message!==fi)throw t;Ln("LocalStore","Unexpectedly lost primary lease")}class mi{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Fn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new mi(((r,n)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(r,n)},this.catchCallback=t=>{this.wrapFailure(e,t).next(r,n)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof mi?e:mi.resolve(e)}catch(t){return mi.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):mi.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):mi.reject(e)}static resolve(t){return new mi(((e,r)=>{e(t)}))}static reject(t){return new mi(((e,r)=>{r(t)}))}static waitFor(t){return new mi(((e,r)=>{let n=0,i=0,s=!1;t.forEach((t=>{++n,t.next((()=>{++i,s&&i===n&&e()}),(t=>r(t)))})),s=!0,i===n&&e()}))}static or(t){let e=mi.resolve(!1);for(const r of t)e=e.next((t=>t?mi.resolve(t):r()));return e}static forEach(t,e){const r=[];return t.forEach(((t,n)=>{r.push(e.call(this,t,n))})),this.waitFor(r)}static mapArray(t,e){return new mi(((r,n)=>{const i=t.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const c=o;e(t[c]).next((t=>{s[c]=t,++a,a===i&&r(s)}),(t=>n(t)))}}))}static doWhile(t,e){return new mi(((r,n)=>{const i=()=>{!0===t()?e().next((()=>{i()}),n):r()};i()}))}}function vi(t){return"IndexedDbTransactionError"===t.name}class yi{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ot(t),this.ut=t=>e.writeSequenceNumber(t))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}function bi(t){return null==t}function Ei(t){return 0===t&&1/t==-1/0}function wi(t){return"number"==typeof t&&Number.isInteger(t)&&!Ei(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}yi.ct=-1;const Ti=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Si=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],_i=Si;function Ai(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ri(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Ci(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ki{constructor(t,e){this.comparator=t,this.root=e||Ii.EMPTY}insert(t,e){return new ki(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ii.BLACK,null,null))}remove(t){return new ki(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ii.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(0===n)return e+r.left.size;n<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,r)=>(t(e,r),!1)))}toString(){const t=[];return this.inorderTraversal(((e,r)=>(t.push("".concat(e,":").concat(r)),!1))),"{".concat(t.join(", "),"}")}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Oi(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Oi(this.root,t,this.comparator,!1)}getReverseIterator(){return new Oi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Oi(this.root,t,this.comparator,!0)}}class Oi{constructor(t,e,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&n&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ii{constructor(t,e,r,n,i){this.key=t,this.value=e,this.color=null!=r?r:Ii.RED,this.left=null!=n?n:Ii.EMPTY,this.right=null!=i?i:Ii.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,n,i){return new Ii(null!=t?t:this.key,null!=e?e:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let n=this;const i=r(t,n.key);return n=i<0?n.copy(null,null,null,n.left.insert(t,e,r),null):0===i?n.copy(null,e,null,null,null):n.copy(null,null,null,null,n.right.insert(t,e,r)),n.fixUp()}removeMin(){if(this.left.isEmpty())return Ii.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,n=this;if(e(t,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===e(t,n.key)){if(n.right.isEmpty())return Ii.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ii.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ii.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fn();if(this.right.isRed())throw Fn();const t=this.left.check();if(t!==this.right.check())throw Fn();return t+(this.isRed()?0:1)}}Ii.EMPTY=null,Ii.RED=!0,Ii.BLACK=!1,Ii.EMPTY=new class{constructor(){this.size=0}get key(){throw Fn()}get value(){throw Fn()}get color(){throw Fn()}get left(){throw Fn()}get right(){throw Fn()}copy(t,e,r,n,i){return this}insert(t,e,r){return new Ii(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Di{constructor(t){this.comparator=t,this.data=new ki(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,r)=>(t(e),!1)))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const n=r.getNext();if(this.comparator(n.key,t[1])>=0)return;e(n.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new xi(this.data.getIterator())}getIteratorFrom(t){return new xi(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Di))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,n=r.getNext().key;if(0!==this.comparator(t,n))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Di(this.comparator);return e.data=t,e}}class xi{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Li{constructor(t){this.fields=t,t.sort(ai.comparator)}static empty(){return new Li([])}unionWith(t){let e=new Di(ai.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Li(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return ti(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Pi extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ni{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Pi("Invalid base64 string: "+t):t}}(t);return new Ni(e)}static fromUint8Array(t){const e=function(t){let e="";for(let r=0;r<t.length;++r)e+=String.fromCharCode(t[r]);return e}(t);return new Ni(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Jn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ni.EMPTY_BYTE_STRING=new Ni("");const Mi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fi(t){if(Un(!!t),"string"==typeof t){let e=0;const r=Mi.exec(t);if(Un(!!r),r[1]){let t=r[1];t=(t+"000000000").substr(0,9),e=Number(t)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ui(t.seconds),nanos:Ui(t.nanos)}}function Ui(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bi(t){return"string"==typeof t?Ni.fromBase64String(t):Ni.fromUint8Array(t)}function ji(t){var e,r;return"server_timestamp"===(null===(r=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===r?void 0:r.stringValue)}function Vi(t){const e=t.mapValue.fields.__previous_value__;return ji(e)?Vi(e):e}function Gi(t){const e=Fi(t.mapValue.fields.__local_write_time__.timestampValue);return new ei(e.seconds,e.nanos)}class Ki{constructor(t,e,r,n,i,s,a,o,c){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=c}}class Hi{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Hi("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Hi&&t.projectId===this.projectId&&t.database===this.database}}const zi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function qi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ji(t)?4:as(t)?9007199254740991:10:Fn()}function Wi(t,e){if(t===e)return!0;const r=qi(t);if(r!==qi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Gi(t).isEqual(Gi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const r=Fi(t.timestampValue),n=Fi(e.timestampValue);return r.seconds===n.seconds&&r.nanos===n.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Bi(t.bytesValue).isEqual(Bi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ui(t.geoPointValue.latitude)===Ui(e.geoPointValue.latitude)&&Ui(t.geoPointValue.longitude)===Ui(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ui(t.integerValue)===Ui(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const r=Ui(t.doubleValue),n=Ui(e.doubleValue);return r===n?Ei(r)===Ei(n):isNaN(r)&&isNaN(n)}return!1}(t,e);case 9:return ti(t.arrayValue.values||[],e.arrayValue.values||[],Wi);case 10:return function(t,e){const r=t.mapValue.fields||{},n=e.mapValue.fields||{};if(Ai(r)!==Ai(n))return!1;for(const i in r)if(r.hasOwnProperty(i)&&(void 0===n[i]||!Wi(r[i],n[i])))return!1;return!0}(t,e);default:return Fn()}}function Yi(t,e){return void 0!==(t.values||[]).find((t=>Wi(t,e)))}function Zi(t,e){if(t===e)return 0;const r=qi(t),n=qi(e);if(r!==n)return Jn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Jn(t.booleanValue,e.booleanValue);case 2:return function(t,e){const r=Ui(t.integerValue||t.doubleValue),n=Ui(e.integerValue||e.doubleValue);return r<n?-1:r>n?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1}(t,e);case 3:return Xi(t.timestampValue,e.timestampValue);case 4:return Xi(Gi(t),Gi(e));case 5:return Jn(t.stringValue,e.stringValue);case 6:return function(t,e){const r=Bi(t),n=Bi(e);return r.compareTo(n)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const r=t.split("/"),n=e.split("/");for(let i=0;i<r.length&&i<n.length;i++){const t=Jn(r[i],n[i]);if(0!==t)return t}return Jn(r.length,n.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const r=Jn(Ui(t.latitude),Ui(e.latitude));return 0!==r?r:Jn(Ui(t.longitude),Ui(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const t=Zi(r[i],n[i]);if(t)return t}return Jn(r.length,n.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===zi.mapValue&&e===zi.mapValue)return 0;if(t===zi.mapValue)return 1;if(e===zi.mapValue)return-1;const r=t.fields||{},n=Object.keys(r),i=e.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let a=0;a<n.length&&a<s.length;++a){const t=Jn(n[a],s[a]);if(0!==t)return t;const e=Zi(r[n[a]],i[s[a]]);if(0!==e)return e}return Jn(n.length,s.length)}(t.mapValue,e.mapValue);default:throw Fn()}}function Xi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Jn(t,e);const r=Fi(t),n=Fi(e),i=Jn(r.seconds,n.seconds);return 0!==i?i:Jn(r.nanos,n.nanos)}function Qi(t){return $i(t)}function $i(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Fi(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bi(t.bytesValue).toBase64():"referenceValue"in t?(r=t.referenceValue,oi.fromName(r).toString()):"geoPointValue"in t?"geo(".concat((e=t.geoPointValue).latitude,",").concat(e.longitude,")"):"arrayValue"in t?function(t){let e="[",r=!0;for(const n of t.values||[])r?r=!1:e+=",",e+=$i(n);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let r="{",n=!0;for(const i of e)n?n=!1:r+=",",r+="".concat(i,":").concat($i(t.fields[i]));return r+"}"}(t.mapValue):Fn();var e,r}function Ji(t,e){return{referenceValue:"projects/".concat(t.projectId,"/databases/").concat(t.database,"/documents/").concat(e.path.canonicalString())}}function ts(t){return!!t&&"integerValue"in t}function es(t){return!!t&&"arrayValue"in t}function rs(t){return!!t&&"nullValue"in t}function ns(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function is(t){return!!t&&"mapValue"in t}function ss(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ri(t.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ss(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ss(t.arrayValue.values[r]);return e}return Object.assign({},t)}function as(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class os{constructor(t){this.value=t}static empty(){return new os({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!is(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ss(e)}setAll(t){let e=ai.emptyPath(),r={},n=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,r,n),r={},n=[],e=i.popLast()}t?r[i.lastSegment()]=ss(t):n.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,r,n)}delete(t){const e=this.field(t.popLast());is(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Wi(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let n=e.mapValue.fields[t.get(r)];is(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=n),e=n}return e.mapValue.fields}applyChanges(t,e,r){Ri(e,((e,r)=>t[e]=r));for(const n of r)delete t[n]}clone(){return new os(ss(this.value))}}function cs(t){const e=[];return Ri(t.fields,((t,r)=>{const n=new ai([t]);if(is(r)){const t=cs(r.mapValue).fields;if(0===t.length)e.push(n);else for(const r of t)e.push(n.child(r))}else e.push(n)})),new Li(e)}class ls{constructor(t,e,r,n,i,s,a){this.key=t,this.documentType=e,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(t){return new ls(t,0,ri.min(),ri.min(),ri.min(),os.empty(),0)}static newFoundDocument(t,e,r,n){return new ls(t,1,e,ri.min(),r,n,0)}static newNoDocument(t,e){return new ls(t,2,e,ri.min(),ri.min(),os.empty(),0)}static newUnknownDocument(t,e){return new ls(t,3,e,ri.min(),ri.min(),os.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(ri.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=os.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=os.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ri.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof ls&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ls(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class us{constructor(t,e){this.position=t,this.inclusive=e}}function hs(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(n=s.field.isKeyField()?oi.comparator(oi.fromName(a.referenceValue),r.key):Zi(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function ds(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Wi(t.position[r],e.position[r]))return!1;return!0}class fs{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=t,this.dir=e}}function ps(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class gs{}class ms extends gs{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,r):new _s(t,e,r):"array-contains"===e?new ks(t,r):"in"===e?new Os(t,r):"not-in"===e?new Is(t,r):"array-contains-any"===e?new Ds(t,r):new ms(t,e,r)}static createKeyFieldInFilter(t,e,r){return"in"===e?new As(t,r):new Rs(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Zi(e,this.value)):null!==e&&qi(this.value)===qi(e)&&this.matchesComparison(Zi(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Fn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class vs extends gs{constructor(t,e){super(),this.filters=t,this.op=e,this.lt=null}static create(t,e){return new vs(t,e)}matches(t){return ys(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.ft((t=>t.isInequality()));return null!==t?t.field:null}ft(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function ys(t){return"and"===t.op}function bs(t){return Es(t)&&ys(t)}function Es(t){for(const e of t.filters)if(e instanceof vs)return!1;return!0}function ws(t){if(t instanceof ms)return t.field.canonicalString()+t.op.toString()+Qi(t.value);if(bs(t))return t.filters.map((t=>ws(t))).join(",");{const e=t.filters.map((t=>ws(t))).join(",");return"".concat(t.op,"(").concat(e,")")}}function Ts(t,e){return t instanceof ms?function(t,e){return e instanceof ms&&t.op===e.op&&t.field.isEqual(e.field)&&Wi(t.value,e.value)}(t,e):t instanceof vs?function(t,e){return e instanceof vs&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,r,n)=>t&&Ts(r,e.filters[n])),!0)}(t,e):void Fn()}function Ss(t){return t instanceof ms?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(Qi(t.value))}(t):t instanceof vs?function(t){return t.op.toString()+" {"+t.getFilters().map(Ss).join(" ,")+"}"}(t):"Filter"}class _s extends ms{constructor(t,e,r){super(t,e,r),this.key=oi.fromName(r.referenceValue)}matches(t){const e=oi.comparator(t.key,this.key);return this.matchesComparison(e)}}class As extends ms{constructor(t,e){super(t,"in",e),this.keys=Cs("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Rs extends ms{constructor(t,e){super(t,"not-in",e),this.keys=Cs("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Cs(t,e){var r;return((null===(r=e.arrayValue)||void 0===r?void 0:r.values)||[]).map((t=>oi.fromName(t.referenceValue)))}class ks extends ms{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return es(e)&&Yi(e.arrayValue,this.value)}}class Os extends ms{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Yi(this.value.arrayValue,e)}}class Is extends ms{constructor(t,e){super(t,"not-in",e)}matches(t){if(Yi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Yi(this.value.arrayValue,e)}}class Ds extends ms{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!es(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Yi(this.value.arrayValue,t)))}}class xs{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.dt=null}}function Ls(t){return new xs(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ps(t){const e=Bn(t);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>ws(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),bi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Qi(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Qi(t))).join(",")),e.dt=t}return e.dt}function Ns(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!ps(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Ts(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ds(t.startAt,e.startAt)&&ds(t.endAt,e.endAt)}function Ms(t){return oi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Fs{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.wt=null,this._t=null,this.startAt,this.endAt}}function Us(t,e,r,n,i,s,a,o){return new Fs(t,e,r,n,i,s,a,o)}function Bs(t){return new Fs(t)}function js(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Vs(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Gs(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Ks(t){return null!==t.collectionGroup}function Hs(t){const e=Bn(t);if(null===e.wt){e.wt=[];const t=Gs(e),r=Vs(e);if(null!==t&&null===r)t.isKeyField()||e.wt.push(new fs(t)),e.wt.push(new fs(ai.keyField(),"asc"));else{let t=!1;for(const r of e.explicitOrderBy)e.wt.push(r),r.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new fs(ai.keyField(),t))}}}return e.wt}function zs(t){const e=Bn(t);if(!e._t)if("F"===e.limitType)e._t=Ls(e.path,e.collectionGroup,Hs(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of Hs(e)){const e="desc"===i.dir?"asc":"desc";t.push(new fs(i.field,e))}const r=e.endAt?new us(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new us(e.startAt.position,e.startAt.inclusive):null;e._t=Ls(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}return e._t}function qs(t,e){e.getFirstInequalityField(),Gs(t);const r=t.filters.concat([e]);return new Fs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Ws(t,e,r){return new Fs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ys(t,e){return Ns(zs(t),zs(e))&&t.limitType===e.limitType}function Zs(t){return"".concat(Ps(zs(t)),"|lt:").concat(t.limitType)}function Xs(t){return"Query(target=".concat(function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map((t=>Ss(t))).join(", "),"]")),bi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map((t=>function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t))).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Qi(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Qi(t))).join(",")),"Target(".concat(e,")")}(zs(t)),"; limitType=").concat(t.limitType,")")}function Qs(t,e){return e.isFoundDocument()&&function(t,e){const r=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):oi.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(t,e)&&function(t,e){for(const r of Hs(t))if(!r.field.isKeyField()&&null===e.data.field(r.field))return!1;return!0}(t,e)&&function(t,e){for(const r of t.filters)if(!r.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,r){const n=hs(t,e,r);return t.inclusive?n<=0:n<0}(t.startAt,Hs(t),e))&&!(t.endAt&&!function(t,e,r){const n=hs(t,e,r);return t.inclusive?n>=0:n>0}(t.endAt,Hs(t),e))}(t,e)}function $s(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Js(t){return(e,r)=>{let n=!1;for(const i of Hs(t)){const t=ta(i,e,r);if(0!==t)return t;n=n||i.field.isKeyField()}return 0}}function ta(t,e,r){const n=t.field.isKeyField()?oi.comparator(e.key,r.key):function(t,e,r){const n=e.data.field(t),i=r.data.field(t);return null!==n&&null!==i?Zi(n,i):Fn()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Fn()}}class ea{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[n,i]of r)if(this.equalsFn(n,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),n=this.inner[r];if(void 0===n)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return void(n[i]=[t,e]);n.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return 1===r.length?delete this.inner[e]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(t){Ri(this.inner,((e,r)=>{for(const[n,i]of r)t(n,i)}))}isEmpty(){return Ci(this.inner)}size(){return this.innerSize}}const ra=new ki(oi.comparator);function na(){return ra}const ia=new ki(oi.comparator);function sa(){let t=ia;for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];for(const i of r)t=t.insert(i.key,i);return t}function aa(t){let e=ia;return t.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function oa(){return la()}function ca(){return la()}function la(){return new ea((t=>t.toString()),((t,e)=>t.isEqual(e)))}const ua=new ki(oi.comparator),ha=new Di(oi.comparator);function da(){let t=ha;for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];for(const i of r)t=t.add(i);return t}const fa=new Di(Jn);function pa(){return fa}function ga(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ei(e)?"-0":e}}function ma(t){return{integerValue:""+t}}function va(t,e){return wi(e)?ma(e):ga(t,e)}class ya{constructor(){this._=void 0}}function ba(t,e,r){return t instanceof Ta?function(t,e){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&ji(e)&&(e=Vi(e)),e&&(r.fields.__previous_value__=e),{mapValue:r}}(r,e):t instanceof Sa?_a(t,e):t instanceof Aa?Ra(t,e):function(t,e){const r=wa(t,e),n=ka(r)+ka(t.gt);return ts(r)&&ts(t.gt)?ma(n):ga(t.serializer,n)}(t,e)}function Ea(t,e,r){return t instanceof Sa?_a(t,e):t instanceof Aa?Ra(t,e):r}function wa(t,e){return t instanceof Ca?ts(r=e)||function(t){return!!t&&"doubleValue"in t}(r)?e:{integerValue:0}:null;var r}class Ta extends ya{}class Sa extends ya{constructor(t){super(),this.elements=t}}function _a(t,e){const r=Oa(e);for(const n of t.elements)r.some((t=>Wi(t,n)))||r.push(n);return{arrayValue:{values:r}}}class Aa extends ya{constructor(t){super(),this.elements=t}}function Ra(t,e){let r=Oa(e);for(const n of t.elements)r=r.filter((t=>!Wi(t,n)));return{arrayValue:{values:r}}}class Ca extends ya{constructor(t,e){super(),this.serializer=t,this.gt=e}}function ka(t){return Ui(t.integerValue||t.doubleValue)}function Oa(t){return es(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ia{constructor(t,e){this.field=t,this.transform=e}}class Da{constructor(t,e){this.version=t,this.transformResults=e}}class xa{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new xa}static exists(t){return new xa(void 0,t)}static updateTime(t){return new xa(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function La(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Pa{}function Na(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new za(t.key,xa.none()):new ja(t.key,t.data,xa.none());{const r=t.data,n=os.empty();let i=new Di(ai.comparator);for(let t of e.fields)if(!i.has(t)){let e=r.field(t);null===e&&t.length>1&&(t=t.popLast(),e=r.field(t)),null===e?n.delete(t):n.set(t,e),i=i.add(t)}return new Va(t.key,n,new Li(i.toArray()),xa.none())}}function Ma(t,e,r){t instanceof ja?function(t,e,r){const n=t.value.clone(),i=Ka(t.fieldTransforms,e,r.transformResults);n.setAll(i),e.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(t,e,r):t instanceof Va?function(t,e,r){if(!La(t.precondition,e))return void e.convertToUnknownDocument(r.version);const n=Ka(t.fieldTransforms,e,r.transformResults),i=e.data;i.setAll(Ga(t)),i.setAll(n),e.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(t,e,r):function(t,e,r){e.convertToNoDocument(r.version).setHasCommittedMutations()}(0,e,r)}function Fa(t,e,r,n){return t instanceof ja?function(t,e,r,n){if(!La(t.precondition,e))return r;const i=t.value.clone(),s=Ha(t.fieldTransforms,n,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,r,n):t instanceof Va?function(t,e,r,n){if(!La(t.precondition,e))return r;const i=Ha(t.fieldTransforms,n,e),s=e.data;return s.setAll(Ga(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===r?null:r.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,r,n):function(t,e,r){return La(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):r}(t,e,r)}function Ua(t,e){let r=null;for(const n of t.fieldTransforms){const t=e.data.field(n.field),i=wa(n.transform,t||null);null!=i&&(null===r&&(r=os.empty()),r.set(n.field,i))}return r||null}function Ba(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ti(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Sa&&e instanceof Sa||t instanceof Aa&&e instanceof Aa?ti(t.elements,e.elements,Wi):t instanceof Ca&&e instanceof Ca?Wi(t.gt,e.gt):t instanceof Ta&&e instanceof Ta}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ja extends Pa{constructor(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class Va extends Pa{constructor(t,e,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ga(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function Ka(t,e,r){const n=new Map;Un(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,Ea(a,o,r[i]))}return n}function Ha(t,e,r){const n=new Map;for(const i of t){const t=i.transform,s=r.data.field(i.field);n.set(i.field,ba(t,s,e))}return n}class za extends Pa{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qa extends Pa{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Wa{constructor(t,e,r,n){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let n=0;n<this.mutations.length;n++){const e=this.mutations[n];e.key.isEqual(t.key)&&Ma(e,t,r[n])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=Fa(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=Fa(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=ca();return this.mutations.forEach((n=>{const i=t.get(n.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=e.has(n.key)?null:a;const o=Na(s,a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(ri.min())})),r}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),da())}isEqual(t){return this.batchId===t.batchId&&ti(this.mutations,t.mutations,((t,e)=>Ba(t,e)))&&ti(this.baseMutations,t.baseMutations,((t,e)=>Ba(t,e)))}}class Ya{constructor(t,e,r,n){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=n}static from(t,e,r){Un(t.mutations.length===r.length);let n=ua;const i=t.mutations;for(let s=0;s<i.length;s++)n=n.insert(i[s].key,r[s].version);return new Ya(t,e,r,n)}}class Za{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Xa{constructor(t,e){this.count=t,this.unchangedNames=e}}var Qa,$a;function Ja(t){switch(t){default:return Fn();case jn.CANCELLED:case jn.UNKNOWN:case jn.DEADLINE_EXCEEDED:case jn.RESOURCE_EXHAUSTED:case jn.INTERNAL:case jn.UNAVAILABLE:case jn.UNAUTHENTICATED:return!1;case jn.INVALID_ARGUMENT:case jn.NOT_FOUND:case jn.ALREADY_EXISTS:case jn.PERMISSION_DENIED:case jn.FAILED_PRECONDITION:case jn.ABORTED:case jn.OUT_OF_RANGE:case jn.UNIMPLEMENTED:case jn.DATA_LOSS:return!0}}function to(t){if(void 0===t)return Pn("GRPC error has no .code"),jn.UNKNOWN;switch(t){case Qa.OK:return jn.OK;case Qa.CANCELLED:return jn.CANCELLED;case Qa.UNKNOWN:return jn.UNKNOWN;case Qa.DEADLINE_EXCEEDED:return jn.DEADLINE_EXCEEDED;case Qa.RESOURCE_EXHAUSTED:return jn.RESOURCE_EXHAUSTED;case Qa.INTERNAL:return jn.INTERNAL;case Qa.UNAVAILABLE:return jn.UNAVAILABLE;case Qa.UNAUTHENTICATED:return jn.UNAUTHENTICATED;case Qa.INVALID_ARGUMENT:return jn.INVALID_ARGUMENT;case Qa.NOT_FOUND:return jn.NOT_FOUND;case Qa.ALREADY_EXISTS:return jn.ALREADY_EXISTS;case Qa.PERMISSION_DENIED:return jn.PERMISSION_DENIED;case Qa.FAILED_PRECONDITION:return jn.FAILED_PRECONDITION;case Qa.ABORTED:return jn.ABORTED;case Qa.OUT_OF_RANGE:return jn.OUT_OF_RANGE;case Qa.UNIMPLEMENTED:return jn.UNIMPLEMENTED;case Qa.DATA_LOSS:return jn.DATA_LOSS;default:return Fn()}}($a=Qa||(Qa={}))[$a.OK=0]="OK",$a[$a.CANCELLED=1]="CANCELLED",$a[$a.UNKNOWN=2]="UNKNOWN",$a[$a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$a[$a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$a[$a.NOT_FOUND=5]="NOT_FOUND",$a[$a.ALREADY_EXISTS=6]="ALREADY_EXISTS",$a[$a.PERMISSION_DENIED=7]="PERMISSION_DENIED",$a[$a.UNAUTHENTICATED=16]="UNAUTHENTICATED",$a[$a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$a[$a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$a[$a.ABORTED=10]="ABORTED",$a[$a.OUT_OF_RANGE=11]="OUT_OF_RANGE",$a[$a.UNIMPLEMENTED=12]="UNIMPLEMENTED",$a[$a.INTERNAL=13]="INTERNAL",$a[$a.UNAVAILABLE=14]="UNAVAILABLE",$a[$a.DATA_LOSS=15]="DATA_LOSS";class eo{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return ro}static getOrCreateInstance(){return null===ro&&(ro=new eo),ro}onExistenceFilterMismatch(t){const e=Symbol();return this.onExistenceFilterMismatchCallbacks.set(e,t),()=>this.onExistenceFilterMismatchCallbacks.delete(e)}notifyOnExistenceFilterMismatch(t){this.onExistenceFilterMismatchCallbacks.forEach((e=>e(t)))}}let ro=null;function no(){return new TextEncoder}const io=new Cn([4294967295,4294967295],0);function so(t){const e=no().encode(t),r=new Rn;return r.update(e),new Uint8Array(r.digest())}function ao(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Cn([r,n],0),new Cn([i,s],0)]}class oo{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new co("Invalid padding: ".concat(e));if(r<0)throw new co("Invalid hash count: ".concat(r));if(t.length>0&&0===this.hashCount)throw new co("Invalid hash count: ".concat(r));if(0===t.length&&0!==e)throw new co("Invalid padding when bitmap length is 0: ".concat(e));this.It=8*t.length-e,this.Tt=Cn.fromNumber(this.It)}Et(t,e,r){let n=t.add(e.multiply(Cn.fromNumber(r)));return 1===n.compare(io)&&(n=new Cn([n.getBits(0),n.getBits(1)],0)),n.modulo(this.Tt).toNumber()}At(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}vt(t){if(0===this.It)return!1;const e=so(t),[r,n]=ao(e);for(let i=0;i<this.hashCount;i++){const t=this.Et(r,n,i);if(!this.At(t))return!1}return!0}static create(t,e,r){const n=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),s=new oo(i,n,e);return r.forEach((t=>s.insert(t))),s}insert(t){if(0===this.It)return;const e=so(t),[r,n]=ao(e);for(let i=0;i<this.hashCount;i++){const t=this.Et(r,n,i);this.Rt(t)}}Rt(t){const e=Math.floor(t/8),r=t%8;this.bitmap[e]|=1<<r}}class co extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class lo{constructor(t,e,r,n,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const n=new Map;return n.set(t,uo.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new lo(ri.min(),n,new ki(Jn),na(),da())}}class uo{constructor(t,e,r,n,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new uo(r,e,da(),da(),da())}}class ho{constructor(t,e,r,n){this.Pt=t,this.removedTargetIds=e,this.key=r,this.bt=n}}class fo{constructor(t,e){this.targetId=t,this.Vt=e}}class po{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ni.EMPTY_BYTE_STRING,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=n}}class go{constructor(){this.St=0,this.Dt=yo(),this.Ct=Ni.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(t){t.approximateByteSize()>0&&(this.Nt=!0,this.Ct=t)}Ot(){let t=da(),e=da(),r=da();return this.Dt.forEach(((n,i)=>{switch(i){case 0:t=t.add(n);break;case 2:e=e.add(n);break;case 1:r=r.add(n);break;default:Fn()}})),new uo(this.Ct,this.xt,t,e,r)}Ft(){this.Nt=!1,this.Dt=yo()}Bt(t,e){this.Nt=!0,this.Dt=this.Dt.insert(t,e)}Lt(t){this.Nt=!0,this.Dt=this.Dt.remove(t)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class mo{constructor(t){this.Gt=t,this.Qt=new Map,this.jt=na(),this.zt=vo(),this.Wt=new ki(Jn)}Ht(t){for(const e of t.Pt)t.bt&&t.bt.isFoundDocument()?this.Jt(e,t.bt):this.Yt(e,t.key,t.bt);for(const e of t.removedTargetIds)this.Yt(e,t.key,t.bt)}Xt(t){this.forEachTarget(t,(e=>{const r=this.Zt(e);switch(t.state){case 0:this.te(e)&&r.$t(t.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(t.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(e);break;case 3:this.te(e)&&(r.Kt(),r.$t(t.resumeToken));break;case 4:this.te(e)&&(this.ee(e),r.$t(t.resumeToken));break;default:Fn()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Qt.forEach(((t,r)=>{this.te(r)&&e(r)}))}ne(t){var e;const r=t.targetId,n=t.Vt.count,i=this.se(r);if(i){const s=i.target;if(Ms(s))if(0===n){const t=new oi(s.path);this.Yt(r,t,ls.newNoDocument(t,ri.min()))}else Un(1===n);else{const i=this.ie(r);if(i!==n){const n=this.re(t,i);if(0!==n){this.ee(r);const t=2===n?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,t)}null===(e=eo.instance)||void 0===e||e.notifyOnExistenceFilterMismatch(function(t,e,r){var n,i,s,a,o,c;const l={localCacheCount:e,existenceFilterCount:r.count},u=r.unchangedNames;return u&&(l.bloomFilter={applied:0===t,hashCount:null!==(n=null==u?void 0:u.hashCount)&&void 0!==n?n:0,bitmapLength:null!==(a=null===(s=null===(i=null==u?void 0:u.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==a?a:0,padding:null!==(c=null===(o=null==u?void 0:u.bits)||void 0===o?void 0:o.padding)&&void 0!==c?c:0}),l}(n,i,t.Vt))}}}}re(t,e){const{unchangedNames:r,count:n}=t.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=r;let o,c;try{o=Bi(i).toUint8Array()}catch(t){if(t instanceof Pi)return Nn("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw t}try{c=new oo(o,s,a)}catch(t){return Nn(t instanceof co?"BloomFilter error: ":"Applying bloom filter failed: ",t),1}return 0===c.It?1:n!==e-this.oe(t.targetId,c)?2:0}oe(t,e){const r=this.Gt.getRemoteKeysForTarget(t);let n=0;return r.forEach((r=>{const i=this.Gt.ue(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(r.path.canonicalString());e.vt(s)||(this.Yt(t,r,null),n++)})),n}ce(t){const e=new Map;this.Qt.forEach(((r,n)=>{const i=this.se(n);if(i){if(r.current&&Ms(i.target)){const e=new oi(i.target.path);null!==this.jt.get(e)||this.ae(n,e)||this.Yt(n,e,ls.newNoDocument(e,t))}r.Mt&&(e.set(n,r.Ot()),r.Ft())}}));let r=da();this.zt.forEach(((t,e)=>{let n=!0;e.forEachWhile((t=>{const e=this.se(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(n=!1,!1)})),n&&(r=r.add(t))})),this.jt.forEach(((e,r)=>r.setReadTime(t)));const n=new lo(t,e,this.Wt,this.jt,r);return this.jt=na(),this.zt=vo(),this.Wt=new ki(Jn),n}Jt(t,e){if(!this.te(t))return;const r=this.ae(t,e.key)?2:0;this.Zt(t).Bt(e.key,r),this.jt=this.jt.insert(e.key,e),this.zt=this.zt.insert(e.key,this.he(e.key).add(t))}Yt(t,e,r){if(!this.te(t))return;const n=this.Zt(t);this.ae(t,e)?n.Bt(e,1):n.Lt(e),this.zt=this.zt.insert(e,this.he(e).delete(t)),r&&(this.jt=this.jt.insert(e,r))}removeTarget(t){this.Qt.delete(t)}ie(t){const e=this.Zt(t).Ot();return this.Gt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}qt(t){this.Zt(t).qt()}Zt(t){let e=this.Qt.get(t);return e||(e=new go,this.Qt.set(t,e)),e}he(t){let e=this.zt.get(t);return e||(e=new Di(Jn),this.zt=this.zt.insert(t,e)),e}te(t){const e=null!==this.se(t);return e||Ln("WatchChangeAggregator","Detected inactive target",t),e}se(t){const e=this.Qt.get(t);return e&&e.kt?null:this.Gt.le(t)}ee(t){this.Qt.set(t,new go),this.Gt.getRemoteKeysForTarget(t).forEach((e=>{this.Yt(t,e,null)}))}ae(t,e){return this.Gt.getRemoteKeysForTarget(t).has(e)}}function vo(){return new ki(oi.comparator)}function yo(){return new ki(oi.comparator)}const bo={asc:"ASCENDING",desc:"DESCENDING"},Eo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wo={and:"AND",or:"OR"};class To{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function So(t,e){return t.useProto3Json||bi(e)?e:{value:e}}function _o(t,e){return t.useProto3Json?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ao(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Ro(t,e){return _o(t,e.toTimestamp())}function Co(t){return Un(!!t),ri.fromTimestamp(function(t){const e=Fi(t);return new ei(e.seconds,e.nanos)}(t))}function ko(t,e){return function(t){return new ii(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Oo(t){const e=ii.fromString(t);return Un(Zo(e)),e}function Io(t,e){return ko(t.databaseId,e.path)}function Do(t,e){const r=Oo(e);if(r.get(1)!==t.databaseId.projectId)throw new Vn(jn.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Vn(jn.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new oi(No(r))}function xo(t,e){return ko(t.databaseId,e)}function Lo(t){const e=Oo(t);return 4===e.length?ii.emptyPath():No(e)}function Po(t){return new ii(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function No(t){return Un(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Mo(t,e,r){return{name:Io(t,e),fields:r.value.mapValue.fields}}function Fo(t,e){let r;if(e instanceof ja)r={update:Mo(t,e.key,e.value)};else if(e instanceof za)r={delete:Io(t,e.key)};else if(e instanceof Va)r={update:Mo(t,e.key,e.data),updateMask:Yo(e.fieldMask)};else{if(!(e instanceof qa))return Fn();r={verify:Io(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const r=e.transform;if(r instanceof Ta)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof Sa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof Aa)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof Ca)return{fieldPath:e.field.canonicalString(),increment:r.gt};throw Fn()}(0,t)))),e.precondition.isNone||(r.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ro(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Fn()}(t,e.precondition)),r}function Uo(t,e){return{documents:[xo(t,e.path)]}}function Bo(t,e){const r={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(r.parent=xo(t,n),r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r.parent=xo(t,n.popLast()),r.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(t){if(0!==t.length)return Wo(vs.create(t,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:zo(t.field),direction:Go(t.dir)}}(t)))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const a=So(t,e.limit);var o;return null!==a&&(r.structuredQuery.limit=a),e.startAt&&(r.structuredQuery.startAt={before:(o=e.startAt).inclusive,values:o.position}),e.endAt&&(r.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),r}function jo(t){let e=Lo(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Un(1===n);const t=r.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];r.where&&(s=function(t){const e=Vo(t);return e instanceof vs&&bs(e)?e.getFilters():[e]}(r.where));let a=[];r.orderBy&&(a=r.orderBy.map((t=>function(t){return new fs(qo(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let o=null;r.limit&&(o=function(t){let e;return e="object"==typeof t?t.value:t,bi(e)?null:e}(r.limit));let c=null;r.startAt&&(c=function(t){const e=!!t.before,r=t.values||[];return new us(r,e)}(r.startAt));let l=null;return r.endAt&&(l=function(t){const e=!t.before,r=t.values||[];return new us(r,e)}(r.endAt)),Us(e,i,a,s,o,"F",c,l)}function Vo(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=qo(t.unaryFilter.field);return ms.create(e,"==",{doubleValue:NaN});case"IS_NULL":const r=qo(t.unaryFilter.field);return ms.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const n=qo(t.unaryFilter.field);return ms.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=qo(t.unaryFilter.field);return ms.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Fn()}}(t):void 0!==t.fieldFilter?function(t){return ms.create(qo(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Fn()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return vs.create(t.compositeFilter.filters.map((t=>Vo(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Fn()}}(t.compositeFilter.op))}(t):Fn()}function Go(t){return bo[t]}function Ko(t){return Eo[t]}function Ho(t){return wo[t]}function zo(t){return{fieldPath:t.canonicalString()}}function qo(t){return ai.fromServerFormat(t.fieldPath)}function Wo(t){return t instanceof ms?function(t){if("=="===t.op){if(ns(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NAN"}};if(rs(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ns(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NAN"}};if(rs(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(t.field),op:Ko(t.op),value:t.value}}}(t):t instanceof vs?function(t){const e=t.getFilters().map((t=>Wo(t)));return 1===e.length?e[0]:{compositeFilter:{op:Ho(t.op),filters:e}}}(t):Fn()}function Yo(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Zo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Xo{constructor(t,e,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ri.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ri.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ni.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(t){return new Xo(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Qo{constructor(t){this.fe=t}}function $o(t){const e=jo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ws(e,e.limit,"L"):e}class Jo{constructor(){}_e(t,e){this.me(t,e),e.ge()}me(t,e){if("nullValue"in t)this.ye(e,5);else if("booleanValue"in t)this.ye(e,10),e.pe(t.booleanValue?1:0);else if("integerValue"in t)this.ye(e,15),e.pe(Ui(t.integerValue));else if("doubleValue"in t){const r=Ui(t.doubleValue);isNaN(r)?this.ye(e,13):(this.ye(e,15),Ei(r)?e.pe(0):e.pe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.ye(e,20),"string"==typeof r?e.Ie(r):(e.Ie("".concat(r.seconds||"")),e.pe(r.nanos||0))}else if("stringValue"in t)this.Te(t.stringValue,e),this.Ee(e);else if("bytesValue"in t)this.ye(e,30),e.Ae(Bi(t.bytesValue)),this.Ee(e);else if("referenceValue"in t)this.ve(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.ye(e,45),e.pe(r.latitude||0),e.pe(r.longitude||0)}else"mapValue"in t?as(t)?this.ye(e,Number.MAX_SAFE_INTEGER):(this.Re(t.mapValue,e),this.Ee(e)):"arrayValue"in t?(this.Pe(t.arrayValue,e),this.Ee(e)):Fn()}Te(t,e){this.ye(e,25),this.be(t,e)}be(t,e){e.Ie(t)}Re(t,e){const r=t.fields||{};this.ye(e,55);for(const n of Object.keys(r))this.Te(n,e),this.me(r[n],e)}Pe(t,e){const r=t.values||[];this.ye(e,50);for(const n of r)this.me(n,e)}ve(t,e){this.ye(e,37),oi.fromName(t).path.forEach((t=>{this.ye(e,60),this.be(t,e)}))}ye(t,e){t.pe(e)}Ee(t){t.pe(2)}}Jo.Ve=new Jo;class tc{constructor(){this.rn=new ec}addToCollectionParentIndex(t,e){return this.rn.add(e),mi.resolve()}getCollectionParents(t,e){return mi.resolve(this.rn.getEntries(e))}addFieldIndex(t,e){return mi.resolve()}deleteFieldIndex(t,e){return mi.resolve()}getDocumentsMatchingTarget(t,e){return mi.resolve(null)}getIndexType(t,e){return mi.resolve(0)}getFieldIndexes(t,e){return mi.resolve([])}getNextCollectionGroupToUpdate(t){return mi.resolve(null)}getMinOffset(t,e){return mi.resolve(hi.min())}getMinOffsetFromCollectionGroup(t,e){return mi.resolve(hi.min())}updateCollectionGroup(t,e,r){return mi.resolve()}updateIndexEntries(t,e){return mi.resolve()}}class ec{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),n=this.index[e]||new Di(ii.comparator),i=!n.has(r);return this.index[e]=n.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),n=this.index[e];return n&&n.has(r)}getEntries(t){return(this.index[t]||new Di(ii.comparator)).toArray()}}new Uint8Array(0);class rc{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new rc(t,rc.DEFAULT_COLLECTION_PERCENTILE,rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}rc.DEFAULT_COLLECTION_PERCENTILE=10,rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rc.DEFAULT=new rc(41943040,rc.DEFAULT_COLLECTION_PERCENTILE,rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rc.DISABLED=new rc(-1,0,0);class nc{constructor(t){this.Nn=t}next(){return this.Nn+=2,this.Nn}static kn(){return new nc(0)}static Mn(){return new nc(-1)}}class ic{constructor(){this.changes=new ea((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,ls.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?mi.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class sc{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class ac{constructor(t,e,r,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=n}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next((n=>(r=n,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==r&&Fa(r.mutation,t,Li.empty(),ei.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,da()).next((()=>e))))}getLocalViewOfDocuments(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:da();const n=oa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,r).next((t=>{let e=sa();return t.forEach(((t,r)=>{e=e.insert(t,r.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const r=oa();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,da())))}populateOverlays(t,e,r){const n=[];return r.forEach((t=>{e.has(t)||n.push(t)})),this.documentOverlayCache.getOverlays(t,n).next((t=>{t.forEach(((t,r)=>{e.set(t,r)}))}))}computeViews(t,e,r,n){let i=na();const s=la(),a=la();return e.forEach(((t,e)=>{const a=r.get(e.key);n.has(e.key)&&(void 0===a||a.mutation instanceof Va)?i=i.insert(e.key,e):void 0!==a?(s.set(e.key,a.mutation.getFieldMask()),Fa(a.mutation,e,a.mutation.getFieldMask(),ei.now())):s.set(e.key,Li.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var r;return a.set(t,new sc(e,null!==(r=s.get(t))&&void 0!==r?r:null))})),a)))}recalculateAndSaveOverlays(t,e){const r=la();let n=new ki(((t,e)=>t-e)),i=da();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let a=r.get(t)||Li.empty();a=i.applyToLocalView(s,a),r.set(t,a);const o=(n.get(i.batchId)||da()).add(t);n=n.insert(i.batchId,o)}))})).next((()=>{const s=[],a=n.getReverseIterator();for(;a.hasNext();){const n=a.getNext(),o=n.key,c=n.value,l=ca();c.forEach((t=>{if(!i.has(t)){const n=Na(e.get(t),r.get(t));null!==n&&l.set(t,n),i=i.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,o,l))}return mi.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,r){return function(t){return oi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Ks(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r)}getNextDocuments(t,e,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,n).next((i=>{const s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,n-i.size):mi.resolve(oa());let a=-1,o=i;return s.next((e=>mi.forEach(e,((e,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(e)?mi.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{o=o.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,o,e,da()))).next((t=>({batchId:a,changes:aa(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new oi(e)).next((t=>{let e=sa();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,r){const n=e.collectionGroup;let i=sa();return this.indexManager.getCollectionParents(t,n).next((s=>mi.forEach(s,(s=>{const a=function(t,e){return new Fs(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(n));return this.getDocumentsMatchingCollectionQuery(t,a,r).next((t=>{t.forEach(((t,e)=>{i=i.insert(t,e)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(t,e,r){let n;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next((i=>(n=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,n)))).next((t=>{n.forEach(((e,r)=>{const n=r.getKey();null===t.get(n)&&(t=t.insert(n,ls.newInvalidDocument(n)))}));let r=sa();return t.forEach(((t,i)=>{const s=n.get(t);void 0!==s&&Fa(s.mutation,i,Li.empty(),ei.now()),Qs(e,i)&&(r=r.insert(t,i))})),r}))}}class oc{constructor(t){this.serializer=t,this.cs=new Map,this.hs=new Map}getBundleMetadata(t,e){return mi.resolve(this.cs.get(e))}saveBundleMetadata(t,e){var r;return this.cs.set(e.id,{id:(r=e).id,version:r.version,createTime:Co(r.createTime)}),mi.resolve()}getNamedQuery(t,e){return mi.resolve(this.hs.get(e))}saveNamedQuery(t,e){return this.hs.set(e.name,function(t){return{name:t.name,query:$o(t.bundledQuery),readTime:Co(t.readTime)}}(e)),mi.resolve()}}class cc{constructor(){this.overlays=new ki(oi.comparator),this.ls=new Map}getOverlay(t,e){return mi.resolve(this.overlays.get(e))}getOverlays(t,e){const r=oa();return mi.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&r.set(e,t)})))).next((()=>r))}saveOverlays(t,e,r){return r.forEach(((r,n)=>{this.we(t,e,n)})),mi.resolve()}removeOverlaysForBatchId(t,e,r){const n=this.ls.get(r);return void 0!==n&&(n.forEach((t=>this.overlays=this.overlays.remove(t))),this.ls.delete(r)),mi.resolve()}getOverlaysForCollection(t,e,r){const n=oa(),i=e.length+1,s=new oi(e.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const t=a.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>r&&n.set(t.getKey(),t)}return mi.resolve(n)}getOverlaysForCollectionGroup(t,e,r,n){let i=new ki(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>r){let e=i.get(t.largestBatchId);null===e&&(e=oa(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const a=oa(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((t,e)=>a.set(t,e))),!(a.size()>=n)););return mi.resolve(a)}we(t,e,r){const n=this.overlays.get(r.key);if(null!==n){const t=this.ls.get(n.largestBatchId).delete(r.key);this.ls.set(n.largestBatchId,t)}this.overlays=this.overlays.insert(r.key,new Za(e,r));let i=this.ls.get(e);void 0===i&&(i=da(),this.ls.set(e,i)),this.ls.set(e,i.add(r.key))}}class lc{constructor(){this.fs=new Di(uc.ds),this.ws=new Di(uc._s)}isEmpty(){return this.fs.isEmpty()}addReference(t,e){const r=new uc(t,e);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.ys(new uc(t,e))}ps(t,e){t.forEach((t=>this.removeReference(t,e)))}Is(t){const e=new oi(new ii([])),r=new uc(e,t),n=new uc(e,t+1),i=[];return this.ws.forEachInRange([r,n],(t=>{this.ys(t),i.push(t.key)})),i}Ts(){this.fs.forEach((t=>this.ys(t)))}ys(t){this.fs=this.fs.delete(t),this.ws=this.ws.delete(t)}Es(t){const e=new oi(new ii([])),r=new uc(e,t),n=new uc(e,t+1);let i=da();return this.ws.forEachInRange([r,n],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new uc(t,0),r=this.fs.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class uc{constructor(t,e){this.key=t,this.As=e}static ds(t,e){return oi.comparator(t.key,e.key)||Jn(t.As,e.As)}static _s(t,e){return Jn(t.As,e.As)||oi.comparator(t.key,e.key)}}class hc{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.vs=1,this.Rs=new Di(uc.ds)}checkEmpty(t){return mi.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,n){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Wa(i,e,r,n);this.mutationQueue.push(s);for(const a of n)this.Rs=this.Rs.add(new uc(a.key,i)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return mi.resolve(s)}lookupMutationBatch(t,e){return mi.resolve(this.Ps(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,n=this.bs(r),i=n<0?0:n;return mi.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return mi.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(t){return mi.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new uc(e,0),n=new uc(e,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,n],(t=>{const e=this.Ps(t.As);i.push(e)})),mi.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new Di(Jn);return e.forEach((t=>{const e=new uc(t,0),n=new uc(t,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([e,n],(t=>{r=r.add(t.As)}))})),mi.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,n=r.length+1;let i=r;oi.isDocumentKey(i)||(i=i.child(""));const s=new uc(new oi(i),0);let a=new Di(Jn);return this.Rs.forEachWhile((t=>{const e=t.key.path;return!!r.isPrefixOf(e)&&(e.length===n&&(a=a.add(t.As)),!0)}),s),mi.resolve(this.Vs(a))}Vs(t){const e=[];return t.forEach((t=>{const r=this.Ps(t);null!==r&&e.push(r)})),e}removeMutationBatch(t,e){Un(0===this.Ss(e.batchId,"removed")),this.mutationQueue.shift();let r=this.Rs;return mi.forEach(e.mutations,(n=>{const i=new uc(n.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,n.key)})).next((()=>{this.Rs=r}))}Cn(t){}containsKey(t,e){const r=new uc(e,0),n=this.Rs.firstAfterOrEqual(r);return mi.resolve(e.isEqual(n&&n.key))}performConsistencyCheck(t){return this.mutationQueue.length,mi.resolve()}Ss(t,e){return this.bs(t)}bs(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Ps(t){const e=this.bs(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class dc{constructor(t){this.Ds=t,this.docs=new ki(oi.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,n=this.docs.get(r),i=n?n.size:0,s=this.Ds(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return mi.resolve(r?r.document.mutableCopy():ls.newInvalidDocument(e))}getEntries(t,e){let r=na();return e.forEach((t=>{const e=this.docs.get(t);r=r.insert(t,e?e.document.mutableCopy():ls.newInvalidDocument(t))})),mi.resolve(r)}getDocumentsMatchingQuery(t,e,r,n){let i=na();const s=e.path,a=new oi(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:t,value:{document:a}}=o.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||di(ui(a),r)<=0||(n.has(a.key)||Qs(e,a))&&(i=i.insert(a.key,a.mutableCopy()))}return mi.resolve(i)}getAllFromCollectionGroup(t,e,r,n){Fn()}Cs(t,e){return mi.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new fc(this)}getSize(t){return mi.resolve(this.size)}}class fc extends ic{constructor(t){super(),this.os=t}applyChanges(t){const e=[];return this.changes.forEach(((r,n)=>{n.isValidDocument()?e.push(this.os.addEntry(t,n)):this.os.removeEntry(r)})),mi.waitFor(e)}getFromCache(t,e){return this.os.getEntry(t,e)}getAllFromCache(t,e){return this.os.getEntries(t,e)}}class pc{constructor(t){this.persistence=t,this.xs=new ea((t=>Ps(t)),Ns),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.Ns=0,this.ks=new lc,this.targetCount=0,this.Ms=nc.kn()}forEachTarget(t,e){return this.xs.forEach(((t,r)=>e(r))),mi.resolve()}getLastRemoteSnapshotVersion(t){return mi.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return mi.resolve(this.Ns)}allocateTargetId(t){return this.highestTargetId=this.Ms.next(),mi.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.Ns&&(this.Ns=e),mi.resolve()}Fn(t){this.xs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ms=new nc(e),this.highestTargetId=e),t.sequenceNumber>this.Ns&&(this.Ns=t.sequenceNumber)}addTargetData(t,e){return this.Fn(e),this.targetCount+=1,mi.resolve()}updateTargetData(t,e){return this.Fn(e),mi.resolve()}removeTargetData(t,e){return this.xs.delete(e.target),this.ks.Is(e.targetId),this.targetCount-=1,mi.resolve()}removeTargets(t,e,r){let n=0;const i=[];return this.xs.forEach(((s,a)=>{a.sequenceNumber<=e&&null===r.get(a.targetId)&&(this.xs.delete(s),i.push(this.removeMatchingKeysForTargetId(t,a.targetId)),n++)})),mi.waitFor(i).next((()=>n))}getTargetCount(t){return mi.resolve(this.targetCount)}getTargetData(t,e){const r=this.xs.get(e)||null;return mi.resolve(r)}addMatchingKeys(t,e,r){return this.ks.gs(e,r),mi.resolve()}removeMatchingKeys(t,e,r){this.ks.ps(e,r);const n=this.persistence.referenceDelegate,i=[];return n&&e.forEach((e=>{i.push(n.markPotentiallyOrphaned(t,e))})),mi.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.ks.Is(e),mi.resolve()}getMatchingKeysForTargetId(t,e){const r=this.ks.Es(e);return mi.resolve(r)}containsKey(t,e){return mi.resolve(this.ks.containsKey(e))}}class gc{constructor(t,e){this.$s={},this.overlays={},this.Os=new yi(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new pc(this),this.indexManager=new tc,this.remoteDocumentCache=function(t){return new dc(t)}((t=>this.referenceDelegate.Ls(t))),this.serializer=new Qo(e),this.qs=new oc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new cc,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.$s[t.toKey()];return r||(r=new hc(e,this.referenceDelegate),this.$s[t.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(t,e,r){Ln("MemoryPersistence","Starting transaction:",t);const n=new mc(this.Os.next());return this.referenceDelegate.Us(),r(n).next((t=>this.referenceDelegate.Ks(n).next((()=>t)))).toPromise().then((t=>(n.raiseOnCommittedEvent(),t)))}Gs(t,e){return mi.or(Object.values(this.$s).map((r=>()=>r.containsKey(t,e))))}}class mc extends pi{constructor(t){super(),this.currentSequenceNumber=t}}class vc{constructor(t){this.persistence=t,this.Qs=new lc,this.js=null}static zs(t){return new vc(t)}get Ws(){if(this.js)return this.js;throw Fn()}addReference(t,e,r){return this.Qs.addReference(r,e),this.Ws.delete(r.toString()),mi.resolve()}removeReference(t,e,r){return this.Qs.removeReference(r,e),this.Ws.add(r.toString()),mi.resolve()}markPotentiallyOrphaned(t,e){return this.Ws.add(e.toString()),mi.resolve()}removeTarget(t,e){this.Qs.Is(e.targetId).forEach((t=>this.Ws.add(t.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ws.add(t.toString())))})).next((()=>r.removeTargetData(t,e)))}Us(){this.js=new Set}Ks(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mi.forEach(this.Ws,(r=>{const n=oi.fromPath(r);return this.Hs(t,n).next((t=>{t||e.removeEntry(n,ri.min())}))})).next((()=>(this.js=null,e.apply(t))))}updateLimboDocument(t,e){return this.Hs(t,e).next((t=>{t?this.Ws.delete(e.toString()):this.Ws.add(e.toString())}))}Ls(t){return 0}Hs(t,e){return mi.or([()=>mi.resolve(this.Qs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gs(t,e)])}}class yc{constructor(t,e,r,n){this.targetId=t,this.fromCache=e,this.Fi=r,this.Bi=n}static Li(t,e){let r=da(),n=da();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:n=n.add(i.doc.key)}return new yc(t,e.fromCache,r,n)}}class bc{constructor(){this.qi=!1}initialize(t,e){this.Ui=t,this.indexManager=e,this.qi=!0}getDocumentsMatchingQuery(t,e,r,n){return this.Ki(t,e).next((i=>i||this.Gi(t,e,n,r))).next((r=>r||this.Qi(t,e)))}Ki(t,e){if(js(e))return mi.resolve(null);let r=zs(e);return this.indexManager.getIndexType(t,r).next((n=>0===n?null:(null!==e.limit&&1===n&&(e=Ws(e,null,"F"),r=zs(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next((n=>{const i=da(...n);return this.Ui.getDocuments(t,i).next((n=>this.indexManager.getMinOffset(t,r).next((r=>{const s=this.ji(e,n);return this.zi(e,s,i,r.readTime)?this.Ki(t,Ws(e,null,"F")):this.Wi(t,s,e,r)}))))})))))}Gi(t,e,r,n){return js(e)||n.isEqual(ri.min())?this.Qi(t,e):this.Ui.getDocuments(t,r).next((i=>{const s=this.ji(e,i);return this.zi(e,s,r,n)?this.Qi(t,e):(xn()<=a.in.DEBUG&&Ln("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Xs(e)),this.Wi(t,s,e,li(n,-1)))}))}ji(t,e){let r=new Di(Js(t));return e.forEach(((e,n)=>{Qs(t,n)&&(r=r.add(n))})),r}zi(t,e,r,n){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}Qi(t,e){return xn()<=a.in.DEBUG&&Ln("QueryEngine","Using full collection scan to execute query:",Xs(e)),this.Ui.getDocumentsMatchingQuery(t,e,hi.min())}Wi(t,e,r,n){return this.Ui.getDocumentsMatchingQuery(t,r,n).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Ec{constructor(t,e,r,n){this.persistence=t,this.Hi=e,this.serializer=n,this.Ji=new ki(Jn),this.Yi=new ea((t=>Ps(t)),Ns),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(r)}tr(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new ac(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ji)))}}function wc(t,e,r,n){return new Ec(t,e,r,n)}async function Tc(t,e){const r=Bn(t);return await r.persistence.runTransaction("Handle user change","readonly",(t=>{let n;return r.mutationQueue.getAllMutationBatches(t).next((i=>(n=i,r.tr(e),r.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],s=[];let a=da();for(const t of n){i.push(t.batchId);for(const e of t.mutations)a=a.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)a=a.add(e.key)}return r.localDocuments.getDocuments(t,a).next((t=>({er:t,removedBatchIds:i,addedBatchIds:s})))}))}))}function Sc(t){const e=Bn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Bs.getLastRemoteSnapshotVersion(t)))}function _c(t,e,r){let n=da(),i=da();return r.forEach((t=>n=n.add(t))),e.getEntries(t,n).next((t=>{let n=na();return r.forEach(((r,s)=>{const a=t.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(ri.min())?(e.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s),n=n.insert(r,s)):Ln("LocalStore","Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)})),{nr:n,sr:i}}))}function Ac(t,e){const r=Bn(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}function Rc(t,e){const r=Bn(t);return r.persistence.runTransaction("Allocate target","readwrite",(t=>{let n;return r.Bs.getTargetData(t,e).next((i=>i?(n=i,mi.resolve(n)):r.Bs.allocateTargetId(t).next((i=>(n=new Xo(e,i,"TargetPurposeListen",t.currentSequenceNumber),r.Bs.addTargetData(t,n).next((()=>n)))))))})).then((t=>{const n=r.Ji.get(t.targetId);return(null===n||t.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.Ji=r.Ji.insert(t.targetId,t),r.Yi.set(e,t.targetId)),t}))}async function Cc(t,e,r){const n=Bn(t),i=n.Ji.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,(t=>n.persistence.referenceDelegate.removeTarget(t,i)))}catch(t){if(!vi(t))throw t;Ln("LocalStore","Failed to update sequence numbers for target ".concat(e,": ").concat(t))}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}function kc(t,e,r){const n=Bn(t);let i=ri.min(),s=da();return n.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,r){const n=Bn(t),i=n.Yi.get(r);return void 0!==i?mi.resolve(n.Ji.get(i)):n.Bs.getTargetData(e,r)}(n,t,zs(e)).next((e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>n.Hi.getDocumentsMatchingQuery(t,e,r?i:ri.min(),r?s:da()))).next((t=>(Oc(n,$s(e),t),{documents:t,ir:s})))))}function Oc(t,e,r){let n=t.Xi.get(e)||ri.min();r.forEach(((t,e)=>{e.readTime.compareTo(n)>0&&(n=e.readTime)})),t.Xi.set(e,n)}class Ic{constructor(){this.activeTargetIds=pa()}lr(t){this.activeTargetIds=this.activeTargetIds.add(t)}dr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}hr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Dc{constructor(){this.Hr=new Ic,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Hr.lr(t),this.Jr[t]||"not-current"}updateQueryState(t,e,r){this.Jr[t]=e}removeLocalQueryTarget(t){this.Hr.dr(t)}isLocalQueryTarget(t){return this.Hr.activeTargetIds.has(t)}clearQueryState(t){delete this.Jr[t]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(t){return this.Hr.activeTargetIds.has(t)}start(){return this.Hr=new Ic,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class xc{Yr(t){}shutdown(){}}class Lc{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(t){this.so.push(t)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ln("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.so)t(0)}no(){Ln("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.so)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Pc=null;function Nc(){return null===Pc?Pc=268435456+Math.round(2147483648*Math.random()):Pc++,"0x"+Pc.toString(16)}const Mc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Fc{constructor(t){this.ro=t.ro,this.oo=t.oo}uo(t){this.co=t}ao(t){this.ho=t}onMessage(t){this.lo=t}close(){this.oo()}send(t){this.ro(t)}fo(){this.co()}wo(t){this.ho(t)}_o(t){this.lo(t)}}const Uc="WebChannelConnection";class Bc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.mo=e+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(t,e,r,n,i){const s=Nc(),a=this.To(t,e);Ln("RestConnection","Sending RPC '".concat(t,"' ").concat(s,":"),a,r);const o={};return this.Eo(o,n,i),this.Ao(t,a,o,r).then((e=>(Ln("RestConnection","Received RPC '".concat(t,"' ").concat(s,": "),e),e)),(e=>{throw Nn("RestConnection","RPC '".concat(t,"' ").concat(s," failed with error: "),e,"url: ",a,"request:",r),e}))}vo(t,e,r,n,i,s){return this.Io(t,e,r,n,i)}Eo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+In,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,r)=>t[r]=e)),r&&r.headers.forEach(((e,r)=>t[r]=e))}To(t,e){const r=Mc[t];return"".concat(this.mo,"/v1/").concat(e,":").concat(r)}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Ao(t,e,r,n){const i=Nc();return new Promise(((s,a)=>{const o=new An;o.setWithCredentials(!0),o.listenOnce(En.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case bn.NO_ERROR:const e=o.getResponseJson();Ln(Uc,"XHR for RPC '".concat(t,"' ").concat(i," received:"),JSON.stringify(e)),s(e);break;case bn.TIMEOUT:Ln(Uc,"RPC '".concat(t,"' ").concat(i," timed out")),a(new Vn(jn.DEADLINE_EXCEEDED,"Request time out"));break;case bn.HTTP_ERROR:const r=o.getStatus();if(Ln(Uc,"RPC '".concat(t,"' ").concat(i," failed with status:"),r,"response text:",o.getResponseText()),r>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(jn).indexOf(e)>=0?e:jn.UNKNOWN}(e.status);a(new Vn(t,e.message))}else a(new Vn(jn.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Vn(jn.UNAVAILABLE,"Connection failed."));break;default:Fn()}}finally{Ln(Uc,"RPC '".concat(t,"' ").concat(i," completed."))}}));const c=JSON.stringify(n);Ln(Uc,"RPC '".concat(t,"' ").concat(i," sending request:"),n),o.send(e,"POST",c,r,15)}))}Ro(t,e,r){const n=Nc(),i=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=vn(),a=yn(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(o.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(o.xmlHttpFactory=new Sn({})),this.Eo(o.initMessageHeaders,e,r),o.encodeInitMessageHeaders=!0;const l=i.join("");Ln(Uc,"Creating RPC '".concat(t,"' stream ").concat(n,": ").concat(l),o);const u=s.createWebChannel(l,o);let h=!1,d=!1;const f=new Fc({ro:e=>{d?Ln(Uc,"Not sending because RPC '".concat(t,"' stream ").concat(n," is closed:"),e):(h||(Ln(Uc,"Opening RPC '".concat(t,"' stream ").concat(n," transport.")),u.open(),h=!0),Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," sending:"),e),u.send(e))},oo:()=>u.close()}),p=(t,e,r)=>{t.listen(e,(t=>{try{r(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,_n.EventType.OPEN,(()=>{d||Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," transport opened."))})),p(u,_n.EventType.CLOSE,(()=>{d||(d=!0,Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," transport closed")),f.wo())})),p(u,_n.EventType.ERROR,(e=>{d||(d=!0,Nn(Uc,"RPC '".concat(t,"' stream ").concat(n," transport errored:"),e),f.wo(new Vn(jn.UNAVAILABLE,"The operation could not be completed")))})),p(u,_n.EventType.MESSAGE,(e=>{var r;if(!d){const i=e.data[0];Un(!!i);const s=i,a=s.error||(null===(r=s[0])||void 0===r?void 0:r.error);if(a){Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," received error:"),a);const e=a.status;let r=function(t){const e=Qa[t];if(void 0!==e)return to(e)}(e),i=a.message;void 0===r&&(r=jn.INTERNAL,i="Unknown error status: "+e+" with message "+a.message),d=!0,f.wo(new Vn(r,i)),u.close()}else Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," received:"),i),f._o(i)}})),p(a,wn.STAT_EVENT,(e=>{e.stat===Tn.PROXY?Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," detected buffering proxy")):e.stat===Tn.NOPROXY&&Ln(Uc,"RPC '".concat(t,"' stream ").concat(n," detected no buffering proxy"))})),setTimeout((()=>{f.fo()}),0),f}}function jc(){return"undefined"!=typeof document?document:null}function Vc(t){return new To(t,!0)}class Gc{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ii=t,this.timerId=e,this.Po=r,this.bo=n,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(t){this.cancel();const e=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),n=Math.max(0,e-r);n>0&&Ln("ExponentialBackoff","Backing off for ".concat(n," ms (base delay: ").concat(this.So," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(r," ms ago)")),this.Do=this.ii.enqueueAfterDelay(this.timerId,n,(()=>(this.Co=Date.now(),t()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Kc{constructor(t,e,r,n,i,s,a,o){this.ii=t,this.$o=r,this.Oo=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Gc(t,e)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(t){this.Ho(),this.stream.send(t)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(t,e){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==t?this.qo.reset():e&&e.code===jn.RESOURCE_EXHAUSTED?(Pn(e.toString()),Pn("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):e&&e.code===jn.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.ao(e)}Yo(){}auth(){this.state=1;const t=this.Xo(this.Fo),e=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((t=>{let[r,n]=t;this.Fo===e&&this.Zo(r,n)}),(e=>{t((()=>{const t=new Vn(jn.UNKNOWN,"Fetching auth token failed: "+e.message);return this.tu(t)}))}))}Zo(t,e){const r=this.Xo(this.Fo);this.stream=this.eu(t,e),this.stream.uo((()=>{r((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((t=>{r((()=>this.tu(t)))})),this.stream.onMessage((t=>{r((()=>this.onMessage(t)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(t){return Ln("PersistentStream","close with error: ".concat(t)),this.stream=null,this.close(4,t)}Xo(t){return e=>{this.ii.enqueueAndForget((()=>this.Fo===t?e():(Ln("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Hc extends Kc{constructor(t,e,r,n,i,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,n,s),this.serializer=i}eu(t,e){return this.connection.Ro("Listen",t,e)}onMessage(t){this.qo.reset();const e=function(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Fn()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(Un(void 0===e||"string"==typeof e),Ni.fromBase64String(e||"")):(Un(void 0===e||e instanceof Uint8Array),Ni.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(t){const e=void 0===t.code?jn.UNKNOWN:to(t.code);return new Vn(e,t.message||"")}(a);r=new po(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Do(t,n.document.name),s=Co(n.document.updateTime),a=n.document.createTime?Co(n.document.createTime):ri.min(),o=new os({mapValue:{fields:n.document.fields}}),c=ls.newFoundDocument(i,s,a,o),l=n.targetIds||[],u=n.removedTargetIds||[];r=new ho(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Do(t,n.document),s=n.readTime?Co(n.readTime):ri.min(),a=ls.newNoDocument(i,s),o=n.removedTargetIds||[];r=new ho([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Do(t,n.document),s=n.removedTargetIds||[];r=new ho([],s,i,null)}else{if(!("filter"in e))return Fn();{e.filter;const t=e.filter;t.targetId;const{count:n=0,unchangedNames:i}=t,s=new Xa(n,i),a=t.targetId;r=new fo(a,s)}}return r}(this.serializer,t),r=function(t){if(!("targetChange"in t))return ri.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?ri.min():e.readTime?Co(e.readTime):ri.min()}(t);return this.listener.nu(e,r)}su(t){const e={};e.database=Po(this.serializer),e.addTarget=function(t,e){let r;const n=e.target;if(r=Ms(n)?{documents:Uo(t,n)}:{query:Bo(t,n)},r.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){r.resumeToken=Ao(t,e.resumeToken);const n=So(t,e.expectedCount);null!==n&&(r.expectedCount=n)}else if(e.snapshotVersion.compareTo(ri.min())>0){r.readTime=_o(t,e.snapshotVersion.toTimestamp());const n=So(t,e.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,t);const r=function(t,e){const r=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fn()}}(e.purpose);return null==r?null:{"goog-listen-tags":r}}(this.serializer,t);r&&(e.labels=r),this.Wo(e)}iu(t){const e={};e.database=Po(this.serializer),e.removeTarget=t,this.Wo(e)}}class zc extends Kc{constructor(t,e,r,n,i,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,n,s),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(t,e){return this.connection.Ro("Write",t,e)}onMessage(t){if(Un(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.qo.reset();const e=function(t,e){return t&&t.length>0?(Un(void 0!==e),t.map((t=>function(t,e){let r=t.updateTime?Co(t.updateTime):Co(e);return r.isEqual(ri.min())&&(r=Co(e)),new Da(r,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),r=Co(t.commitTime);return this.listener.cu(r,e)}return Un(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.au()}hu(){const t={};t.database=Po(this.serializer),this.Wo(t)}uu(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>Fo(this.serializer,t)))};this.Wo(e)}}class qc extends class{}{constructor(t,e,r,n){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=n,this.lu=!1}fu(){if(this.lu)throw new Vn(jn.FAILED_PRECONDITION,"The client has already been terminated.")}Io(t,e,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((n=>{let[i,s]=n;return this.connection.Io(t,e,r,i,s)})).catch((t=>{throw"FirebaseError"===t.name?(t.code===jn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Vn(jn.UNKNOWN,t.toString())}))}vo(t,e,r,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,a]=i;return this.connection.vo(t,e,r,s,a,n)})).catch((t=>{throw"FirebaseError"===t.name?(t.code===jn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Vn(jn.UNKNOWN,t.toString())}))}terminate(){this.lu=!0}}class Wc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(t){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.yu("Offline")))}set(t){this.Tu(),this.wu=0,"Online"===t&&(this.mu=!1),this.yu(t)}yu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}pu(t){const e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.mu?(Pn(e),this.mu=!1):Ln("OnlineStateTracker",e)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class Yc{constructor(t,e,r,n,i){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr((t=>{r.enqueueAndForget((async()=>{nl(this)&&(Ln("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Bn(t);e.vu.add(4),await Xc(e),e.bu.set("Unknown"),e.vu.delete(4),await Zc(e)}(this))}))})),this.bu=new Wc(r,n)}}async function Zc(t){if(nl(t))for(const e of t.Ru)await e(!0)}async function Xc(t){for(const e of t.Ru)await e(!1)}function Qc(t,e){const r=Bn(t);r.Au.has(e.targetId)||(r.Au.set(e.targetId,e),rl(r)?el(r):wl(r).Ko()&&Jc(r,e))}function $c(t,e){const r=Bn(t),n=wl(r);r.Au.delete(e),n.Ko()&&tl(r,e),0===r.Au.size&&(n.Ko()?n.jo():nl(r)&&r.bu.set("Unknown"))}function Jc(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ri.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}wl(t).su(e)}function tl(t,e){t.Vu.qt(e),wl(t).iu(e)}function el(t){t.Vu=new mo({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),wl(t).start(),t.bu.gu()}function rl(t){return nl(t)&&!wl(t).Uo()&&t.Au.size>0}function nl(t){return 0===Bn(t).vu.size}function il(t){t.Vu=void 0}async function sl(t){t.Au.forEach(((e,r)=>{Jc(t,e)}))}async function al(t,e){il(t),rl(t)?(t.bu.Iu(e),el(t)):t.bu.set("Unknown")}async function ol(t,e,r){if(t.bu.set("Online"),e instanceof po&&2===e.state&&e.cause)try{await async function(t,e){const r=e.cause;for(const n of e.targetIds)t.Au.has(n)&&(await t.remoteSyncer.rejectListen(n,r),t.Au.delete(n),t.Vu.removeTarget(n))}(t,e)}catch(r){Ln("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await cl(t,r)}else if(e instanceof ho?t.Vu.Ht(e):e instanceof fo?t.Vu.ne(e):t.Vu.Xt(e),!r.isEqual(ri.min()))try{const e=await Sc(t.localStore);r.compareTo(e)>=0&&await function(t,e){const r=t.Vu.ce(e);return r.targetChanges.forEach(((r,n)=>{if(r.resumeToken.approximateByteSize()>0){const i=t.Au.get(n);i&&t.Au.set(n,i.withResumeToken(r.resumeToken,e))}})),r.targetMismatches.forEach(((e,r)=>{const n=t.Au.get(e);if(!n)return;t.Au.set(e,n.withResumeToken(Ni.EMPTY_BYTE_STRING,n.snapshotVersion)),tl(t,e);const i=new Xo(n.target,e,r,n.sequenceNumber);Jc(t,i)})),t.remoteSyncer.applyRemoteEvent(r)}(t,r)}catch(e){Ln("RemoteStore","Failed to raise snapshot:",e),await cl(t,e)}}async function cl(t,e,r){if(!vi(e))throw e;t.vu.add(1),await Xc(t),t.bu.set("Offline"),r||(r=()=>Sc(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ln("RemoteStore","Retrying IndexedDB access"),await r(),t.vu.delete(1),await Zc(t)}))}function ll(t,e){return e().catch((r=>cl(t,r,e)))}async function ul(t){const e=Bn(t),r=Tl(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;hl(e);)try{const t=await Ac(e.localStore,n);if(null===t){0===e.Eu.length&&r.jo();break}n=t.batchId,dl(e,t)}catch(t){await cl(e,t)}fl(e)&&pl(e)}function hl(t){return nl(t)&&t.Eu.length<10}function dl(t,e){t.Eu.push(e);const r=Tl(t);r.Ko()&&r.ou&&r.uu(e.mutations)}function fl(t){return nl(t)&&!Tl(t).Uo()&&t.Eu.length>0}function pl(t){Tl(t).start()}async function gl(t){Tl(t).hu()}async function ml(t){const e=Tl(t);for(const r of t.Eu)e.uu(r.mutations)}async function vl(t,e,r){const n=t.Eu.shift(),i=Ya.from(n,e,r);await ll(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await ul(t)}async function yl(t,e){e&&Tl(t).ou&&await async function(t,e){if(Ja(r=e.code)&&r!==jn.ABORTED){const r=t.Eu.shift();Tl(t).Qo(),await ll(t,(()=>t.remoteSyncer.rejectFailedWrite(r.batchId,e))),await ul(t)}var r}(t,e),fl(t)&&pl(t)}async function bl(t,e){const r=Bn(t);r.asyncQueue.verifyOperationInProgress(),Ln("RemoteStore","RemoteStore received new credentials");const n=nl(r);r.vu.add(3),await Xc(r),n&&r.bu.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.vu.delete(3),await Zc(r)}async function El(t,e){const r=Bn(t);e?(r.vu.delete(2),await Zc(r)):e||(r.vu.add(2),await Xc(r),r.bu.set("Unknown"))}function wl(t){return t.Su||(t.Su=function(t,e,r){const n=Bn(t);return n.fu(),new Hc(e,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(t.datastore,t.asyncQueue,{uo:sl.bind(null,t),ao:al.bind(null,t),nu:ol.bind(null,t)}),t.Ru.push((async e=>{e?(t.Su.Qo(),rl(t)?el(t):t.bu.set("Unknown")):(await t.Su.stop(),il(t))}))),t.Su}function Tl(t){return t.Du||(t.Du=function(t,e,r){const n=Bn(t);return n.fu(),new zc(e,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(t.datastore,t.asyncQueue,{uo:gl.bind(null,t),ao:yl.bind(null,t),au:ml.bind(null,t),cu:vl.bind(null,t)}),t.Ru.push((async e=>{e?(t.Du.Qo(),await ul(t)):(await t.Du.stop(),t.Eu.length>0&&(Ln("RemoteStore","Stopping write stream with ".concat(t.Eu.length," pending writes")),t.Eu=[]))}))),t.Du}class Sl{constructor(t,e,r,n,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new Gn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,r,n,i){const s=Date.now()+r,a=new Sl(t,e,s,n,i);return a.start(r),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Vn(jn.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _l(t,e){if(Pn("AsyncQueue","".concat(e,": ").concat(t)),vi(t))return new Vn(jn.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}class Al{constructor(t){this.comparator=t?(e,r)=>t(e,r)||oi.comparator(e.key,r.key):(t,e)=>oi.comparator(t.key,e.key),this.keyedMap=sa(),this.sortedSet=new ki(this.comparator)}static emptySet(t){return new Al(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,r)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Al))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,n=r.getNext().key;if(!t.isEqual(n))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new Al;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class Rl{constructor(){this.Cu=new ki(oi.comparator)}track(t){const e=t.doc.key,r=this.Cu.get(e);r?0!==t.type&&3===r.type?this.Cu=this.Cu.insert(e,t):3===t.type&&1!==r.type?this.Cu=this.Cu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Cu=this.Cu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Cu=this.Cu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Cu=this.Cu.remove(e):1===t.type&&2===r.type?this.Cu=this.Cu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Cu=this.Cu.insert(e,{type:2,doc:t.doc}):Fn():this.Cu=this.Cu.insert(e,t)}xu(){const t=[];return this.Cu.inorderTraversal(((e,r)=>{t.push(r)})),t}}class Cl{constructor(t,e,r,n,i,s,a,o,c){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=c}static fromInitialDocuments(t,e,r,n,i){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new Cl(t,e,Al.emptySet(e),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ys(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(e[n].type!==r[n].type||!e[n].doc.isEqual(r[n].doc))return!1;return!0}}class kl{constructor(){this.Nu=void 0,this.listeners=[]}}class Ol{constructor(){this.queries=new ea((t=>Zs(t)),Ys),this.onlineState="Unknown",this.ku=new Set}}async function Il(t,e){const r=Bn(t),n=e.query;let i=!1,s=r.queries.get(n);if(s||(i=!0,s=new kl),i)try{s.Nu=await r.onListen(n)}catch(t){const r=_l(t,"Initialization of query '".concat(Xs(e.query),"' failed"));return void e.onError(r)}r.queries.set(n,s),s.listeners.push(e),e.Mu(r.onlineState),s.Nu&&e.$u(s.Nu)&&Pl(r)}async function Dl(t,e){const r=Bn(t),n=e.query;let i=!1;const s=r.queries.get(n);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),i=0===s.listeners.length)}if(i)return r.queries.delete(n),r.onUnlisten(n)}function xl(t,e){const r=Bn(t);let n=!1;for(const i of e){const t=i.query,e=r.queries.get(t);if(e){for(const t of e.listeners)t.$u(i)&&(n=!0);e.Nu=i}}n&&Pl(r)}function Ll(t,e,r){const n=Bn(t),i=n.queries.get(e);if(i)for(const s of i.listeners)s.onError(r);n.queries.delete(e)}function Pl(t){t.ku.forEach((t=>{t.next()}))}class Nl{constructor(t,e,r){this.query=t,this.Ou=e,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(t){if(!this.options.includeMetadataChanges){const e=[];for(const r of t.docChanges)3!==r.type&&e.push(r);t=new Cl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Fu?this.Lu(t)&&(this.Ou.next(t),e=!0):this.qu(t,this.onlineState)&&(this.Uu(t),e=!0),this.Bu=t,e}onError(t){this.Ou.error(t)}Mu(t){this.onlineState=t;let e=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,t)&&(this.Uu(this.Bu),e=!0),e}qu(t,e){if(!t.fromCache)return!0;const r="Offline"!==e;return(!this.options.Ku||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Lu(t){if(t.docChanges.length>0)return!0;const e=this.Bu&&this.Bu.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Uu(t){t=Cl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Fu=!0,this.Ou.next(t)}}class Ml{constructor(t){this.key=t}}class Fl{constructor(t){this.key=t}}class Ul{constructor(t,e){this.query=t,this.Yu=e,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=da(),this.mutatedKeys=da(),this.tc=Js(t),this.ec=new Al(this.tc)}get nc(){return this.Yu}sc(t,e){const r=e?e.ic:new Rl,n=e?e.ec:this.ec;let i=e?e.mutatedKeys:this.mutatedKeys,s=n,a=!1;const o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,c="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(t.inorderTraversal(((t,e)=>{const l=n.get(t),u=Qs(this.query,e)?e:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(r.track({type:3,doc:u}),f=!0):this.rc(l,u)||(r.track({type:2,doc:u}),f=!0,(o&&this.tc(u,o)>0||c&&this.tc(u,c)<0)&&(a=!0)):!l&&u?(r.track({type:0,doc:u}),f=!0):l&&!u&&(r.track({type:1,doc:l}),f=!0,(o||c)&&(a=!0)),f&&(u?(s=s.add(u),i=d?i.add(t):i.delete(t)):(s=s.delete(t),i=i.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),i=i.delete(t.key),r.track({type:1,doc:t})}return{ec:s,ic:r,zi:a,mutatedKeys:i}}rc(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const n=this.ec;this.ec=t.ec,this.mutatedKeys=t.mutatedKeys;const i=t.ic.xu();i.sort(((t,e)=>function(t,e){const r=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fn()}};return r(t)-r(e)}(t.type,e.type)||this.tc(t.doc,e.doc))),this.oc(r);const s=e?this.uc():[],a=0===this.Zu.size&&this.current?1:0,o=a!==this.Xu;return this.Xu=a,0!==i.length||o?{snapshot:new Cl(this.query,t.ec,n,i,t.mutatedKeys,0===a,o,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Rl,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(t){return!this.Yu.has(t)&&!!this.ec.has(t)&&!this.ec.get(t).hasLocalMutations}oc(t){t&&(t.addedDocuments.forEach((t=>this.Yu=this.Yu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Yu=this.Yu.delete(t))),this.current=t.current)}uc(){if(!this.current)return[];const t=this.Zu;this.Zu=da(),this.ec.forEach((t=>{this.ac(t.key)&&(this.Zu=this.Zu.add(t.key))}));const e=[];return t.forEach((t=>{this.Zu.has(t)||e.push(new Fl(t))})),this.Zu.forEach((r=>{t.has(r)||e.push(new Ml(r))})),e}hc(t){this.Yu=t.ir,this.Zu=da();const e=this.sc(t.documents);return this.applyChanges(e,!0)}lc(){return Cl.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Bl{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class jl{constructor(t){this.key=t,this.fc=!1}}class Vl{constructor(t,e,r,n,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new ea((t=>Zs(t)),Ys),this._c=new Map,this.mc=new Set,this.gc=new ki(oi.comparator),this.yc=new Map,this.Ic=new lc,this.Tc={},this.Ec=new Map,this.Ac=nc.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Gl(t,e){const r=au(t);let n,i;const s=r.wc.get(e);if(s)n=s.targetId,r.sharedClientState.addLocalQueryTarget(n),i=s.view.lc();else{const t=await Rc(r.localStore,zs(e)),s=r.sharedClientState.addLocalQueryTarget(t.targetId);n=t.targetId,i=await Kl(r,e,n,"current"===s,t.resumeToken),r.isPrimaryClient&&Qc(r.remoteStore,t)}return i}async function Kl(t,e,r,n,i){t.Rc=(e,r,n)=>async function(t,e,r,n){let i=e.view.sc(r);i.zi&&(i=await kc(t.localStore,e.query,!1).then((t=>{let{documents:r}=t;return e.view.sc(r,i)})));const s=n&&n.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,s);return tu(t,e.targetId,a.cc),a.snapshot}(t,e,r,n);const s=await kc(t.localStore,e,!0),a=new Ul(e,s.ir),o=a.sc(s.documents),c=uo.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==t.onlineState,i),l=a.applyChanges(o,t.isPrimaryClient,c);tu(t,r,l.cc);const u=new Bl(e,r,a);return t.wc.set(e,u),t._c.has(r)?t._c.get(r).push(e):t._c.set(r,[e]),l.snapshot}async function Hl(t,e){const r=Bn(t),n=r.wc.get(e),i=r._c.get(n.targetId);if(i.length>1)return r._c.set(n.targetId,i.filter((t=>!Ys(t,e)))),void r.wc.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(n.targetId),r.sharedClientState.isActiveQueryTarget(n.targetId)||await Cc(r.localStore,n.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(n.targetId),$c(r.remoteStore,n.targetId),$l(r,n.targetId)})).catch(gi)):($l(r,n.targetId),await Cc(r.localStore,n.targetId,!0))}async function zl(t,e){const r=Bn(t);try{const t=await function(t,e){const r=Bn(t),n=e.snapshotVersion;let i=r.Ji;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=r.Zi.newChangeBuffer({trackRemovals:!0});i=r.Ji;const a=[];e.targetChanges.forEach(((s,o)=>{const c=i.get(o);if(!c)return;a.push(r.Bs.removeMatchingKeys(t,s.removedDocuments,o).next((()=>r.Bs.addMatchingKeys(t,s.addedDocuments,o))));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(o)?l=l.withResumeToken(Ni.EMPTY_BYTE_STRING,ri.min()).withLastLimboFreeSnapshotVersion(ri.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,n)),i=i.insert(o,l),function(t,e,r){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0}(c,l,s)&&a.push(r.Bs.updateTargetData(t,l))}));let o=na(),c=da();if(e.documentUpdates.forEach((n=>{e.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(t,n))})),a.push(_c(t,s,e.documentUpdates).next((t=>{o=t.nr,c=t.sr}))),!n.isEqual(ri.min())){const e=r.Bs.getLastRemoteSnapshotVersion(t).next((e=>r.Bs.setTargetsMetadata(t,t.currentSequenceNumber,n)));a.push(e)}return mi.waitFor(a).next((()=>s.apply(t))).next((()=>r.localDocuments.getLocalViewOfDocuments(t,o,c))).next((()=>o))})).then((t=>(r.Ji=i,t)))}(r.localStore,e);e.targetChanges.forEach(((t,e)=>{const n=r.yc.get(e);n&&(Un(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?n.fc=!0:t.modifiedDocuments.size>0?Un(n.fc):t.removedDocuments.size>0&&(Un(n.fc),n.fc=!1))})),await nu(r,t,e)}catch(t){await gi(t)}}function ql(t,e,r){const n=Bn(t);if(n.isPrimaryClient&&0===r||!n.isPrimaryClient&&1===r){const t=[];n.wc.forEach(((r,n)=>{const i=n.view.Mu(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const r=Bn(t);r.onlineState=e;let n=!1;r.queries.forEach(((t,r)=>{for(const i of r.listeners)i.Mu(e)&&(n=!0)})),n&&Pl(r)}(n.eventManager,e),t.length&&n.dc.nu(t),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Wl(t,e,r){const n=Bn(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.yc.get(e),s=i&&i.key;if(s){let t=new ki(oi.comparator);t=t.insert(s,ls.newNoDocument(s,ri.min()));const r=da().add(s),i=new lo(ri.min(),new Map,new ki(Jn),t,r);await zl(n,i),n.gc=n.gc.remove(s),n.yc.delete(e),ru(n)}else await Cc(n.localStore,e,!1).then((()=>$l(n,e,r))).catch(gi)}async function Yl(t,e){const r=Bn(t),n=e.batch.batchId;try{const t=await function(t,e){const r=Bn(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const n=e.batch.keys(),i=r.Zi.newChangeBuffer({trackRemovals:!0});return function(t,e,r,n){const i=r.batch,s=i.keys();let a=mi.resolve();return s.forEach((t=>{a=a.next((()=>n.getEntry(e,t))).next((e=>{const s=r.docVersions.get(t);Un(null!==s),e.version.compareTo(s)<0&&(i.applyToRemoteDocument(e,r),e.isValidDocument()&&(e.setReadTime(r.commitVersion),n.addEntry(e)))}))})),a.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(r,t,e,i).next((()=>i.apply(t))).next((()=>r.mutationQueue.performConsistencyCheck(t))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(t,n,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=da();for(let r=0;r<t.mutationResults.length;++r)t.mutationResults[r].transformResults.length>0&&(e=e.add(t.batch.mutations[r].key));return e}(e)))).next((()=>r.localDocuments.getDocuments(t,n)))}))}(r.localStore,e);Ql(r,n,null),Xl(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await nu(r,t)}catch(t){await gi(t)}}async function Zl(t,e,r){const n=Bn(t);try{const t=await function(t,e){const r=Bn(t);return r.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let n;return r.mutationQueue.lookupMutationBatch(t,e).next((e=>(Un(null!==e),n=e.keys(),r.mutationQueue.removeMutationBatch(t,e)))).next((()=>r.mutationQueue.performConsistencyCheck(t))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(t,n,e))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,n))).next((()=>r.localDocuments.getDocuments(t,n)))}))}(n.localStore,e);Ql(n,e,r),Xl(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await nu(n,t)}catch(r){await gi(r)}}function Xl(t,e){(t.Ec.get(e)||[]).forEach((t=>{t.resolve()})),t.Ec.delete(e)}function Ql(t,e,r){const n=Bn(t);let i=n.Tc[n.currentUser.toKey()];if(i){const t=i.get(e);t&&(r?t.reject(r):t.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function $l(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);for(const n of t._c.get(e))t.wc.delete(n),r&&t.dc.Pc(n,r);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach((e=>{t.Ic.containsKey(e)||Jl(t,e)}))}function Jl(t,e){t.mc.delete(e.path.canonicalString());const r=t.gc.get(e);null!==r&&($c(t.remoteStore,r),t.gc=t.gc.remove(e),t.yc.delete(r),ru(t))}function tu(t,e,r){for(const n of r)n instanceof Ml?(t.Ic.addReference(n.key,e),eu(t,n)):n instanceof Fl?(Ln("SyncEngine","Document no longer in limbo: "+n.key),t.Ic.removeReference(n.key,e),t.Ic.containsKey(n.key)||Jl(t,n.key)):Fn()}function eu(t,e){const r=e.key,n=r.path.canonicalString();t.gc.get(r)||t.mc.has(n)||(Ln("SyncEngine","New document in limbo: "+r),t.mc.add(n),ru(t))}function ru(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const r=new oi(ii.fromString(e)),n=t.Ac.next();t.yc.set(n,new jl(r)),t.gc=t.gc.insert(r,n),Qc(t.remoteStore,new Xo(zs(Bs(r.path)),n,"TargetPurposeLimboResolution",yi.ct))}}async function nu(t,e,r){const n=Bn(t),i=[],s=[],a=[];n.wc.isEmpty()||(n.wc.forEach(((t,o)=>{a.push(n.Rc(o,e,r).then((t=>{if((t||r)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(o.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=yc.Li(o.targetId,t);s.push(e)}})))})),await Promise.all(a),n.dc.nu(i),await async function(t,e){const r=Bn(t);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>mi.forEach(e,(e=>mi.forEach(e.Fi,(n=>r.persistence.referenceDelegate.addReference(t,e.targetId,n))).next((()=>mi.forEach(e.Bi,(n=>r.persistence.referenceDelegate.removeReference(t,e.targetId,n)))))))))}catch(t){if(!vi(t))throw t;Ln("LocalStore","Failed to update sequence numbers: "+t)}for(const n of e){const t=n.targetId;if(!n.fromCache){const e=r.Ji.get(t),n=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(n);r.Ji=r.Ji.insert(t,i)}}}(n.localStore,s))}async function iu(t,e){const r=Bn(t);if(!r.currentUser.isEqual(e)){Ln("SyncEngine","User change. New user:",e.toKey());const t=await Tc(r.localStore,e);r.currentUser=e,function(t,e){t.Ec.forEach((t=>{t.forEach((t=>{t.reject(new Vn(jn.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ec.clear()}(r),r.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await nu(r,t.er)}}function su(t,e){const r=Bn(t),n=r.yc.get(e);if(n&&n.fc)return da().add(n.key);{let t=da();const n=r._c.get(e);if(!n)return t;for(const e of n){const n=r.wc.get(e);t=t.unionWith(n.view.nc)}return t}}function au(t){const e=Bn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=su.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wl.bind(null,e),e.dc.nu=xl.bind(null,e.eventManager),e.dc.Pc=Ll.bind(null,e.eventManager),e}function ou(t){const e=Bn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Yl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Zl.bind(null,e),e}class cu{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Vc(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return wc(this.persistence,new bc,t.initialUser,this.serializer)}createPersistence(t){return new gc(vc.zs,this.serializer)}createSharedClientState(t){return new Dc}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class lu{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>ql(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=iu.bind(null,this.syncEngine),await El(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Ol}createDatastore(t){const e=Vc(t.databaseInfo.databaseId),r=(n=t.databaseInfo,new Bc(n));var n;return function(t,e,r,n){return new qc(t,e,r,n)}(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,n=t.asyncQueue,i=t=>ql(this.syncEngine,t,0),s=Lc.D()?new Lc:new xc,new Yc(e,r,n,i,s);var e,r,n,i,s}createSyncEngine(t,e){return function(t,e,r,n,i,s,a){const o=new Vl(t,e,r,n,i,s);return a&&(o.vc=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Bn(t);Ln("RemoteStore","RemoteStore shutting down."),e.vu.add(5),await Xc(e),e.Pu.shutdown(),e.bu.set("Unknown")}(this.remoteStore)}}class uu{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Sc(this.observer.next,t)}error(t){this.observer.error?this.Sc(this.observer.error,t):Pn("Uncaught Error in snapshot listener:",t.toString())}Dc(){this.muted=!0}Sc(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class hu{constructor(t,e,r,n){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=n,this.user=On.UNAUTHENTICATED,this.clientId=$n.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,(async t=>{Ln("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(r,(t=>(Ln("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Vn(jn.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Gn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=_l(e,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}async function du(t,e){t.asyncQueue.verifyOperationInProgress(),Ln("FirestoreClient","Initializing OfflineComponentProvider");const r=await t.getConfiguration();await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async t=>{n.isEqual(t)||(await Tc(e.localStore,t),n=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function fu(t,e){t.asyncQueue.verifyOperationInProgress();const r=await gu(t);Ln("FirestoreClient","Initializing OnlineComponentProvider");const n=await t.getConfiguration();await e.initialize(r,n),t.setCredentialChangeListener((t=>bl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,r)=>bl(e.remoteStore,r))),t._onlineComponents=e}function pu(t){return"FirebaseError"===t.name?t.code===jn.FAILED_PRECONDITION||t.code===jn.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}async function gu(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ln("FirestoreClient","Using user provided OfflineComponentProvider");try{await du(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!pu(r))throw r;Nn("Error using user provided cache. Falling back to memory cache: "+r),await du(t,new cu)}}else Ln("FirestoreClient","Using default OfflineComponentProvider"),await du(t,new cu);return t._offlineComponents}async function mu(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ln("FirestoreClient","Using user provided OnlineComponentProvider"),await fu(t,t._uninitializedComponentsProvider._online)):(Ln("FirestoreClient","Using default OnlineComponentProvider"),await fu(t,new lu))),t._onlineComponents}function vu(t){return mu(t).then((t=>t.syncEngine))}async function yu(t){const e=await mu(t),r=e.eventManager;return r.onListen=Gl.bind(null,e.syncEngine),r.onUnlisten=Hl.bind(null,e.syncEngine),r}function bu(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new Gn;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,r,n,i){const s=new uu({next:s=>{e.enqueueAndForget((()=>Dl(t,a)));const o=s.docs.has(r);!o&&s.fromCache?i.reject(new Vn(jn.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&s.fromCache&&n&&"server"===n.source?i.reject(new Vn(jn.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:t=>i.reject(t)}),a=new Nl(Bs(r.path),s,{includeMetadataChanges:!0,Ku:!0});return Il(t,a)}(await yu(t),t.asyncQueue,e,r,n))),n.promise}function Eu(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const wu=new Map;function Tu(t,e,r){if(!r)throw new Vn(jn.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function Su(t){if(!oi.isDocumentKey(t))throw new Vn(jn.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function _u(t){if(oi.isDocumentKey(t))throw new Vn(jn.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function Au(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}}return"function"==typeof t?"a function":Fn()}function Ru(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Vn(jn.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Au(t);throw new Vn(jn.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(r))}}return t}function Cu(t,e){if(e<=0)throw new Vn(jn.INVALID_ARGUMENT,"Function ".concat(t,"() requires a positive number, but it was: ").concat(e,"."))}class ku{constructor(t){var e,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Vn(jn.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Vn(jn.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,r,n){if(!0===e&&!0===n)throw new Vn(jn.INVALID_ARGUMENT,"".concat(t," and ").concat(r," cannot be used together."))})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Eu(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Vn(jn.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new Vn(jn.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new Vn(jn.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(e=this.experimentalLongPollingOptions,r=t.experimentalLongPollingOptions,e.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams;var e,r}}class Ou{constructor(t,e,r,n){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ku({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Vn(jn.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Vn(jn.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ku(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Hn;switch(t.type){case"firstParty":return new Yn(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Vn(jn.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=wu.get(t);e&&(Ln("ComponentProvider","Removing Datastore"),wu.delete(t),e.terminate())}(this),Promise.resolve()}}class Iu{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Iu(this.firestore,t,this._key)}}class Du{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Du(this.firestore,t,this._query)}}class xu extends Du{constructor(t,e,r){super(t,e,Bs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Iu(this.firestore,null,new oi(t))}withConverter(t){return new xu(this.firestore,t,this._path)}}function Lu(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(t=(0,o.m9)(t),Tu("collection","path",e),t instanceof Ou){const r=ii.fromString(e,...n);return _u(r),new xu(t,null,r)}{if(!(t instanceof Iu||t instanceof xu))throw new Vn(jn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ii.fromString(e,...n));return _u(r),new xu(t.firestore,null,r)}}function Pu(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(t=(0,o.m9)(t),1===arguments.length&&(e=$n.A()),Tu("doc","path",e),t instanceof Ou){const r=ii.fromString(e,...n);return Su(r),new Iu(t,null,new oi(r))}{if(!(t instanceof Iu||t instanceof xu))throw new Vn(jn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ii.fromString(e,...n));return Su(r),new Iu(t.firestore,t instanceof xu?t.converter:null,new oi(r))}}class Nu{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Gc(this,"async_queue_retry"),this.Xc=()=>{const t=jc();t&&Ln("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const t=jc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Zc(),this.ta(t)}enterRestrictedMode(t){if(!this.jc){this.jc=!0,this.Jc=t||!1;const e=jc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Xc)}}enqueue(t){if(this.Zc(),this.jc)return new Promise((()=>{}));const e=new Gn;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Qc.push(t),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(t){if(!vi(t))throw t;Ln("AsyncQueue","Operation failed with retryable error: "+t)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(t){const e=this.Gc.then((()=>(this.Hc=!0,t().catch((t=>{this.Wc=t,this.Hc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Pn("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Hc=!1,t))))));return this.Gc=e,e}enqueueAfterDelay(t,e,r){this.Zc(),this.Yc.indexOf(t)>-1&&(e=0);const n=Sl.createAndSchedule(this,t,e,r,(t=>this.na(t)));return this.zc.push(n),n}Zc(){this.Wc&&Fn()}verifyOperationInProgress(){}async sa(){let t;do{t=this.Gc,await t}while(t!==this.Gc)}ia(t){for(const e of this.zc)if(e.timerId===t)return!0;return!1}ra(t){return this.sa().then((()=>{this.zc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.zc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.sa()}))}oa(t){this.Yc.push(t)}na(t){const e=this.zc.indexOf(t);this.zc.splice(e,1)}}function Mu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const n of["next","error","complete"])if(n in r&&"function"==typeof r[n])return!0;return!1}(t)}class Fu extends Ou{constructor(t,e,r,n){super(t,e,r,n),this.type="firestore",this._queue=new Nu,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ju(this),this._firestoreClient.terminate()}}function Uu(t,e){const r="object"==typeof t?t:(0,i.Mq)(),n="string"==typeof t?t:e||"(default)",s=(0,i.qX)(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const t=(0,o.P0)("firestore");t&&function(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(t=Ru(t,Ou))._getSettings(),a="".concat(e,":").concat(r);if("firestore.googleapis.com"!==s.host&&s.host!==a&&Nn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let e,r;if("string"==typeof n.mockUserToken)e=n.mockUserToken,r=On.MOCK_USER;else{e=(0,o.Sg)(n.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const s=n.mockUserToken.sub||n.mockUserToken.user_id;if(!s)throw new Vn(jn.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new On(s)}t._authCredentials=new zn(new Kn(e,r))}}(s,...t)}return s}function Bu(t){return t._firestoreClient||ju(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function ju(t){var e,r,n;const i=t._freezeSettings(),s=function(t,e,r,n){return new Ki(t,e,r,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,Eu(n.experimentalLongPollingOptions),n.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new hu(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(r=i.cache)||void 0===r?void 0:r._offlineComponentProvider)&&(null===(n=i.cache)||void 0===n?void 0:n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class Vu{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Vu(Ni.fromBase64String(t))}catch(t){throw new Vn(jn.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Vu(Ni.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Gu{constructor(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(let n=0;n<e.length;++n)if(0===e[n].length)throw new Vn(jn.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ai(e)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ku{constructor(t){this._methodName=t}}class Hu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Vn(jn.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Vn(jn.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Jn(this._lat,t._lat)||Jn(this._long,t._long)}}const zu=/^__.*__$/;class qu{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new Va(t,this.data,this.fieldMask,e,this.fieldTransforms):new ja(t,this.data,e,this.fieldTransforms)}}class Wu{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Va(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Yu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fn()}}class Zu{constructor(t,e,r,n,i,s){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(t){return new Zu(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),n=this.aa({path:r,la:!1});return n.fa(t),n}da(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),n=this.aa({path:r,la:!1});return n.ua(),n}wa(t){return this.aa({path:void 0,la:!0})}_a(t){return fh(t,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}ua(){if(this.path)for(let t=0;t<this.path.length;t++)this.fa(this.path.get(t))}fa(t){if(0===t.length)throw this._a("Document fields must not be empty");if(Yu(this.ca)&&zu.test(t))throw this._a('Document fields cannot begin and end with "__"')}}class Xu{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||Vc(t)}ya(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Zu({ca:t,methodName:e,ga:r,path:ai.emptyPath(),la:!1,ma:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qu(t){const e=t._freezeSettings(),r=Vc(t._databaseId);return new Xu(t._databaseId,!!e.ignoreUndefinedProperties,r)}function $u(t,e,r,n,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=t.ya(s.merge||s.mergeFields?2:0,e,r,i);lh("Data must be an object, but it was:",a,n);const o=oh(n,a);let c,l;if(s.merge)c=new Li(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){const t=[];for(const n of s.mergeFields){const i=uh(e,n,r);if(!a.contains(i))throw new Vn(jn.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));ph(t,i)||t.push(i)}c=new Li(t),l=a.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=a.fieldTransforms;return new qu(new os(o),c,l)}class Ju extends Ku{_toFieldTransform(t){if(2!==t.ca)throw 1===t.ca?t._a("".concat(this._methodName,"() can only appear at the top level of your update data")):t._a("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ju}}function th(t,e,r){return new Zu({ca:3,ga:e.settings.ga,methodName:t._methodName,la:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class eh extends Ku{constructor(t,e){super(t),this.pa=e}_toFieldTransform(t){const e=th(this,t,!0),r=this.pa.map((t=>ah(t,e))),n=new Sa(r);return new Ia(t.path,n)}isEqual(t){return this===t}}class rh extends Ku{constructor(t,e){super(t),this.pa=e}_toFieldTransform(t){const e=th(this,t,!0),r=this.pa.map((t=>ah(t,e))),n=new Aa(r);return new Ia(t.path,n)}isEqual(t){return this===t}}function nh(t,e,r,n){const i=t.ya(1,e,r);lh("Data must be an object, but it was:",i,n);const s=[],a=os.empty();Ri(n,((t,n)=>{const c=dh(e,t,r);n=(0,o.m9)(n);const l=i.da(c);if(n instanceof Ju)s.push(c);else{const t=ah(n,l);null!=t&&(s.push(c),a.set(c,t))}}));const c=new Li(s);return new Wu(a,c,i.fieldTransforms)}function ih(t,e,r,n,i,s){const a=t.ya(1,e,r),c=[uh(e,n,r)],l=[i];if(s.length%2!=0)throw new Vn(jn.INVALID_ARGUMENT,"Function ".concat(e,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let o=0;o<s.length;o+=2)c.push(uh(e,s[o])),l.push(s[o+1]);const u=[],h=os.empty();for(let f=c.length-1;f>=0;--f)if(!ph(u,c[f])){const t=c[f];let e=l[f];e=(0,o.m9)(e);const r=a.da(t);if(e instanceof Ju)u.push(t);else{const n=ah(e,r);null!=n&&(u.push(t),h.set(t,n))}}const d=new Li(u);return new Wu(h,d,a.fieldTransforms)}function sh(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ah(r,t.ya(n?4:3,e))}function ah(t,e){if(ch(t=(0,o.m9)(t)))return lh("Unsupported field value:",e,t),oh(t,e);if(t instanceof Ku)return function(t,e){if(!Yu(e.ca))throw e._a("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e._a("".concat(t._methodName,"() is not currently supported inside arrays"));const r=t._toFieldTransform(e);r&&e.fieldTransforms.push(r)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,e){const r=[];let n=0;for(const i of t){let t=ah(i,e.wa(n));null==t&&(t={nullValue:"NULL_VALUE"}),r.push(t),n++}return{arrayValue:{values:r}}}(t,e)}return function(t,e){if(null===(t=(0,o.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return va(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=ei.fromDate(t);return{timestampValue:_o(e.serializer,r)}}if(t instanceof ei){const r=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:_o(e.serializer,r)}}if(t instanceof Hu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vu)return{bytesValue:Ao(e.serializer,t._byteString)};if(t instanceof Iu){const r=e.databaseId,n=t.firestore._databaseId;if(!n.isEqual(r))throw e._a("Document reference is for database ".concat(n.projectId,"/").concat(n.database," but should be for database ").concat(r.projectId,"/").concat(r.database));return{referenceValue:ko(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e._a("Unsupported field value: ".concat(Au(t)))}(t,e)}function oh(t,e){const r={};return Ci(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ri(t,((t,n)=>{const i=ah(n,e.ha(t));null!=i&&(r[t]=i)})),{mapValue:{fields:r}}}function ch(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof Hu||t instanceof Vu||t instanceof Iu||t instanceof Ku)}function lh(t,e,r){if(!ch(r)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(r)){const n=Au(r);throw"an object"===n?e._a(t+" a custom object"):e._a(t+" "+n)}}function uh(t,e,r){if((e=(0,o.m9)(e))instanceof Gu)return e._internalPath;if("string"==typeof e)return dh(t,e);throw fh("Field path arguments must be of type string or ",t,!1,void 0,r)}const hh=new RegExp("[~\\*/\\[\\]]");function dh(t,e,r){if(e.search(hh)>=0)throw fh("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,r);try{return new Gu(...e.split("."))._internalPath}catch(n){throw fh("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,r)}}function fh(t,e,r,n,i){const s=n&&!n.isEmpty(),a=void 0!==i;let o="Function ".concat(e,"() called with invalid data");r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=" in field ".concat(n)),a&&(c+=" in document ".concat(i)),c+=")"),new Vn(jn.INVALID_ARGUMENT,o+t+c)}function ph(t,e){return t.some((t=>t.isEqual(e)))}class gh{constructor(t,e,r,n,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Iu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new mh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(vh("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class mh extends gh{data(){return super.data()}}function vh(t,e){return"string"==typeof e?dh(t,e):e instanceof Gu?e._internalPath:e._delegate._internalPath}function yh(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Vn(jn.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bh{}class Eh extends bh{}function wh(t,e){let r=[];for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];e instanceof bh&&r.push(e),r=r.concat(i),function(t){const e=t.filter((t=>t instanceof _h)).length,r=t.filter((t=>t instanceof Th)).length;if(e>1||e>0&&r>0)throw new Vn(jn.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const a of r)t=a._apply(t);return t}class Th extends Eh{constructor(t,e,r){super(),this._field=t,this._op=e,this._value=r,this.type="where"}static _create(t,e,r){return new Th(t,e,r)}_apply(t){const e=this._parse(t);return Oh(t._query,e),new Du(t.firestore,t.converter,qs(t._query,e))}_parse(t){const e=Qu(t.firestore),r=function(t,e,r,n,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Vn(jn.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){kh(a,s);const e=[];for(const r of a)e.push(Ch(n,t,r));o={arrayValue:{values:e}}}else o=Ch(n,t,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||kh(a,s),o=sh(r,"where",a,"in"===s||"not-in"===s);return ms.create(i,s,o)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value);return r}}function Sh(t,e,r){const n=e,i=vh("where",t);return Th._create(i,n,r)}class _h extends bh{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new _h(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:vs.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let r=t;const n=e.getFlattenedFilters();for(const i of n)Oh(r,i),r=qs(r,i)}(t._query,e),new Du(t.firestore,t.converter,qs(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ah extends Eh{constructor(t,e,r){super(),this.type=t,this._limit=e,this._limitType=r}static _create(t,e,r){return new Ah(t,e,r)}_apply(t){return new Du(t.firestore,t.converter,Ws(t._query,this._limit,this._limitType))}}function Rh(t){return Cu("limit",t),Ah._create("limit",t,"F")}function Ch(t,e,r){if("string"==typeof(r=(0,o.m9)(r))){if(""===r)throw new Vn(jn.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ks(e)&&-1!==r.indexOf("/"))throw new Vn(jn.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(r,"' contains a '/' character."));const n=e.path.child(ii.fromString(r));if(!oi.isDocumentKey(n))throw new Vn(jn.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(n,"' is not because it has an odd number of segments (").concat(n.length,")."));return Ji(t,new oi(n))}if(r instanceof Iu)return Ji(t,r._key);throw new Vn(jn.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Au(r),"."))}function kh(t,e){if(!Array.isArray(t)||0===t.length)throw new Vn(jn.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(e.toString(),"' filters."))}function Oh(t,e){if(e.isInequality()){const r=Gs(t),n=e.field;if(null!==r&&!r.isEqual(n))throw new Vn(jn.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(r.toString(),"' and '").concat(n.toString(),"'"));const i=Vs(t);null!==i&&Ih(t,n,i)}const r=function(t,e){for(const r of t)for(const t of r.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==r)throw r===e.op?new Vn(jn.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(e.op.toString(),"' filter.")):new Vn(jn.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(e.op.toString(),"' filters with '").concat(r.toString(),"' filters."))}function Ih(t,e,r){if(!r.isEqual(e))throw new Vn(jn.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(e.toString(),"' and so you must also use '").concat(e.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(r.toString(),"' instead."))}class Dh{convertValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(qi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ui(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Bi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Fn()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const r={};return Ri(t,((t,n)=>{r[t]=this.convertValue(n,e)})),r}convertGeoPoint(t){return new Hu(Ui(t.latitude),Ui(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const r=Vi(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Gi(t));default:return null}}convertTimestamp(t){const e=Fi(t);return new ei(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=ii.fromString(t);Un(Zo(r));const n=new Hi(r.get(1),r.get(3)),i=new oi(r.popFirst(5));return n.isEqual(e)||Pn("Document ".concat(i," contains a document reference within a different database (").concat(n.projectId,"/").concat(n.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),i}}function xh(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Lh{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ph extends gh{constructor(t,e,r,n,i,s){super(t,e,r,n,s),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const e=new Nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const r=this._document.data.field(vh("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class Nh extends Ph{data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(t)}}class Mh{constructor(t,e,r,n){this._firestore=t,this._userDataWriter=e,this._snapshot=n,this.metadata=new Lh(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((r=>{t.call(e,new Nh(this._firestore,this._userDataWriter,r.key,r,new Lh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Vn(jn.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((r=>{const n=new Nh(t._firestore,t._userDataWriter,r.doc.key,r.doc,new Lh(t._snapshot.mutatedKeys.has(r.doc.key),t._snapshot.fromCache),t.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:e++}}))}{let r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const n=new Nh(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Lh(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,s=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(r=r.add(e.doc),s=r.indexOf(e.doc.key)),{type:Fh(e.type),doc:n,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Fh(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fn()}}function Uh(t){t=Ru(t,Iu);const e=Ru(t.firestore,Fu);return bu(Bu(e),t._key).then((r=>qh(e,t,r)))}class Bh extends Dh{constructor(t){super(),this.firestore=t}convertBytes(t){return new Vu(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Iu(this.firestore,null,e)}}function jh(t,e,r){t=Ru(t,Iu);const n=Ru(t.firestore,Fu),i=xh(t.converter,e,r);return zh(n,[$u(Qu(n),"setDoc",t._key,i,null!==t.converter,r).toMutation(t._key,xa.none())])}function Vh(t,e,r){t=Ru(t,Iu);const n=Ru(t.firestore,Fu),i=Qu(n);let s;for(var a=arguments.length,c=new Array(a>3?a-3:0),l=3;l<a;l++)c[l-3]=arguments[l];return s="string"==typeof(e=(0,o.m9)(e))||e instanceof Gu?ih(i,"updateDoc",t._key,e,r,c):nh(i,"updateDoc",t._key,e),zh(n,[s.toMutation(t._key,xa.exists(!0))])}function Gh(t){return zh(Ru(t.firestore,Fu),[new za(t._key,xa.none())])}function Kh(t,e){const r=Ru(t.firestore,Fu),n=Pu(t),i=xh(t.converter,e);return zh(r,[$u(Qu(t.firestore),"addDoc",n._key,i,null!==t.converter,{}).toMutation(n._key,xa.exists(!1))]).then((()=>n))}function Hh(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i,s,a;t=(0,o.m9)(t);let c={includeMetadataChanges:!1},l=0;"object"!=typeof r[l]||Mu(r[l])||(c=r[l],l++);const u={includeMetadataChanges:c.includeMetadataChanges};if(Mu(r[l])){const t=r[l];r[l]=null===(i=t.next)||void 0===i?void 0:i.bind(t),r[l+1]=null===(s=t.error)||void 0===s?void 0:s.bind(t),r[l+2]=null===(a=t.complete)||void 0===a?void 0:a.bind(t)}let h,d,f;if(t instanceof Iu)d=Ru(t.firestore,Fu),f=Bs(t._key.path),h={next:e=>{r[l]&&r[l](qh(d,t,e))},error:r[l+1],complete:r[l+2]};else{const e=Ru(t,Du);d=Ru(e.firestore,Fu),f=e._query;const n=new Bh(d);h={next:t=>{r[l]&&r[l](new Mh(d,n,e,t))},error:r[l+1],complete:r[l+2]},yh(t._query)}return function(t,e,r,n){const i=new uu(n),s=new Nl(e,i,r);return t.asyncQueue.enqueueAndForget((async()=>Il(await yu(t),s))),()=>{i.Dc(),t.asyncQueue.enqueueAndForget((async()=>Dl(await yu(t),s)))}}(Bu(d),f,u,h)}function zh(t,e){return function(t,e){const r=new Gn;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,r){const n=ou(t);try{const t=await function(t,e){const r=Bn(t),n=ei.now(),i=e.reduce(((t,e)=>t.add(e.key)),da());let s,a;return r.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let o=na(),c=da();return r.Zi.getEntries(t,i).next((t=>{o=t,o.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>r.localDocuments.getOverlayedDocuments(t,o))).next((i=>{s=i;const a=[];for(const t of e){const e=Ua(t,s.get(t.key).overlayedDocument);null!=e&&a.push(new Va(t.key,e,cs(e.value.mapValue),xa.exists(!0)))}return r.mutationQueue.addMutationBatch(t,n,a,e)})).next((e=>{a=e;const n=e.applyToLocalDocumentSet(s,c);return r.documentOverlayCache.saveOverlays(t,e.batchId,n)}))})).then((()=>({batchId:a.batchId,changes:aa(s)})))}(n.localStore,e);n.sharedClientState.addPendingMutation(t.batchId),function(t,e,r){let n=t.Tc[t.currentUser.toKey()];n||(n=new ki(Jn)),n=n.insert(e,r),t.Tc[t.currentUser.toKey()]=n}(n,t.batchId,r),await nu(n,t.changes),await ul(n.remoteStore)}catch(t){const e=_l(t,"Failed to persist write");r.reject(e)}}(await vu(t),e,r))),r.promise}(Bu(t),e)}function qh(t,e,r){const n=r.docs.get(e._key),i=new Bh(t);return new Ph(t,i,e._key,n,new Lh(r.hasPendingWrites,r.fromCache),e.converter)}function Wh(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return new eh("arrayUnion",e)}function Yh(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return new rh("arrayRemove",e)}!function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(t){In=t}(i.Jn),(0,i.Xd)(new s.wA("firestore",((t,r)=>{let{instanceIdentifier:n,options:i}=r;const s=t.getProvider("app").getImmediate(),a=new Fu(new qn(t.getProvider("auth-internal")),new Xn(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Vn(jn.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hi(t.options.projectId,e)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),(0,i.KN)(kn,"3.13.0",t),(0,i.KN)(kn,"3.13.0","esm2017")}()},4766:(t,e,r)=>{"use strict";r.d(e,{BH:()=>d,L:()=>a,LL:()=>v,P0:()=>u,Sg:()=>f,ZR:()=>m,aH:()=>h,eu:()=>g,hl:()=>p,m9:()=>w,vZ:()=>b});const n=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=63&i|128):55296===(64512&i)&&n+1<t.length&&56320===(64512&t.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++n)),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=63&i|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=63&i|128)}return e},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const e=t[i],s=i+1<t.length,a=s?t[i+1]:0,o=i+2<t.length,c=o?t[i+2]:0,l=e>>2,u=(3&e)<<4|a>>4;let h=(15&a)<<2|c>>6,d=63&c;o||(d=64,s||(h=64)),n.push(r[l],r[u],r[h],r[d])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(n(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[n++]=String.fromCharCode(55296+(s>>10)),e[n++]=String.fromCharCode(56320+(1023&s))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const e=r[t.charAt(i++)],a=i<t.length?r[t.charAt(i)]:0;++i;const o=i<t.length?r[t.charAt(i)]:64;++i;const c=i<t.length?r[t.charAt(i)]:64;if(++i,null==e||null==a||null==o||null==c)throw new s;const l=e<<2|a>>4;if(n.push(l),64!==o){const t=a<<4&240|o>>2;if(n.push(t),64!==c){const t=o<<6&192|c;n.push(t)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(t){return function(t){const e=n(t);return i.encodeByteArray(e,!0)}(t).replace(/\./g,"")},o=function(t){try{return i.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};const c=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,l=()=>{try{return c()||(()=>{if("undefined"===typeof process)return;const t={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTH0_CLIENT_ID:"AVw2gK2A2eFM3xTsoMnzpy3V4LQhJrAZ",REACT_APP_AUTH0_DOMAIN:"dev-qx6lj54s.us.auth0.com"}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"===typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const e=t&&o(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(t))}},u=t=>{const e=(t=>{var e,r;return null===(r=null===(e=l())||void 0===e?void 0:e.emulatorHosts)||void 0===r?void 0:r[t]})(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));const n=parseInt(e.substring(r+1),10);return"["===e[0]?[e.substring(1,r-1),n]:[e.substring(0,r),n]},h=()=>{var t;return null===(t=l())||void 0===t?void 0:t.config};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"===typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,r))}}}function f(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",n=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(r),aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(s)),""].join(".")}function p(){try{return"object"===typeof indexedDB}catch(t){return!1}}function g(){return new Promise(((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(r){e(r)}}))}class m extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,v.prototype.create)}}class v{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t){const e=(arguments.length<=1?void 0:arguments[1])||{},r="".concat(this.service,"/").concat(t),n=this.errors[t],i=n?function(t,e){return t.replace(y,((t,r)=>{const n=e[r];return null!=n?String(n):"<".concat(r,"?>")}))}(n,e):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(r,").");return new m(r,s,e)}}const y=/\{\$([^}]+)}/g;function b(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const r=t[i],s=e[i];if(E(r)&&E(s)){if(!b(r,s))return!1}else if(r!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function E(t){return null!==t&&"object"===typeof t}function w(t){return t&&t._delegate?t._delegate:t}},7211:(t,e,r)=>{"use strict";r.d(e,{Z:()=>M});var n=r(3366),i=r(7462),s=r(7313),a=r(4146),o=r(1921),c=r(3959),l=r(3530),u=r(1721),h=r(1168);const d=!1,f=s.createContext(null);var p="unmounted",g="exited",m="entering",v="entered",y="exiting",b=function(t){function e(e,r){var n;n=t.call(this,e,r)||this;var i,s=r&&!r.isMounting?e.enter:e.appear;return n.appearStatus=null,e.in?s?(i=g,n.appearStatus=m):i=v:i=e.unmountOnExit||e.mountOnEnter?p:g,n.state={status:i},n.nextCallback=null,n}(0,u.Z)(e,t),e.getDerivedStateFromProps=function(t,e){return t.in&&e.status===p?{status:g}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(t){var e=null;if(t!==this.props){var r=this.state.status;this.props.in?r!==m&&r!==v&&(e=m):r!==m&&r!==v||(e=y)}this.updateStatus(!1,e)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var t,e,r,n=this.props.timeout;return t=e=r=n,null!=n&&"number"!==typeof n&&(t=n.exit,e=n.enter,r=void 0!==n.appear?n.appear:e),{exit:t,enter:e,appear:r}},r.updateStatus=function(t,e){if(void 0===t&&(t=!1),null!==e)if(this.cancelNextCallback(),e===m){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:h.findDOMNode(this);r&&function(t){t.scrollTop}(r)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===g&&this.setState({status:p})},r.performEnter=function(t){var e=this,r=this.props.enter,n=this.context?this.context.isMounting:t,i=this.props.nodeRef?[n]:[h.findDOMNode(this),n],s=i[0],a=i[1],o=this.getTimeouts(),c=n?o.appear:o.enter;!t&&!r||d?this.safeSetState({status:v},(function(){e.props.onEntered(s)})):(this.props.onEnter(s,a),this.safeSetState({status:m},(function(){e.props.onEntering(s,a),e.onTransitionEnd(c,(function(){e.safeSetState({status:v},(function(){e.props.onEntered(s,a)}))}))})))},r.performExit=function(){var t=this,e=this.props.exit,r=this.getTimeouts(),n=this.props.nodeRef?void 0:h.findDOMNode(this);e&&!d?(this.props.onExit(n),this.safeSetState({status:y},(function(){t.props.onExiting(n),t.onTransitionEnd(r.exit,(function(){t.safeSetState({status:g},(function(){t.props.onExited(n)}))}))}))):this.safeSetState({status:g},(function(){t.props.onExited(n)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(t,e){e=this.setNextCallback(e),this.setState(t,e)},r.setNextCallback=function(t){var e=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,e.nextCallback=null,t(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(t,e){this.setNextCallback(e);var r=this.props.nodeRef?this.props.nodeRef.current:h.findDOMNode(this),n=null==t&&!this.props.addEndListener;if(r&&!n){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],s=i[0],a=i[1];this.props.addEndListener(s,a)}null!=t&&setTimeout(this.nextCallback,t)}else setTimeout(this.nextCallback,0)},r.render=function(){var t=this.state.status;if(t===p)return null;var e=this.props,r=e.children,i=(e.in,e.mountOnEnter,e.unmountOnExit,e.appear,e.enter,e.exit,e.timeout,e.addEndListener,e.onEnter,e.onEntering,e.onEntered,e.onExit,e.onExiting,e.onExited,e.nodeRef,(0,n.Z)(e,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return s.createElement(f.Provider,{value:null},"function"===typeof r?r(t,i):s.cloneElement(s.Children.only(r),i))},e}(s.Component);function E(){}b.contextType=f,b.propTypes={},b.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:E,onEntering:E,onEntered:E,onExit:E,onExiting:E,onExited:E},b.UNMOUNTED=p,b.EXITED=g,b.ENTERING=m,b.ENTERED=v,b.EXITING=y;const w=b;var T=r(6936),S=r(6542),_=r(2951);function A(t,e){var r,n;const{timeout:i,easing:s,style:a={}}=t;return{duration:null!=(r=a.transitionDuration)?r:"number"===typeof i?i:i[e.mode]||0,easing:null!=(n=a.transitionTimingFunction)?n:"object"===typeof s?s[e.mode]:s,delay:a.transitionDelay}}const R=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return s.useMemo((()=>e.every((t=>null==t))?null:t=>{e.forEach((e=>{!function(t,e){"function"===typeof t?t(e):t&&(t.current=e)}(e,t)}))}),e)};var C=r(6417);const k=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],O={entering:{opacity:1},entered:{opacity:1}},I=s.forwardRef((function(t,e){const r=function(){const t=(0,T.Z)(S.Z);return t[_.Z]||t}(),a={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:c=!0,children:l,easing:u,in:h,onEnter:d,onEntered:f,onEntering:p,onExit:g,onExited:m,onExiting:v,style:y,timeout:b=a,TransitionComponent:E=w}=t,I=(0,n.Z)(t,k),D=s.useRef(null),x=R(D,l.ref,e),L=t=>e=>{if(t){const r=D.current;void 0===e?t(r):t(r,e)}},P=L(p),N=L(((t,e)=>{(t=>{t.scrollTop})(t);const n=A({style:y,timeout:b,easing:u},{mode:"enter"});t.style.webkitTransition=r.transitions.create("opacity",n),t.style.transition=r.transitions.create("opacity",n),d&&d(t,e)})),M=L(f),F=L(v),U=L((t=>{const e=A({style:y,timeout:b,easing:u},{mode:"exit"});t.style.webkitTransition=r.transitions.create("opacity",e),t.style.transition=r.transitions.create("opacity",e),g&&g(t)})),B=L(m);return(0,C.jsx)(E,(0,i.Z)({appear:c,in:h,nodeRef:D,onEnter:N,onEntered:M,onEntering:P,onExit:U,onExited:B,onExiting:F,addEndListener:t=>{o&&o(D.current,t)},timeout:b},I,{children:(t,e)=>s.cloneElement(l,(0,i.Z)({style:(0,i.Z)({opacity:0,visibility:"exited"!==t||h?void 0:"hidden"},O[t],y,l.props.style),ref:x},e))}))}));var D=r(7430),x=r(4591);function L(t){return(0,x.Z)("MuiBackdrop",t)}(0,D.Z)("MuiBackdrop",["root","invisible"]);const P=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],N=(0,c.ZP)("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})((t=>{let{ownerState:e}=t;return(0,i.Z)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"})})),M=s.forwardRef((function(t,e){var r,s,c;const u=(0,l.Z)({props:t,name:"MuiBackdrop"}),{children:h,className:d,component:f="div",components:p={},componentsProps:g={},invisible:m=!1,open:v,slotProps:y={},slots:b={},TransitionComponent:E=I,transitionDuration:w}=u,T=(0,n.Z)(u,P),S=(0,i.Z)({},u,{component:f,invisible:m}),_=(t=>{const{classes:e,invisible:r}=t,n={root:["root",r&&"invisible"]};return(0,o.Z)(n,L,e)})(S),A=null!=(r=y.root)?r:g.root;return(0,C.jsx)(E,(0,i.Z)({in:v,timeout:w},T,{children:(0,C.jsx)(N,(0,i.Z)({"aria-hidden":!0},A,{as:null!=(s=null!=(c=b.root)?c:p.Root)?s:f,className:(0,a.Z)(_.root,d,null==A?void 0:A.className),ownerState:(0,i.Z)({},S,null==A?void 0:A.ownerState),classes:_,ref:e,children:h}))}))}))},6542:(t,e,r)=>{"use strict";r.d(e,{Z:()=>H});var n=r(7462),i=r(3366),s=r(7219),a=r(3019),o=r(9456),c=r(3232),l=r(3649);function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),r)}function h(t){if(t.type)return t;if("#"===t.charAt(0))return h(function(t){t=t.slice(1);const e=new RegExp(".{1,".concat(t.length>=6?2:1,"}"),"g");let r=t.match(e);return r&&1===r[0].length&&(r=r.map((t=>t+t))),r?"rgb".concat(4===r.length?"a":"","(").concat(r.map(((t,e)=>e<3?parseInt(t,16):Math.round(parseInt(t,16)/255*1e3)/1e3)).join(", "),")"):""}(t));const e=t.indexOf("("),r=t.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(r))throw new Error((0,s.Z)(9,t));let n,i=t.substring(e+1,t.length-1);if("color"===r){if(i=i.split(" "),n=i.shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n))throw new Error((0,s.Z)(10,n))}else i=i.split(",");return i=i.map((t=>parseFloat(t))),{type:r,values:i,colorSpace:n}}function d(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return-1!==e.indexOf("rgb")?n=n.map(((t,e)=>e<3?parseInt(t,10):t)):-1!==e.indexOf("hsl")&&(n[1]="".concat(n[1],"%"),n[2]="".concat(n[2],"%")),n=-1!==e.indexOf("color")?"".concat(r," ").concat(n.join(" ")):"".concat(n.join(", ")),"".concat(e,"(").concat(n,")")}function f(t){let e="hsl"===(t=h(t)).type||"hsla"===t.type?h(function(t){t=h(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,s=n*Math.min(i,1-i),a=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+r/30)%12;return i-s*Math.max(Math.min(e-3,9-e,1),-1)};let o="rgb";const c=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===t.type&&(o+="a",c.push(e[3])),d({type:o,values:c})}(t)).values:t.values;return e=e.map((e=>("color"!==t.type&&(e/=255),e<=.03928?e/12.92:((e+.055)/1.055)**2.4))),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function p(t,e){if(t=h(t),e=u(e),-1!==t.type.indexOf("hsl"))t.values[2]*=1-e;else if(-1!==t.type.indexOf("rgb")||-1!==t.type.indexOf("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return d(t)}function g(t,e){if(t=h(t),e=u(e),-1!==t.type.indexOf("hsl"))t.values[2]+=(100-t.values[2])*e;else if(-1!==t.type.indexOf("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(-1!==t.type.indexOf("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return d(t)}const m={black:"#000",white:"#fff"},v={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},y={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},b={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},E={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},w={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},T={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},S={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},_=["mode","contrastThreshold","tonalOffset"],A={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:m.white,default:m.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},R={text:{primary:m.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:m.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function C(t,e,r,n){const i=n.light||n,s=n.dark||1.5*n;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:"light"===e?t.light=g(t.main,i):"dark"===e&&(t.dark=p(t.main,s)))}function k(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:o=.2}=t,c=(0,i.Z)(t,_),l=t.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:w[200],light:w[50],dark:w[400]}:{main:w[700],light:w[400],dark:w[800]}}(e),u=t.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:y[200],light:y[50],dark:y[400]}:{main:y[500],light:y[300],dark:y[700]}}(e),h=t.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:b[500],light:b[300],dark:b[700]}:{main:b[700],light:b[400],dark:b[800]}}(e),d=t.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:T[400],light:T[300],dark:T[700]}:{main:T[700],light:T[500],dark:T[900]}}(e),p=t.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:S[400],light:S[300],dark:S[700]}:{main:S[800],light:S[500],dark:S[900]}}(e),g=t.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:E[400],light:E[300],dark:E[700]}:{main:"#ed6c02",light:E[500],dark:E[900]}}(e);function k(t){const e=function(t,e){const r=f(t),n=f(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}(t,R.text.primary)>=r?R.text.primary:A.text.primary;return e}const O=t=>{let{color:e,name:r,mainShade:i=500,lightShade:a=300,darkShade:c=700}=t;if(e=(0,n.Z)({},e),!e.main&&e[i]&&(e.main=e[i]),!e.hasOwnProperty("main"))throw new Error((0,s.Z)(11,r?" (".concat(r,")"):"",i));if("string"!==typeof e.main)throw new Error((0,s.Z)(12,r?" (".concat(r,")"):"",JSON.stringify(e.main)));return C(e,"light",a,o),C(e,"dark",c,o),e.contrastText||(e.contrastText=k(e.main)),e},I={dark:R,light:A};return(0,a.Z)((0,n.Z)({common:(0,n.Z)({},m),mode:e,primary:O({color:l,name:"primary"}),secondary:O({color:u,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:O({color:h,name:"error"}),warning:O({color:g,name:"warning"}),info:O({color:d,name:"info"}),success:O({color:p,name:"success"}),grey:v,contrastThreshold:r,getContrastText:k,augmentColor:O,tonalOffset:o},I[e]),c)}const O=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const I={textTransform:"uppercase"},D='"Roboto", "Helvetica", "Arial", sans-serif';function x(t,e){const r="function"===typeof e?e(t):e,{fontFamily:s=D,fontSize:o=14,fontWeightLight:c=300,fontWeightRegular:l=400,fontWeightMedium:u=500,fontWeightBold:h=700,htmlFontSize:d=16,allVariants:f,pxToRem:p}=r,g=(0,i.Z)(r,O);const m=o/14,v=p||(t=>"".concat(t/d*m,"rem")),y=(t,e,r,i,a)=>{return(0,n.Z)({fontFamily:s,fontWeight:t,fontSize:v(e),lineHeight:r},s===D?{letterSpacing:"".concat((o=i/e,Math.round(1e5*o)/1e5),"em")}:{},a,f);var o},b={h1:y(c,96,1.167,-1.5),h2:y(c,60,1.2,-.5),h3:y(l,48,1.167,0),h4:y(l,34,1.235,.25),h5:y(l,24,1.334,0),h6:y(u,20,1.6,.15),subtitle1:y(l,16,1.75,.15),subtitle2:y(u,14,1.57,.1),body1:y(l,16,1.5,.15),body2:y(l,14,1.43,.15),button:y(u,14,1.75,.4,I),caption:y(l,12,1.66,.4),overline:y(l,12,2.66,1,I),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,a.Z)((0,n.Z)({htmlFontSize:d,pxToRem:v,fontFamily:s,fontSize:o,fontWeightLight:c,fontWeightRegular:l,fontWeightMedium:u,fontWeightBold:h},b),g,{clone:!1})}function L(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const P=["none",L(0,2,1,-1,0,1,1,0,0,1,3,0),L(0,3,1,-2,0,2,2,0,0,1,5,0),L(0,3,3,-2,0,3,4,0,0,1,8,0),L(0,2,4,-1,0,4,5,0,0,1,10,0),L(0,3,5,-1,0,5,8,0,0,1,14,0),L(0,3,5,-1,0,6,10,0,0,1,18,0),L(0,4,5,-2,0,7,10,1,0,2,16,1),L(0,5,5,-3,0,8,10,1,0,3,14,2),L(0,5,6,-3,0,9,12,1,0,3,16,2),L(0,6,6,-3,0,10,14,1,0,4,18,3),L(0,6,7,-4,0,11,15,1,0,4,20,3),L(0,7,8,-4,0,12,17,2,0,5,22,4),L(0,7,8,-4,0,13,19,2,0,5,24,4),L(0,7,9,-4,0,14,21,2,0,5,26,4),L(0,8,9,-5,0,15,22,2,0,6,28,5),L(0,8,10,-5,0,16,24,2,0,6,30,5),L(0,8,11,-5,0,17,26,2,0,6,32,5),L(0,9,11,-5,0,18,28,2,0,7,34,6),L(0,9,12,-6,0,19,29,2,0,7,36,6),L(0,10,13,-6,0,20,31,3,0,8,38,7),L(0,10,13,-6,0,21,33,3,0,8,40,7),L(0,10,14,-6,0,22,35,3,0,8,42,7),L(0,11,14,-7,0,23,36,3,0,9,44,8),L(0,11,15,-7,0,24,38,3,0,9,46,8)],N=["duration","easing","delay"],M={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},F={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function U(t){return"".concat(Math.round(t),"ms")}function B(t){if(!t)return 0;const e=t/36;return Math.round(10*(4+15*e**.25+e/5))}function j(t){const e=(0,n.Z)({},M,t.easing),r=(0,n.Z)({},F,t.duration);return(0,n.Z)({getAutoHeightDuration:B,create:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:s=r.standard,easing:a=e.easeInOut,delay:o=0}=n;(0,i.Z)(n,N);return(Array.isArray(t)?t:[t]).map((t=>"".concat(t," ").concat("string"===typeof s?s:U(s)," ").concat(a," ").concat("string"===typeof o?o:U(o)))).join(",")}},t,{easing:e,duration:r})}const V={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},G=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function K(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:e={},palette:r={},transitions:u={},typography:h={}}=t,d=(0,i.Z)(t,G);if(t.vars)throw new Error((0,s.Z)(18));const f=k(r),p=(0,o.Z)(t);let g=(0,a.Z)(p,{mixins:(m=p.breakpoints,v=e,(0,n.Z)({toolbar:{minHeight:56,[m.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[m.up("sm")]:{minHeight:64}}},v)),palette:f,shadows:P.slice(),typography:x(f,h),transitions:j(u),zIndex:(0,n.Z)({},V)});var m,v;g=(0,a.Z)(g,d);for(var y=arguments.length,b=new Array(y>1?y-1:0),E=1;E<y;E++)b[E-1]=arguments[E];return g=b.reduce(((t,e)=>(0,a.Z)(t,e)),g),g.unstable_sxConfig=(0,n.Z)({},c.Z,null==d?void 0:d.unstable_sxConfig),g.unstable_sx=function(t){return(0,l.Z)({sx:t,theme:this})},g}const H=K()},2951:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});const n="$$material"},3959:(t,e,r)=>{"use strict";r.d(e,{ZP:()=>F});var n=r(3366),i=r(7462),s=r(7313),a=r(1816),o=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,c=(0,a.Z)((function(t){return o.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),l=r(3346);var u=function(t,e,r){var n=t.key+"-"+e.name;!1===r&&void 0===t.registered[n]&&(t.registered[n]=e.styles)},h=r(1086),d=r(5696),f=c,p=function(t){return"theme"!==t},g=function(t){return"string"===typeof t&&t.charCodeAt(0)>96?f:p},m=function(t,e,r){var n;if(e){var i=e.shouldForwardProp;n=t.__emotion_forwardProp&&i?function(e){return t.__emotion_forwardProp(e)&&i(e)}:i}return"function"!==typeof n&&r&&(n=t.__emotion_forwardProp),n},v=function(t){var e=t.cache,r=t.serialized,n=t.isStringTag;return u(e,r,n),(0,d.L)((function(){return function(t,e,r){u(t,e,r);var n=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var i=e;do{t.insert(e===i?"."+n:"",i,t.sheet,!0),i=i.next}while(void 0!==i)}}(e,r,n)})),null},y=function t(e,r){var n,a,o=e.__emotion_real===e,c=o&&e.__emotion_base||e;void 0!==r&&(n=r.label,a=r.target);var u=m(e,r,o),d=u||g(c),f=!d("as");return function(){var p=arguments,y=o&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==n&&y.push("label:"+n+";"),null==p[0]||void 0===p[0].raw)y.push.apply(y,p);else{0,y.push(p[0][0]);for(var b=p.length,E=1;E<b;E++)y.push(p[E],p[0][E])}var w=(0,l.w)((function(t,e,r){var n=f&&t.as||c,i="",o=[],p=t;if(null==t.theme){for(var m in p={},t)p[m]=t[m];p.theme=s.useContext(l.T)}"string"===typeof t.className?i=function(t,e,r){var n="";return r.split(" ").forEach((function(r){void 0!==t[r]?e.push(t[r]+";"):n+=r+" "})),n}(e.registered,o,t.className):null!=t.className&&(i=t.className+" ");var b=(0,h.O)(y.concat(o),e.registered,p);i+=e.key+"-"+b.name,void 0!==a&&(i+=" "+a);var E=f&&void 0===u?g(n):d,w={};for(var T in t)f&&"as"===T||E(T)&&(w[T]=t[T]);return w.className=i,w.ref=r,s.createElement(s.Fragment,null,s.createElement(v,{cache:e,serialized:b,isStringTag:"string"===typeof n}),s.createElement(n,w))}));return w.displayName=void 0!==n?n:"Styled("+("string"===typeof c?c:c.displayName||c.name||"Component")+")",w.defaultProps=e.defaultProps,w.__emotion_real=w,w.__emotion_base=c,w.__emotion_styles=y,w.__emotion_forwardProp=u,Object.defineProperty(w,"toString",{value:function(){return"."+a}}),w.withComponent=function(e,n){return t(e,(0,i.Z)({},r,n,{shouldForwardProp:m(w,n,!0)})).apply(void 0,y)},w}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(t){y[t]=y(t)}));var b=r(3019),E=r(9456),w=r(8831);const T=["variant"];function S(t){return 0===t.length}function _(t){const{variant:e}=t,r=(0,n.Z)(t,T);let i=e||"";return Object.keys(r).sort().forEach((e=>{i+="color"===e?S(i)?t[e]:(0,w.Z)(t[e]):"".concat(S(i)?e:(0,w.Z)(e)).concat((0,w.Z)(t[e].toString()))})),i}var A=r(3649);const R=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];const C=t=>{const e={};return t&&t.forEach((t=>{const r=_(t.props);e[r]=t.style})),e},k=(t,e,r)=>{const{ownerState:n={}}=t,i=[];return r&&r.forEach((r=>{let s=!0;Object.keys(r.props).forEach((e=>{n[e]!==r.props[e]&&t[e]!==r.props[e]&&(s=!1)})),s&&i.push(e[_(r.props)])})),i};function O(t){return"ownerState"!==t&&"theme"!==t&&"sx"!==t&&"as"!==t}const I=(0,E.Z)(),D=t=>t?t.charAt(0).toLowerCase()+t.slice(1):t;function x(t){let{defaultTheme:e,theme:r,themeId:n}=t;return i=r,0===Object.keys(i).length?e:r[n]||r;var i}function L(t){return t?(e,r)=>r[t]:null}const P=t=>{let{styledArg:e,props:r,defaultTheme:n,themeId:s}=t;const a=e((0,i.Z)({},r,{theme:x((0,i.Z)({},r,{defaultTheme:n,themeId:s}))}));let o;if(a&&a.variants&&(o=a.variants,delete a.variants),o){return[a,...k(r,C(o),o)]}return a};var N=r(6542);const M=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:e,defaultTheme:r=I,rootShouldForwardProp:s=O,slotShouldForwardProp:a=O}=t,o=t=>(0,A.Z)((0,i.Z)({},t,{theme:x((0,i.Z)({},t,{defaultTheme:r,themeId:e}))}));return o.__mui_systemSx=!0,function(t){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};((t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))})(t,(t=>t.filter((t=>!(null!=t&&t.__mui_systemSx)))));const{name:l,slot:u,skipVariantsResolver:h,skipSx:d,overridesResolver:f=L(D(u))}=c,p=(0,n.Z)(c,R),g=void 0!==h?h:u&&"Root"!==u&&"root"!==u||!1,m=d||!1;let v=O;"Root"===u||"root"===u?v=s:u?v=a:function(t){return"string"===typeof t&&t.charCodeAt(0)>96}(t)&&(v=void 0);const E=function(t,e){return y(t,e)}(t,(0,i.Z)({shouldForwardProp:v,label:undefined},p)),w=function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];const u=a?a.map((t=>{if("function"===typeof t&&t.__emotion_real!==t)return n=>P({styledArg:t,props:n,defaultTheme:r,themeId:e});if((0,b.P)(t)){let e,r=t;return t&&t.variants&&(e=t.variants,delete r.variants,r=r=>{let n=t;return k(r,C(e),e).forEach((t=>{n=(0,b.Z)(n,t)})),n}),r}return t})):[];let h=n;if((0,b.P)(n)){let t;n&&n.variants&&(t=n.variants,delete h.variants,h=e=>{let r=n;return k(e,C(t),t).forEach((t=>{r=(0,b.Z)(r,t)})),r})}else"function"===typeof n&&n.__emotion_real!==n&&(h=t=>P({styledArg:n,props:t,defaultTheme:r,themeId:e}));l&&f&&u.push((t=>{const n=x((0,i.Z)({},t,{defaultTheme:r,themeId:e})),s=((t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null)(l,n);if(s){const e={};return Object.entries(s).forEach((r=>{let[s,a]=r;e[s]="function"===typeof a?a((0,i.Z)({},t,{theme:n})):a})),f(t,e)}return null})),l&&!g&&u.push((t=>{const n=x((0,i.Z)({},t,{defaultTheme:r,themeId:e}));return((t,e,r,n)=>{var i;const s=null==r||null==(i=r.components)||null==(i=i[n])?void 0:i.variants;return k(t,e,s)})(t,((t,e)=>{let r=[];return e&&e.components&&e.components[t]&&e.components[t].variants&&(r=e.components[t].variants),C(r)})(l,n),n,l)})),m||u.push(o);const d=u.length-a.length;if(Array.isArray(n)&&d>0){const t=new Array(d).fill("");h=[...n,...t],h.raw=[...n.raw,...t]}const p=E(h,...u);return t.muiName&&(p.muiName=t.muiName),p};return E.withConfig&&(w.withConfig=E.withConfig),w}}({themeId:r(2951).Z,defaultTheme:N.Z,rootShouldForwardProp:t=>O(t)&&"classes"!==t}),F=M},3530:(t,e,r)=>{"use strict";r.d(e,{Z:()=>l});var n=r(7462);function i(t,e){const r=(0,n.Z)({},e);return Object.keys(t).forEach((s=>{if(s.toString().match(/^(components|slots)$/))r[s]=(0,n.Z)({},t[s],r[s]);else if(s.toString().match(/^(componentsProps|slotProps)$/)){const a=t[s]||{},o=e[s];r[s]={},o&&Object.keys(o)?a&&Object.keys(a)?(r[s]=(0,n.Z)({},o),Object.keys(a).forEach((t=>{r[s][t]=i(a[t],o[t])}))):r[s]=o:r[s]=a}else void 0===r[s]&&(r[s]=t[s])})),r}function s(t){const{theme:e,name:r,props:n}=t;return e&&e.components&&e.components[r]&&e.components[r].defaultProps?i(e.components[r].defaultProps,n):n}var a=r(6936);var o=r(6542),c=r(2951);function l(t){let{props:e,name:r}=t;return function(t){let{props:e,name:r,defaultTheme:n,themeId:i}=t,o=(0,a.Z)(n);return i&&(o=o[i]||o),s({theme:o,name:r,props:e})}({props:e,name:r,defaultTheme:o.Z,themeId:c.Z})}},4929:(t,e,r)=>{"use strict";r.d(e,{L7:()=>o,VO:()=>n,W8:()=>a,k9:()=>s});const n={xs:0,sm:600,md:900,lg:1200,xl:1536},i={keys:["xs","sm","md","lg","xl"],up:t=>"@media (min-width:".concat(n[t],"px)")};function s(t,e,r){const s=t.theme||{};if(Array.isArray(e)){const t=s.breakpoints||i;return e.reduce(((n,i,s)=>(n[t.up(t.keys[s])]=r(e[s]),n)),{})}if("object"===typeof e){const t=s.breakpoints||i;return Object.keys(e).reduce(((i,s)=>{if(-1!==Object.keys(t.values||n).indexOf(s)){i[t.up(s)]=r(e[s],s)}else{const t=s;i[t]=e[t]}return i}),{})}return r(e)}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e;return(null==(e=t.keys)?void 0:e.reduce(((e,r)=>(e[t.up(r)]={},e)),{}))||{}}function o(t,e){return t.reduce(((t,e)=>{const r=t[e];return(!r||0===Object.keys(r).length)&&delete t[e],t}),e)}},9456:(t,e,r)=>{"use strict";r.d(e,{Z:()=>f});var n=r(7462),i=r(3366),s=r(3019);const a=["values","unit","step"],o=t=>{const e=Object.keys(t).map((e=>({key:e,val:t[e]})))||[];return e.sort(((t,e)=>t.val-e.val)),e.reduce(((t,e)=>(0,n.Z)({},t,{[e.key]:e.val})),{})};const c={borderRadius:4};var l=r(6886);var u=r(3649),h=r(3232);const d=["breakpoints","palette","spacing","shape"];const f=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:e={},palette:r={},spacing:f,shape:p={}}=t,g=(0,i.Z)(t,d),m=function(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:s=5}=t,c=(0,i.Z)(t,a),l=o(e),u=Object.keys(l);function h(t){const n="number"===typeof e[t]?e[t]:t;return"@media (min-width:".concat(n).concat(r,")")}function d(t){const n="number"===typeof e[t]?e[t]:t;return"@media (max-width:".concat(n-s/100).concat(r,")")}function f(t,n){const i=u.indexOf(n);return"@media (min-width:".concat("number"===typeof e[t]?e[t]:t).concat(r,") and ")+"(max-width:".concat((-1!==i&&"number"===typeof e[u[i]]?e[u[i]]:n)-s/100).concat(r,")")}return(0,n.Z)({keys:u,values:l,up:h,down:d,between:f,only:function(t){return u.indexOf(t)+1<u.length?f(t,u[u.indexOf(t)+1]):h(t)},not:function(t){const e=u.indexOf(t);return 0===e?h(u[1]):e===u.length-1?d(u[e]):f(t,u[u.indexOf(t)+1]).replace("@media","@media not all and")},unit:r},c)}(e),v=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(t.mui)return t;const e=(0,l.hB)({spacing:t}),r=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(0===r.length?[1]:r).map((t=>{const r=e(t);return"number"===typeof r?"".concat(r,"px"):r})).join(" ")};return r.mui=!0,r}(f);let y=(0,s.Z)({breakpoints:m,direction:"ltr",components:{},palette:(0,n.Z)({mode:"light"},r),spacing:v,shape:(0,n.Z)({},c,p)},g);for(var b=arguments.length,E=new Array(b>1?b-1:0),w=1;w<b;w++)E[w-1]=arguments[w];return y=E.reduce(((t,e)=>(0,s.Z)(t,e)),y),y.unstable_sxConfig=(0,n.Z)({},h.Z,null==g?void 0:g.unstable_sxConfig),y.unstable_sx=function(t){return(0,u.Z)({sx:t,theme:this})},y}},7330:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r(3019);const i=function(t,e){return e?(0,n.Z)(t,e,{clone:!1}):t}},6886:(t,e,r)=>{"use strict";r.d(e,{hB:()=>p,eI:()=>f,NA:()=>g,e6:()=>y,o3:()=>b});var n=r(4929),i=r(6428),s=r(7330);const a={m:"margin",p:"padding"},o={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},c={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},l=function(t){const e={};return r=>(void 0===e[r]&&(e[r]=t(r)),e[r])}((t=>{if(t.length>2){if(!c[t])return[t];t=c[t]}const[e,r]=t.split(""),n=a[e],i=o[r]||"";return Array.isArray(i)?i.map((t=>n+t)):[n+i]})),u=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],h=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],d=[...u,...h];function f(t,e,r,n){var s;const a=null!=(s=(0,i.DW)(t,e,!1))?s:r;return"number"===typeof a?t=>"string"===typeof t?t:a*t:Array.isArray(a)?t=>"string"===typeof t?t:a[t]:"function"===typeof a?a:()=>{}}function p(t){return f(t,"spacing",8)}function g(t,e){if("string"===typeof e||null==e)return e;const r=t(Math.abs(e));return e>=0?r:"number"===typeof r?-r:"-".concat(r)}function m(t,e,r,i){if(-1===e.indexOf(r))return null;const s=function(t,e){return r=>t.reduce(((t,n)=>(t[n]=g(e,r),t)),{})}(l(r),i),a=t[r];return(0,n.k9)(t,a,s)}function v(t,e){const r=p(t.theme);return Object.keys(t).map((n=>m(t,e,n,r))).reduce(s.Z,{})}function y(t){return v(t,u)}function b(t){return v(t,h)}function E(t){return v(t,d)}y.propTypes={},y.filterProps=u,b.propTypes={},b.filterProps=h,E.propTypes={},E.filterProps=d},6428:(t,e,r)=>{"use strict";r.d(e,{DW:()=>s,Jq:()=>a,ZP:()=>o});var n=r(8831),i=r(4929);function s(t,e){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||"string"!==typeof e)return null;if(t&&t.vars&&r){const r="vars.".concat(e).split(".").reduce(((t,e)=>t&&t[e]?t[e]:null),t);if(null!=r)return r}return e.split(".").reduce(((t,e)=>t&&null!=t[e]?t[e]:null),t)}function a(t,e,r){let n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;return n="function"===typeof t?t(r):Array.isArray(t)?t[r]||i:s(t,r)||i,e&&(n=e(n,i,t)),n}const o=function(t){const{prop:e,cssProperty:r=t.prop,themeKey:o,transform:c}=t,l=t=>{if(null==t[e])return null;const l=t[e],u=s(t.theme,o)||{};return(0,i.k9)(t,l,(t=>{let i=a(u,c,t);return t===i&&"string"===typeof t&&(i=a(u,c,"".concat(e).concat("default"===t?"":(0,n.Z)(t)),t)),!1===r?i:{[r]:i}}))};return l.propTypes={},l.filterProps=[e],l}},3232:(t,e,r)=>{"use strict";r.d(e,{Z:()=>D});var n=r(6886),i=r(6428),s=r(7330);const a=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=e.reduce(((t,e)=>(e.filterProps.forEach((r=>{t[r]=e})),t)),{}),i=t=>Object.keys(t).reduce(((e,r)=>n[r]?(0,s.Z)(e,n[r](t)):e),{});return i.propTypes={},i.filterProps=e.reduce(((t,e)=>t.concat(e.filterProps)),[]),i};var o=r(4929);function c(t){return"number"!==typeof t?t:"".concat(t,"px solid")}const l=(0,i.ZP)({prop:"border",themeKey:"borders",transform:c}),u=(0,i.ZP)({prop:"borderTop",themeKey:"borders",transform:c}),h=(0,i.ZP)({prop:"borderRight",themeKey:"borders",transform:c}),d=(0,i.ZP)({prop:"borderBottom",themeKey:"borders",transform:c}),f=(0,i.ZP)({prop:"borderLeft",themeKey:"borders",transform:c}),p=(0,i.ZP)({prop:"borderColor",themeKey:"palette"}),g=(0,i.ZP)({prop:"borderTopColor",themeKey:"palette"}),m=(0,i.ZP)({prop:"borderRightColor",themeKey:"palette"}),v=(0,i.ZP)({prop:"borderBottomColor",themeKey:"palette"}),y=(0,i.ZP)({prop:"borderLeftColor",themeKey:"palette"}),b=t=>{if(void 0!==t.borderRadius&&null!==t.borderRadius){const e=(0,n.eI)(t.theme,"shape.borderRadius",4,"borderRadius"),r=t=>({borderRadius:(0,n.NA)(e,t)});return(0,o.k9)(t,t.borderRadius,r)}return null};b.propTypes={},b.filterProps=["borderRadius"];a(l,u,h,d,f,p,g,m,v,y,b);const E=t=>{if(void 0!==t.gap&&null!==t.gap){const e=(0,n.eI)(t.theme,"spacing",8,"gap"),r=t=>({gap:(0,n.NA)(e,t)});return(0,o.k9)(t,t.gap,r)}return null};E.propTypes={},E.filterProps=["gap"];const w=t=>{if(void 0!==t.columnGap&&null!==t.columnGap){const e=(0,n.eI)(t.theme,"spacing",8,"columnGap"),r=t=>({columnGap:(0,n.NA)(e,t)});return(0,o.k9)(t,t.columnGap,r)}return null};w.propTypes={},w.filterProps=["columnGap"];const T=t=>{if(void 0!==t.rowGap&&null!==t.rowGap){const e=(0,n.eI)(t.theme,"spacing",8,"rowGap"),r=t=>({rowGap:(0,n.NA)(e,t)});return(0,o.k9)(t,t.rowGap,r)}return null};T.propTypes={},T.filterProps=["rowGap"];a(E,w,T,(0,i.ZP)({prop:"gridColumn"}),(0,i.ZP)({prop:"gridRow"}),(0,i.ZP)({prop:"gridAutoFlow"}),(0,i.ZP)({prop:"gridAutoColumns"}),(0,i.ZP)({prop:"gridAutoRows"}),(0,i.ZP)({prop:"gridTemplateColumns"}),(0,i.ZP)({prop:"gridTemplateRows"}),(0,i.ZP)({prop:"gridTemplateAreas"}),(0,i.ZP)({prop:"gridArea"}));function S(t,e){return"grey"===e?e:t}a((0,i.ZP)({prop:"color",themeKey:"palette",transform:S}),(0,i.ZP)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:S}),(0,i.ZP)({prop:"backgroundColor",themeKey:"palette",transform:S}));function _(t){return t<=1&&0!==t?"".concat(100*t,"%"):t}const A=(0,i.ZP)({prop:"width",transform:_}),R=t=>{if(void 0!==t.maxWidth&&null!==t.maxWidth){const e=e=>{var r,n;const i=(null==(r=t.theme)||null==(r=r.breakpoints)||null==(r=r.values)?void 0:r[e])||o.VO[e];return i?"px"!==(null==(n=t.theme)||null==(n=n.breakpoints)?void 0:n.unit)?{maxWidth:"".concat(i).concat(t.theme.breakpoints.unit)}:{maxWidth:i}:{maxWidth:_(e)}};return(0,o.k9)(t,t.maxWidth,e)}return null};R.filterProps=["maxWidth"];const C=(0,i.ZP)({prop:"minWidth",transform:_}),k=(0,i.ZP)({prop:"height",transform:_}),O=(0,i.ZP)({prop:"maxHeight",transform:_}),I=(0,i.ZP)({prop:"minHeight",transform:_}),D=((0,i.ZP)({prop:"size",cssProperty:"width",transform:_}),(0,i.ZP)({prop:"size",cssProperty:"height",transform:_}),a(A,R,C,k,O,I,(0,i.ZP)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:c},borderTop:{themeKey:"borders",transform:c},borderRight:{themeKey:"borders",transform:c},borderBottom:{themeKey:"borders",transform:c},borderLeft:{themeKey:"borders",transform:c},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:b},color:{themeKey:"palette",transform:S},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:S},backgroundColor:{themeKey:"palette",transform:S},p:{style:n.o3},pt:{style:n.o3},pr:{style:n.o3},pb:{style:n.o3},pl:{style:n.o3},px:{style:n.o3},py:{style:n.o3},padding:{style:n.o3},paddingTop:{style:n.o3},paddingRight:{style:n.o3},paddingBottom:{style:n.o3},paddingLeft:{style:n.o3},paddingX:{style:n.o3},paddingY:{style:n.o3},paddingInline:{style:n.o3},paddingInlineStart:{style:n.o3},paddingInlineEnd:{style:n.o3},paddingBlock:{style:n.o3},paddingBlockStart:{style:n.o3},paddingBlockEnd:{style:n.o3},m:{style:n.e6},mt:{style:n.e6},mr:{style:n.e6},mb:{style:n.e6},ml:{style:n.e6},mx:{style:n.e6},my:{style:n.e6},margin:{style:n.e6},marginTop:{style:n.e6},marginRight:{style:n.e6},marginBottom:{style:n.e6},marginLeft:{style:n.e6},marginX:{style:n.e6},marginY:{style:n.e6},marginInline:{style:n.e6},marginInlineStart:{style:n.e6},marginInlineEnd:{style:n.e6},marginBlock:{style:n.e6},marginBlockStart:{style:n.e6},marginBlockEnd:{style:n.e6},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:E},rowGap:{style:T},columnGap:{style:w},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:_},maxWidth:{style:R},minWidth:{transform:_},height:{transform:_},maxHeight:{transform:_},minHeight:{transform:_},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},3649:(t,e,r)=>{"use strict";r.d(e,{Z:()=>l});var n=r(8831),i=r(7330),s=r(6428),a=r(4929),o=r(3232);const c=function(){function t(t,e,r,i){const o={[t]:e,theme:r},c=i[t];if(!c)return{[t]:e};const{cssProperty:l=t,themeKey:u,transform:h,style:d}=c;if(null==e)return null;if("typography"===u&&"inherit"===e)return{[t]:e};const f=(0,s.DW)(r,u)||{};if(d)return d(o);return(0,a.k9)(o,e,(e=>{let r=(0,s.Jq)(f,h,e);return e===r&&"string"===typeof e&&(r=(0,s.Jq)(f,h,"".concat(t).concat("default"===e?"":(0,n.Z)(e)),e)),!1===l?r:{[l]:r}}))}return function e(r){var n;const{sx:s,theme:c={}}=r||{};if(!s)return null;const l=null!=(n=c.unstable_sxConfig)?n:o.Z;function u(r){let n=r;if("function"===typeof r)n=r(c);else if("object"!==typeof r)return r;if(!n)return null;const s=(0,a.W8)(c.breakpoints),o=Object.keys(s);let u=s;return Object.keys(n).forEach((r=>{const s=(o=n[r],h=c,"function"===typeof o?o(h):o);var o,h;if(null!==s&&void 0!==s)if("object"===typeof s)if(l[r])u=(0,i.Z)(u,t(r,s,c,l));else{const t=(0,a.k9)({theme:c},s,(t=>({[r]:t})));!function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=e.reduce(((t,e)=>t.concat(Object.keys(e))),[]),i=new Set(n);return e.every((t=>i.size===Object.keys(t).length))}(t,s)?u=(0,i.Z)(u,t):u[r]=e({sx:s,theme:c})}else u=(0,i.Z)(u,t(r,s,c,l))})),(0,a.L7)(o,u)}return Array.isArray(s)?s.map(u):u(s)}}();c.filterProps=["sx"];const l=c},6936:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c});var n=r(9456),i=r(7313),s=r(3346);const a=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=i.useContext(s.T);return e&&(r=e,0!==Object.keys(r).length)?e:t;var r},o=(0,n.Z)();const c=function(){return a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:o)}},8831:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r(7219);function i(t){if("string"!==typeof t)throw new Error((0,n.Z)(7));return t.charAt(0).toUpperCase()+t.slice(1)}},1921:(t,e,r)=>{"use strict";function n(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const n={};return Object.keys(t).forEach((i=>{n[i]=t[i].reduce(((t,n)=>{if(n){const i=e(n);""!==i&&t.push(i),r&&r[n]&&t.push(r[n])}return t}),[]).join(" ")})),n}r.d(e,{Z:()=>n})},3019:(t,e,r)=>{"use strict";r.d(e,{P:()=>i,Z:()=>a});var n=r(7462);function i(t){return null!==t&&"object"===typeof t&&t.constructor===Object}function s(t){if(!i(t))return t;const e={};return Object.keys(t).forEach((r=>{e[r]=s(t[r])})),e}function a(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const o=r.clone?(0,n.Z)({},t):t;return i(t)&&i(e)&&Object.keys(e).forEach((n=>{"__proto__"!==n&&(i(e[n])&&n in t&&i(t[n])?o[n]=a(t[n],e[n],r):r.clone?o[n]=i(e[n])?s(e[n]):e[n]:o[n]=e[n])})),o}},7219:(t,e,r)=>{"use strict";function n(t){let e="https://mui.com/production-error/?code="+t;for(let r=1;r<arguments.length;r+=1)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}r.d(e,{Z:()=>n})},4591:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});const n=t=>t,i=(()=>{let t=n;return{configure(e){t=e},generate:e=>t(e),reset(){t=n}}})(),s={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function a(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const n=s[e];return n?"".concat(r,"-").concat(n):"".concat(i.generate(t),"-").concat(e)}},7430:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r(4591);function i(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const i={};return e.forEach((e=>{i[e]=(0,n.Z)(t,e,r)})),i}},9165:t=>{"use strict";t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(i=n;0!==i--;)if(!t(e[i],r[i]))return!1;return!0}if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(i of e.entries())if(!r.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],r.get(i[0])))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(i of e.entries())if(!r.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if((n=e.length)!=r.length)return!1;for(i=n;0!==i--;)if(e[i]!==r[i])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(s=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(i=n;0!==i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;0!==i--;){var a=s[i];if(!t(e[a],r[a]))return!1}return!0}return e!==e&&r!==r}},2342:function(t){var e;"undefined"!==typeof window&&(e=function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function s(){}function a(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,r,n,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new a(r,n||t,s),c=i?i+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],o]:t._events[c].push(o):(t._events[c]=o,t._eventsCount++),t}function c(t,e){0===--t._eventsCount?t._events=new s:delete t._events[e]}function l(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),l.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},l.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=new Array(s);n<s;n++)a[n]=r[n].fn;return a},l.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},l.prototype.emit=function(t,e,r,n,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var c,l,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,s),!0;case 6:return u.fn.call(u.context,e,r,n,s,a),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,r);break;case 4:u[l].fn.call(u[l].context,e,r,n);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},l.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},l.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},l.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return c(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||c(this,s);else{for(var o=0,l=[],u=a.length;o<u;o++)(a[o].fn!==e||n&&!a[o].once||r&&a[o].context!==r)&&l.push(a[o]);l.length?this._events[s]=1===l.length?l[0]:l:c(this,s)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&c(this,e)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,t.exports=l},"./node_modules/url-toolkit/src/url-toolkit.js":function(t,e,r){!function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,n=/^([^\/?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var i=a.parseURL(t);if(!i)throw new Error("Error trying to parse base URL.");return i.path=a.normalizePath(i.path),a.buildURLFromParts(i)}var s=a.parseURL(e);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return r.alwaysNormalize?(s.path=a.normalizePath(s.path),a.buildURLFromParts(s)):e;var o=a.parseURL(t);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var c=n.exec(o.path);o.netLoc=c[1],o.path=c[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:s.netLoc,path:null,params:s.params,query:s.query,fragment:s.fragment};if(!s.netLoc&&(l.netLoc=o.netLoc,"/"!==s.path[0]))if(s.path){var u=o.path,h=u.substring(0,u.lastIndexOf("/")+1)+s.path;l.path=a.normalizePath(h)}else l.path=o.path,s.params||(l.params=o.params,s.query||(l.query=o.query));return null===l.path&&(l.path=r.alwaysNormalize?a.normalizePath(s.path):s.path),a.buildURLFromParts(l)},parseURL:function(t){var e=r.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(i,"");t.length!==(t=t.replace(s,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=a}()},"./node_modules/webworkify-webpack/index.js":function(t,e,r){function n(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="[\\.|\\-|\\+|\\w|/|@]+",s="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+i+").*?\\)";function a(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(t,e,n){var o={};o[n]=[];var c=e.toString(),l=c.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return o;for(var u,h=l[1],d=new RegExp("(\\\\n|\\W)"+a(h)+s,"g");u=d.exec(c);)"dll-reference"!==u[3]&&o[n].push(u[3]);for(d=new RegExp("\\("+a(h)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+s,"g");u=d.exec(c);)t[u[2]]||(o[n].push(u[1]),t[u[2]]=r(u[1]).m),o[u[2]]=o[u[2]]||[],o[u[2]].push(u[4]);for(var f,p=Object.keys(o),g=0;g<p.length;g++)for(var m=0;m<o[p[g]].length;m++)f=o[p[g]][m],isNaN(1*f)||(o[p[g]][m]=1*o[p[g]][m]);return o}function c(t){return Object.keys(t).reduce((function(e,r){return e||t[r].length>0}),!1)}t.exports=function(t,e){e=e||{};var i={main:r.m},s=e.all?{main:Object.keys(i.main)}:function(t,e){for(var r={main:[e]},n={main:[]},i={main:{}};c(r);)for(var s=Object.keys(r),a=0;a<s.length;a++){var l=s[a],u=r[l].pop();if(i[l]=i[l]||{},!i[l][u]&&t[l][u]){i[l][u]=!0,n[l]=n[l]||[],n[l].push(u);for(var h=o(t,t[l][u],l),d=Object.keys(h),f=0;f<d.length;f++)r[d[f]]=r[d[f]]||[],r[d[f]]=r[d[f]].concat(h[d[f]])}}return n}(i,t),a="";Object.keys(s).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;s[t][e];)e++;s[t].push(e),i[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a=a+"var "+t+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s[t].map((function(e){return JSON.stringify(e)+": "+i[t][e].toString()})).join(",")+"});\n"})),a=a+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s.main.map((function(t){return JSON.stringify(t)+": "+i.main[t].toString()})).join(",")+"}))(self);";var l=new window.Blob([a],{type:"text/javascript"});if(e.bare)return l;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),h=new window.Worker(u);return h.objectURL=u,h}},"./src/crypt/decrypter.js":function(t,e,r){"use strict";r.r(e);var n=function(){function t(t,e){this.subtle=t,this.aesIV=e}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}(),i=function(){function t(t,e){this.subtle=t,this.key=e}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}(),s=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var e=t.prototype;return e.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),r=new Uint32Array(4),n=0;n<4;n++)r[n]=e.getUint32(4*n);return r},e.initTable=function(){var t=this.sBox,e=this.invSBox,r=this.subMix,n=r[0],i=r[1],s=r[2],a=r[3],o=this.invSubMix,c=o[0],l=o[1],u=o[2],h=o[3],d=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99,t[f]=m,e[m]=f;var v=d[f],y=d[v],b=d[y],E=257*d[m]^16843008*m;n[f]=E<<24|E>>>8,i[f]=E<<16|E>>>16,s[f]=E<<8|E>>>24,a[f]=E,E=16843009*b^65537*y^257*v^16843008*f,c[m]=E<<24|E>>>8,l[m]=E<<16|E>>>16,u[m]=E<<8|E>>>24,h[m]=E,f?(f=v^d[d[d[b^v]]],p^=d[d[p]]):f=p=1}},e.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),r=!0,n=0;n<e.length&&r;)r=e[n]===this.key[n],n++;if(!r){this.key=e;var i=this.keySize=e.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var s,a,o,c,l=this.ksRows=4*(i+6+1),u=this.keySchedule=new Uint32Array(l),h=this.invKeySchedule=new Uint32Array(l),d=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],y=p[3];for(s=0;s<l;s++)s<i?o=u[s]=e[s]:(c=o,s%i===0?(c=d[(c=c<<8|c>>>24)>>>24]<<24|d[c>>>16&255]<<16|d[c>>>8&255]<<8|d[255&c],c^=f[s/i|0]<<24):i>6&&s%i===4&&(c=d[c>>>24]<<24|d[c>>>16&255]<<16|d[c>>>8&255]<<8|d[255&c]),u[s]=o=(u[s-i]^c)>>>0);for(a=0;a<l;a++)s=l-a,c=3&a?u[s]:u[s-4],h[a]=a<4||s<=4?c:g[d[c>>>24]]^m[d[c>>>16&255]]^v[d[c>>>8&255]]^y[d[255&c]],h[a]=h[a]>>>0}},e.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},e.decrypt=function(t,e,r,n){for(var i,s,a,o,c,l,u,h,d,f,p,g,m,v,y=this.keySize+6,b=this.invKeySchedule,E=this.invSBox,w=this.invSubMix,T=w[0],S=w[1],_=w[2],A=w[3],R=this.uint8ArrayToUint32Array_(r),C=R[0],k=R[1],O=R[2],I=R[3],D=new Int32Array(t),x=new Int32Array(D.length),L=this.networkToHostOrderSwap;e<D.length;){for(d=L(D[e]),f=L(D[e+1]),p=L(D[e+2]),g=L(D[e+3]),c=d^b[0],l=g^b[1],u=p^b[2],h=f^b[3],m=4,v=1;v<y;v++)i=T[c>>>24]^S[l>>16&255]^_[u>>8&255]^A[255&h]^b[m],s=T[l>>>24]^S[u>>16&255]^_[h>>8&255]^A[255&c]^b[m+1],a=T[u>>>24]^S[h>>16&255]^_[c>>8&255]^A[255&l]^b[m+2],o=T[h>>>24]^S[c>>16&255]^_[l>>8&255]^A[255&u]^b[m+3],c=i,l=s,u=a,h=o,m+=4;i=E[c>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&h]^b[m],s=E[l>>>24]<<24^E[u>>16&255]<<16^E[h>>8&255]<<8^E[255&c]^b[m+1],a=E[u>>>24]<<24^E[h>>16&255]<<16^E[c>>8&255]<<8^E[255&l]^b[m+2],o=E[h>>>24]<<24^E[c>>16&255]<<16^E[l>>8&255]<<8^E[255&u]^b[m+3],m+=3,x[e]=L(i^C),x[e+1]=L(o^k),x[e+2]=L(a^O),x[e+3]=L(s^I),C=d,k=f,O=p,I=g,e+=4}return n?function(t){var e=t.byteLength,r=e&&new DataView(t).getUint8(e-1);return r?t.slice(0,e-r):t}(x.buffer):x.buffer},e.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}(),a=r("./src/errors.ts"),o=r("./src/utils/logger.js"),c=r("./src/events.js"),l=r("./src/utils/get-self-scope.js"),u=Object(l.getSelfScope)(),h=function(){function t(t,e,r){var n=(void 0===r?{}:r).removePKCS7Padding,i=void 0===n||n;if(this.logEnabled=!0,this.observer=t,this.config=e,this.removePKCS7Padding=i,i)try{var s=u.crypto;s&&(this.subtle=s.subtle||s.webkitSubtle)}catch(a){}this.disableWebCrypto=!this.subtle}var e=t.prototype;return e.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.decrypt=function(t,e,r,a){var c=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.logger.log("JS AES decrypt"),this.logEnabled=!1);var l=this.decryptor;l||(this.decryptor=l=new s),l.expandKey(e),a(l.decrypt(t,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(o.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==e&&(this.key=e,this.fastAesKey=new i(u,e)),this.fastAesKey.expandKey().then((function(i){new n(u,r).decrypt(t,i).catch((function(n){c.onWebCryptoError(n,t,e,r,a)})).then((function(t){a(t)}))})).catch((function(n){c.onWebCryptoError(n,t,e,r,a)}))}},e.onWebCryptoError=function(t,e,r,n,i){this.config.enableSoftwareAES?(o.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,r,n,i)):(o.logger.error("decrypting error : "+t.message),this.observer.trigger(c.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},e.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},t}();e.default=h},"./src/demux/demuxer-inline.js":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.js"),i=r("./src/errors.ts"),s=r("./src/crypt/decrypter.js"),a=r("./src/polyfills/number.js"),o=r("./src/utils/logger.js"),c=r("./src/utils/get-self-scope.js");function l(t,e){return 255===t[e]&&240===(246&t[e+1])}function u(t,e){return 1&t[e+1]?7:9}function h(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function d(t,e){return!!(e+1<t.length&&l(t,e))}function f(t,e){if(d(t,e)){var r=u(t,e);if(e+r>=t.length)return!1;var n=h(t,e);if(n<=r)return!1;var i=e+n;if(i===t.length||i+1<t.length&&l(t,i))return!0}return!1}function p(t,e,r,s,a){if(!t.samplerate){var c=function(t,e,r,s){var a,c,l,u,h,d=navigator.userAgent.toLowerCase(),f=s,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(a=1+((192&e[r+2])>>>6),!((c=(60&e[r+2])>>>2)>p.length-1))return u=(1&e[r+2])<<2,u|=(192&e[r+3])>>>6,o.logger.log("manifest codec:"+s+",ADTS data:type:"+a+",sampleingIndex:"+c+"["+p[c]+"Hz],channelConfig:"+u),/firefox/i.test(d)?c>=6?(a=5,h=new Array(4),l=c-3):(a=2,h=new Array(2),l=c):-1!==d.indexOf("android")?(a=2,h=new Array(2),l=c):(a=5,h=new Array(4),s&&(-1!==s.indexOf("mp4a.40.29")||-1!==s.indexOf("mp4a.40.5"))||!s&&c>=6?l=c-3:((s&&-1!==s.indexOf("mp4a.40.2")&&(c>=6&&1===u||/vivaldi/i.test(d))||!s&&1===u)&&(a=2,h=new Array(2)),l=c)),h[0]=a<<3,h[0]|=(14&c)>>1,h[1]|=(1&c)<<7,h[1]|=u<<3,5===a&&(h[1]|=(14&l)>>1,h[2]=(1&l)<<7,h[2]|=8,h[3]=0),{config:h,samplerate:p[c],channelCount:u,codec:"mp4a.40."+a,manifestCodec:f};t.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+c})}(e,r,s,a);t.config=c.config,t.samplerate=c.samplerate,t.channelCount=c.channelCount,t.codec=c.codec,t.manifestCodec=c.manifestCodec,o.logger.log("parsed codec:"+t.codec+",rate:"+c.samplerate+",nb channel:"+c.channelCount)}}function g(t){return 9216e4/t}function m(t,e,r,n,i){var s=function(t,e,r,n,i){var s,a,o=t.length;if(s=u(t,e),a=h(t,e),(a-=s)>0&&e+s+a<=o)return{headerLength:s,frameLength:a,stamp:r+n*i}}(e,r,n,i,g(t.samplerate));if(s){var a=s.stamp,o=s.headerLength,c=s.frameLength,l={unit:e.subarray(r+o,r+o+c),pts:a,dts:a};return t.samples.push(l),{sample:l,length:c+o}}}var v=r("./src/demux/id3.js"),y=function(){function t(t,e,r){this.observer=t,this.config=r,this.remuxer=e}var e=t.prototype;return e.resetInitSegment=function(t,e,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},e.resetTimeStamp=function(){},t.probe=function(t){if(!t)return!1;for(var e=(v.default.getID3Data(t,0)||[]).length,r=t.length;e<r;e++)if(f(t,e))return o.logger.log("ADTS sync word found !"),!0;return!1},e.append=function(t,e,r,n){for(var i=this._audioTrack,s=v.default.getID3Data(t,0)||[],c=v.default.getTimeStamp(s),l=Object(a.isFiniteNumber)(c)?90*c:9e4*e,u=0,h=l,f=t.length,g=s.length,y=[{pts:h,dts:h,data:s}];g<f-1;)if(d(t,g)&&g+5<f){p(i,this.observer,t,g,i.manifestCodec);var b=m(i,t,g,l,u);if(!b){o.logger.log("Unable to parse AAC frame");break}g+=b.length,h=b.sample.pts,u++}else v.default.isHeader(t,g)?(s=v.default.getID3Data(t,g),y.push({pts:h,dts:h,data:s}),g+=s.length):g++;this.remuxer.remux(i,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},e,r,n)},e.destroy=function(){},t}(),b=r("./src/demux/mp4demuxer.js"),E={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,r,n,i){if(!(r+24>e.length)){var s=this.parseHeader(e,r);if(s&&r+s.frameLength<=e.length){var a=n+i*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:e.subarray(r,r+s.frameLength),pts:a,dts:a};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(o),{sample:o,length:s.frameLength}}}},parseHeader:function(t,e){var r=t[e+1]>>3&3,n=t[e+1]>>1&3,i=t[e+2]>>4&15,s=t[e+2]>>2&3,a=t[e+2]>>1&1;if(1!==r&&0!==i&&15!==i&&3!==s){var o=3===r?3-n:3===n?3:4,c=1e3*E.BitratesMap[14*o+i-1],l=3===r?0:2===r?1:2,u=E.SamplingRateMap[3*l+s],h=t[e+3]>>6===3?1:2,d=E.SamplesCoefficients[r][n],f=E.BytesInSlot[n],p=8*d*f;return{sampleRate:u,channelCount:h,frameLength:parseInt(d*c/u+a,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(t,e){return 255===t[e]&&224===(224&t[e+1])&&0!==(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var r=this.parseHeader(t,e),n=4;r&&r.frameLength&&(n=r.frameLength);var i=e+n;if(i===t.length||i+1<t.length&&this.isHeaderPattern(t,i))return!0}return!1}},w=E,T=function(){function t(t){this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}var e=t.prototype;return e.loadWord=function(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,n=new Uint8Array(4),i=Math.min(4,e);if(0===i)throw new Error("no bytes available");n.set(t.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},e.skipBits=function(t){var e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,t-=(e=t>>3)>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},e.readBits=function(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;return t>32&&o.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),(e=t-e)>0&&this.bitsAvailable?r<<e|this.readBits(e):r},e.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!==(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},e.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.skipEG=function(){this.skipBits(1+this.skipLZ())},e.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},e.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},e.readBoolean=function(){return 1===this.readBits(1)},e.readUByte=function(){return this.readBits(8)},e.readUShort=function(){return this.readBits(16)},e.readUInt=function(){return this.readBits(32)},e.skipScalingList=function(t){var e,r=8,n=8;for(e=0;e<t;e++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n},e.readSPS=function(){var t,e,r,n,i,s,a,o=0,c=0,l=0,u=0,h=this.readUByte.bind(this),d=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(h(),t=h(),d(5),g(3),h(),v(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var b=f();if(3===b&&g(1),v(),v(),g(1),p())for(s=3!==b?8:12,a=0;a<s;a++)p()&&y(a<6?16:64)}v();var E=f();if(0===E)f();else if(1===E)for(g(1),m(),m(),e=f(),a=0;a<e;a++)m();v(),g(1),r=f(),n=f(),0===(i=d(1))&&g(1),g(1),p()&&(o=f(),c=f(),l=f(),u=f());var w=[1,1];if(p()&&p())switch(h()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[h()<<8|h(),h()<<8|h()]}return{width:Math.ceil(16*(r+1)-2*o-2*c),height:(2-i)*(n+1)*16-(i?2:4)*(l+u),pixelRatio:w}},e.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),S=function(){function t(t,e,r,n){this.decryptdata=r,this.discardEPB=n,this.decrypter=new s.default(t,e,{removePKCS7Padding:!1})}var e=t.prototype;return e.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},e.decryptAacSample=function(t,e,r,n){var i=t[e].unit,s=i.subarray(16,i.length-i.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length),o=this;this.decryptBuffer(a,(function(s){s=new Uint8Array(s),i.set(s,16),n||o.decryptAacSamples(t,e+1,r)}))},e.decryptAacSamples=function(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(t,e,r,n),!n)return}}},e.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e),n=0,i=32;i<=t.length-16;i+=160,n+=16)r.set(t.subarray(i,i+16),n);return r},e.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var r=0,n=32;n<=t.length-16;n+=160,r+=16)t.set(e.subarray(r,r+16),n);return t},e.decryptAvcSample=function(t,e,r,n,i,s){var a=this.discardEPB(i.data),o=this.getAvcEncryptedData(a),c=this;this.decryptBuffer(o.buffer,(function(o){i.data=c.getAvcDecryptedUnit(a,o),s||c.decryptAvcSamples(t,e,r+1,n)}))},e.decryptAvcSamples=function(t,e,r,n){for(;;e++,r=0){if(e>=t.length)return void n();for(var i=t[e].units;!(r>=i.length);r++){var s=i[r];if(!(s.data.length<=48||1!==s.type&&5!==s.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(t,e,r,n,s,a),!a)return}}}},t}(),_={video:1,audio:2,id3:3,text:4},A=function(){function t(t,e,r,n){this.observer=t,this.config=r,this.typeSupported=n,this.remuxer=e,this.sampleAes=null,this.pmtUnknownTypes={}}var e=t.prototype;return e.setDecryptData=function(t){null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?this.sampleAes=new S(this.observer,this.config,t,this.discardEPB):this.sampleAes=null},t.probe=function(e){var r=t._syncOffset(e);return!(r<0)&&(r&&o.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},t._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),r=0;r<e;){if(71===t[r]&&71===t[r+188]&&71===t[r+376])return r;r++}return-1},t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:_[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}},e.resetInitSegment=function(e,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=t.createTrack("video",i),this._audioTrack=t.createTrack("audio",i),this._id3Track=t.createTrack("id3",i),this._txtTrack=t.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=n,this._duration=i},e.resetTimeStamp=function(){},e.append=function(e,r,s,a){var c,l,u,h,d,f=e.length,p=!1;this.pmtUnknownTypes={},this.contiguous=s;var g=this.pmtParsed,m=this._avcTrack,v=this._audioTrack,y=this._id3Track,b=m.pid,E=v.pid,w=y.pid,T=this._pmtId,S=m.pesData,_=v.pesData,A=y.pesData,R=this._parsePAT,C=this._parsePMT.bind(this),k=this._parsePES,O=this._parseAVCPES.bind(this),I=this._parseAACPES.bind(this),D=this._parseMPEGPES.bind(this),x=this._parseID3PES.bind(this),L=t._syncOffset(e);for(f-=(f+L)%188,c=L;c<f;c+=188)if(71===e[c]){if(l=!!(64&e[c+1]),u=((31&e[c+1])<<8)+e[c+2],(48&e[c+3])>>4>1){if((h=c+5+e[c+4])===c+188)continue}else h=c+4;switch(u){case b:l&&(S&&(d=k(S))&&O(d,!1),S={data:[],size:0}),S&&(S.data.push(e.subarray(h,c+188)),S.size+=c+188-h);break;case E:l&&(_&&(d=k(_))&&(v.isAAC?I(d):D(d)),_={data:[],size:0}),_&&(_.data.push(e.subarray(h,c+188)),_.size+=c+188-h);break;case w:l&&(A&&(d=k(A))&&x(d),A={data:[],size:0}),A&&(A.data.push(e.subarray(h,c+188)),A.size+=c+188-h);break;case 0:l&&(h+=e[h]+1),T=this._pmtId=R(e,h);break;case T:l&&(h+=e[h]+1);var P=C(e,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=P.avc)>0&&(m.pid=b),(E=P.audio)>0&&(v.pid=E,v.isAAC=P.isAAC),(w=P.id3)>0&&(y.pid=w),p&&!g&&(o.logger.log("reparse from beginning"),p=!1,c=L-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});S&&(d=k(S))?(O(d,!0),m.pesData=null):m.pesData=S,_&&(d=k(_))?(v.isAAC?I(d):D(d),v.pesData=null):(_&&_.size&&o.logger.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=_),A&&(d=k(A))?(x(d),y.pesData=null):y.pesData=A,null==this.sampleAes?this.remuxer.remux(v,m,y,this._txtTrack,r,s,a):this.decryptAndRemux(v,m,y,this._txtTrack,r,s,a)},e.decryptAndRemux=function(t,e,r,n,i,s,a){if(t.samples&&t.isAAC){var o=this;this.sampleAes.decryptAacSamples(t.samples,0,(function(){o.decryptAndRemuxAvc(t,e,r,n,i,s,a)}))}else this.decryptAndRemuxAvc(t,e,r,n,i,s,a)},e.decryptAndRemuxAvc=function(t,e,r,n,i,s,a){if(e.samples){var o=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,(function(){o.remuxer.remux(t,e,r,n,i,s,a)}))}else this.remuxer.remux(t,e,r,n,i,s,a)},e.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},e._trackUnknownPmt=function(t,e,r){var n=this.pmtUnknownTypes[t]||0;return 0===n&&(this.pmtUnknownTypes[t]=0,e.call(o.logger,r)),this.pmtUnknownTypes[t]++,n},e._parsePMT=function(t,e,r,n){var i,s,a={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=e+3+((15&t[e+1])<<8|t[e+2])-4,e+=12+((15&t[e+10])<<8|t[e+11]);e<i;){switch(s=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!n){this._trackUnknownPmt(t[e],o.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===a.audio&&(a.audio=s);break;case 21:-1===a.id3&&(a.id3=s);break;case 219:if(!n){this._trackUnknownPmt(t[e],o.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===a.avc&&(a.avc=s);break;case 3:case 4:r?-1===a.audio&&(a.audio=s,a.isAAC=!1):this._trackUnknownPmt(t[e],o.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(t[e],o.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(t[e],o.logger.log,"Unknown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return a},e._parsePES=function(t){var e,r,n,i,s,a,c,l,u=0,h=t.data;if(!t||0===t.size)return null;for(;h[0].length<19&&h.length>1;){var d=new Uint8Array(h[0].length+h[1].length);d.set(h[0]),d.set(h[1],h[0].length),h[0]=d,h.splice(1,1)}if(1===((e=h[0])[0]<<16)+(e[1]<<8)+e[2]){if((n=(e[4]<<8)+e[5])&&n>t.size-6)return null;if(192&(r=e[7])&&(a=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,64&r?a-(c=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)>54e5&&(o.logger.warn(Math.round((a-c)/9e4)+"s delta between PTS and DTS, align them"),a=c):c=a),l=(i=e[8])+9,t.size<=l)return null;t.size-=l,s=new Uint8Array(t.size);for(var f=0,p=h.length;f<p;f++){var g=(e=h[f]).byteLength;if(l){if(l>g){l-=g;continue}e=e.subarray(l),g-=l,l=0}s.set(e,u),u+=g}return n&&(n-=i+3),{data:s,pts:a,dts:c,len:n}}return null},e.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var r=e.samples,n=r.length;if(isNaN(t.pts)){if(!n)return void e.dropped++;var i=r[n-1];t.pts=i.pts,t.dts=i.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(n||this.contiguous)?(t.id=n,r.push(t)):e.dropped++}t.debug.length&&o.logger.log(t.pts+"/"+t.dts+":"+t.debug)},e._parseAVCPES=function(t,e){var r,n,i,s=this,a=this._avcTrack,o=this._parseAVCNALu(t.data),c=this.avcSample,l=!1,u=this.pushAccesUnit.bind(this),h=function(t,e,r,n){return{key:t,pts:e,dts:r,units:[],debug:n}};t.data=null,c&&o.length&&!a.audFound&&(u(c,a),c=this.avcSample=h(!1,t.pts,t.dts,"")),o.forEach((function(e){switch(e.type){case 1:n=!0,c||(c=s.avcSample=h(!0,t.pts,t.dts,"")),c.frame=!0;var o=e.data;if(l&&o.length>4){var d=new T(o).readSliceType();2!==d&&4!==d&&7!==d&&9!==d||(c.key=!0)}break;case 5:n=!0,c||(c=s.avcSample=h(!0,t.pts,t.dts,"")),c.key=!0,c.frame=!0;break;case 6:n=!0,(r=new T(s.discardEPB(e.data))).readUByte();for(var f=0,p=0,g=!1,m=0;!g&&r.bytesAvailable>1;){f=0;do{f+=m=r.readUByte()}while(255===m);p=0;do{p+=m=r.readUByte()}while(255===m);if(4===f&&0!==r.bytesAvailable){if(g=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var y=r.readUByte(),b=31&y,E=[y,r.readUByte()];for(i=0;i<b;i++)E.push(r.readUByte()),E.push(r.readUByte()),E.push(r.readUByte());s._insertSampleInOrder(s._txtTrack.samples,{type:3,pts:t.pts,bytes:E})}}else if(5===f&&0!==r.bytesAvailable){if(g=!0,p>16){var w=[];for(i=0;i<16;i++)w.push(r.readUByte().toString(16)),3!==i&&5!==i&&7!==i&&9!==i||w.push("-");var S=p-16,_=new Uint8Array(S);for(i=0;i<S;i++)_[i]=r.readUByte();s._insertSampleInOrder(s._txtTrack.samples,{pts:t.pts,payloadType:f,uuid:w.join(""),userDataBytes:_,userData:Object(v.utf8ArrayToStr)(_.buffer)})}}else if(p<r.bytesAvailable)for(i=0;i<p;i++)r.readUByte()}break;case 7:if(n=!0,l=!0,!a.sps){var A=(r=new T(e.data)).readSPS();a.width=A.width,a.height=A.height,a.pixelRatio=A.pixelRatio,a.sps=[e.data],a.duration=s._duration;var R=e.data.subarray(1,4),C="avc1.";for(i=0;i<3;i++){var k=R[i].toString(16);k.length<2&&(k="0"+k),C+=k}a.codec=C}break;case 8:n=!0,a.pps||(a.pps=[e.data]);break;case 9:n=!1,a.audFound=!0,c&&u(c,a),c=s.avcSample=h(!1,t.pts,t.dts,"");break;case 12:n=!1;break;default:n=!1,c&&(c.debug+="unknown NAL "+e.type+" ")}c&&n&&c.units.push(e)})),e&&c&&(u(c,a),this.avcSample=null)},e._insertSampleInOrder=function(t,e){var r=t.length;if(r>0){if(e.pts>=t[r-1].pts)t.push(e);else for(var n=r-1;n>=0;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)},e._getLastNalUnit=function(){var t,e=this.avcSample;if(!e||0===e.units.length){var r=this._avcTrack.samples;e=r[r.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t},e._parseAVCNALu=function(t){var e,r,n,i,s=0,a=t.byteLength,o=this._avcTrack,c=o.naluState||0,l=c,u=[],h=-1;for(-1===c&&(h=0,i=31&t[0],c=0,s=1);s<a;)if(e=t[s++],c)if(1!==c)if(e)if(1===e){if(h>=0)n={data:t.subarray(h,s-c-1),type:i},u.push(n);else{var d=this._getLastNalUnit();if(d&&(l&&s<=4-l&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-l)),(r=s-c-1)>0)){var f=new Uint8Array(d.data.byteLength+r);f.set(d.data,0),f.set(t.subarray(0,r),d.data.byteLength),d.data=f}}s<a?(h=s,i=31&t[s],c=0):c=-1}else c=0;else c=3;else c=e?0:2;else c=e?0:1;if(h>=0&&c>=0&&(n={data:t.subarray(h,a),type:i,state:c},u.push(n)),0===u.length){var p=this._getLastNalUnit();if(p){var g=new Uint8Array(p.data.byteLength+t.byteLength);g.set(p.data,0),g.set(t,p.data.byteLength),p.data=g}}return o.naluState=c,u},e.discardEPB=function(t){for(var e,r,n=t.byteLength,i=[],s=1;s<n-2;)0===t[s]&&0===t[s+1]&&3===t[s+2]?(i.push(s+2),s+=2):s++;if(0===i.length)return t;e=n-i.length,r=new Uint8Array(e);var a=0;for(s=0;s<e;a++,s++)a===i[0]&&(a++,i.shift()),r[s]=t[a];return r},e._parseAACPES=function(t){var e,r,s,a,c,l,u,h=this._audioTrack,f=t.data,v=t.pts,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var E=new Uint8Array(y.byteLength+f.byteLength);E.set(y,0),E.set(f,y.byteLength),f=E}for(s=0,c=f.length;s<c-1&&!d(f,s);s++);if(!s||(s<c-1?(l="AAC PES did not start with ADTS header,offset:"+s,u=!1):(l="no ADTS header found in AAC PES",u=!0),o.logger.warn("parsing error:"+l),this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:u,reason:l}),!u)){if(p(h,this.observer,f,s,this.audioCodec),r=0,e=g(h.samplerate),y&&b){var w=b+e;Math.abs(w-v)>1&&(o.logger.log("AAC: align PTS for overlapping frames by "+Math.round((w-v)/90)),v=w)}for(;s<c;){if(d(f,s)){if(s+5<c){var T=m(h,f,s,v,r);if(T){s+=T.length,a=T.sample.pts,r++;continue}}break}s++}y=s<c?f.subarray(s,c):null,this.aacOverFlow=y,this.aacLastPTS=a}},e._parseMPEGPES=function(t){for(var e=t.data,r=e.length,n=0,i=0,s=t.pts;i<r;)if(w.isHeader(e,i)){var a=w.appendFrame(this._audioTrack,e,i,s,n);if(!a)break;i+=a.length,n++}else i++},e._parseID3PES=function(t){this._id3Track.samples.push(t)},t}(),R=function(){function t(t,e,r){this.observer=t,this.config=r,this.remuxer=e}var e=t.prototype;return e.resetInitSegment=function(t,e,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},e.resetTimeStamp=function(){},t.probe=function(t){var e,r,n=v.default.getID3Data(t,0);if(n&&void 0!==v.default.getTimeStamp(n))for(e=n.length,r=Math.min(t.length-1,e+100);e<r;e++)if(w.probe(t,e))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},e.append=function(t,e,r,n){for(var i=v.default.getID3Data(t,0)||[],s=v.default.getTimeStamp(i),a=void 0!==s?90*s:9e4*e,o=i.length,c=t.length,l=0,u=0,h=this._audioTrack,d=[{pts:a,dts:a,data:i}];o<c;)if(w.isHeader(t,o)){var f=w.appendFrame(h,t,o,a,l);if(!f)break;o+=f.length,u=f.sample.pts,l++}else v.default.isHeader(t,o)?(i=v.default.getID3Data(t,o),d.push({pts:u,dts:u,data:i}),o+=i.length):o++;this.remuxer.remux(h,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},e,r,n)},e.destroy=function(){},t}(),C=function(){function t(){}return t.getSilentFrame=function(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),k=Math.pow(2,32)-1,O=function(){function t(){}return t.init=function(){var e;for(e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=s,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,a,c,a,o),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,i))},t.box=function(t){for(var e,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,s=i;i--;)n+=r[i].byteLength;for((e=new Uint8Array(n))[0]=n>>24&255,e[1]=n>>16&255,e[2]=n>>8&255,e[3]=255&n,e.set(t,4),i=0,n=8;i<s;i++)e.set(r[i],n),n+=r[i].byteLength;return e},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,r){r*=e;var n=Math.floor(r/(k+1)),i=Math.floor(r%(k+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,r,n){return t.box(t.types.moof,t.mfhd(e),t.traf(n,r))},t.moov=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trak(e[r]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(t.mvex(e)))},t.mvex=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(n))},t.mvhd=function(e,r){r*=e;var n=Math.floor(r/(k+1)),i=Math.floor(r%(k+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,s)},t.sdtp=function(e){var r,n,i=e.samples||[],s=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,s[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return t.box(t.types.sdtp,s)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var r,n,i,s=[],a=[];for(r=0;r<e.sps.length;r++)i=(n=e.sps[r]).byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));for(r=0;r<e.pps.length;r++)i=(n=e.pps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));var o=t.box(t.types.avcC,new Uint8Array([1,s[3],s[4],s[5],255,224|e.sps.length].concat(s).concat([e.pps.length]).concat(a))),c=e.width,l=e.height,u=e.pixelRatio[0],h=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var r=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var r=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))},t.tkhd=function(e){var r=e.id,n=e.duration*e.timescale,i=e.width,s=e.height,a=Math.floor(n/(k+1)),o=Math.floor(n%(k+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,s>>8&255,255&s,0,0]))},t.traf=function(e,r){var n=t.sdtp(e),i=e.id,s=Math.floor(r/(k+1)),a=Math.floor(r%(k+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a])),t.trun(e,n.length+16+20+8+16+8+8),n)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,r){var n,i,s,a,o,c,l=e.samples||[],u=l.length,h=12+16*u,d=new Uint8Array(h);for(r+=8+h,d.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<u;n++)s=(i=l[n]).duration,a=i.size,o=i.flags,c=i.cts,d.set([s>>>24&255,s>>>16&255,s>>>8&255,255&s,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*n);return t.box(t.types.trun,d)},t.initSegment=function(e){t.types||t.init();var r,n=t.moov(e);return(r=new Uint8Array(t.FTYP.byteLength+n.byteLength)).set(t.FTYP),r.set(n,t.FTYP.byteLength),r},t}(),I=O;function D(t,e,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var i=t*e*r;return n?Math.round(i):i}function x(t,e){return void 0===e&&(e=!1),D(t,1e3,1/9e4,e)}function L(t,e){return void 0===e&&(e=1),D(t,9e4,1/e)}var P=L(10),N=L(.2),M=null;function F(t,e){var r;if(void 0===e)return t;for(r=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=r;return t}var U,B=function(){function t(t,e,r,n){if(this.observer=t,this.config=e,this.typeSupported=r,this.ISGenerated=!1,null===M){var i=navigator.userAgent.match(/Chrome\/(\d+)/i);M=i?parseInt(i[1]):0}}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},e.resetInitSegment=function(){this.ISGenerated=!1},e.getVideoStartPts=function(t){var e=!1,r=t.reduce((function(t,r){var n=r.pts-t;return n<-4294967296?(e=!0,F(t,r.pts)):n>0?t:r.pts}),t[0].pts);return e&&o.logger.debug("PTS rollover detected"),r},e.remux=function(t,e,r,i,s,a,c){if(this.ISGenerated||this.generateIS(t,e,s),this.ISGenerated){var l=t.samples.length,u=e.samples.length,h=s,d=s;if(l&&u){var f=this.getVideoStartPts(e.samples),p=(F(t.samples[0].pts,f)-f)/e.inputTimeScale;h+=Math.max(0,p),d+=Math.max(0,-p)}if(l){t.timescale||(o.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,s));var g,m=this.remuxAudio(t,h,a,c);u&&(m&&(g=m.endPTS-m.startPTS),e.timescale||(o.logger.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,s)),this.remuxVideo(e,d,a,g))}else if(u){var v=this.remuxVideo(e,d,a,0,c);v&&t.codec&&this.remuxEmptyAudio(t,h,a,v)}}r.samples.length&&this.remuxID3(r,s),i.samples.length&&this.remuxText(i,s),this.observer.trigger(n.default.FRAG_PARSED)},e.generateIS=function(t,e,r){var s,a,c=this.observer,l=t.samples,u=e.samples,h=this.typeSupported,d="audio/mp4",f={},p={tracks:f},g=void 0===this._initPTS;if(g&&(s=a=1/0),t.config&&l.length&&(t.timescale=t.samplerate,o.logger.log("audio sampling rate : "+t.samplerate),t.isAAC||(h.mpeg?(d="audio/mpeg",t.codec=""):h.mp3&&(t.codec="mp3")),f.audio={container:d,codec:t.codec,initSegment:!t.isAAC&&h.mpeg?new Uint8Array:I.initSegment([t]),metadata:{channelCount:t.channelCount}},g&&(s=a=l[0].pts-Math.round(t.inputTimeScale*r))),e.sps&&e.pps&&u.length){var m=e.inputTimeScale;if(e.timescale=m,f.video={container:"video/mp4",codec:e.codec,initSegment:I.initSegment([e]),metadata:{width:e.width,height:e.height}},g){var v=this.getVideoStartPts(u),y=Math.round(m*r);a=Math.min(a,F(u[0].dts,v)-y),s=Math.min(s,v-y),this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:s})}}else g&&f.audio&&this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:s});Object.keys(f).length?(c.trigger(n.default.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,g&&(this._initPTS=s,this._initDTS=a)):c.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.remuxVideo=function(t,e,r,s){var a,c,l,u,h,d=t.timescale,f=t.samples,p=[],g=f.length,m=this._initPTS,v=8,y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,E=0,w=!1,T=this.nextAvcDts;if(0!==g){r||(T=e*d-(f[0].pts-F(f[0].dts,f[0].pts)));for(var S=0;S<g;S++){var _=f[S];_.pts=F(_.pts-m,T),_.dts=F(_.dts-m,T),_.dts>_.pts&&(E=Math.max(Math.min(E,_.pts-_.dts),-1*N)),_.dts<f[S>0?S-1:S].dts&&(w=!0)}w&&f.sort((function(t,e){var r=t.dts-e.dts,n=t.pts-e.pts;return r||n||t.id-e.id})),u=f[0].dts,h=f[g-1].dts;var A=Math.round((h-u)/(g-1));if(E<0){if(E<-2*A){o.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+x(-A,!0)+" ms");for(var R=E,C=0;C<g;C++)f[C].dts=R=Math.max(R,f[C].pts-A),f[C].pts=Math.max(R,f[C].pts)}else{o.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+x(E,!0)+" ms to overcome this issue");for(var k=0;k<g;k++)f[k].dts=f[k].dts+E}u=f[0].dts,h=f[g-1].dts}if(r){var O=u-T,D=O>A;if(D||O<-1){D?o.logger.warn("AVC: "+x(O,!0)+" ms ("+O+"dts) hole between fragments detected, filling it"):o.logger.warn("AVC: "+x(-O,!0)+" ms ("+O+"dts) overlapping between fragments detected"),u=T;var L=f[0].pts-O;f[0].dts=u,f[0].pts=L,o.logger.log("Video: First PTS/DTS adjusted: "+x(L,!0)+"/"+x(u,!0)+", delta: "+x(O,!0)+" ms")}}M&&M<75&&(u=Math.max(0,u));for(var P=0,U=0,B=0;B<g;B++){for(var j=f[B],V=j.units,G=V.length,K=0,H=0;H<G;H++)K+=V[H].data.length;U+=K,P+=G,j.length=K,j.dts=Math.max(j.dts,u),j.pts=Math.max(j.pts,j.dts,0),y=Math.min(j.pts,y),b=Math.max(j.pts,b)}h=f[g-1].dts;var z=U+4*P+8;try{c=new Uint8Array(z)}catch(ht){return void this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MUX_ERROR,details:i.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating video mdat "+z})}var q=new DataView(c.buffer);q.setUint32(0,z),c.set(I.types.mdat,4);for(var W=0;W<g;W++){for(var Y,Z=f[W],X=Z.units,Q=0,$=0,J=X.length;$<J;$++){var tt=X[$],et=tt.data,rt=tt.data.byteLength;q.setUint32(v,rt),v+=4,c.set(et,v),v+=rt,Q+=4+rt}if(W<g-1)a=f[W+1].dts-Z.dts;else{var nt=this.config,it=Z.dts-f[W>0?W-1:W].dts;if(nt.stretchShortVideoTrack){var st=nt.maxBufferHole,at=Math.floor(st*d),ot=(s?y+s*d:this.nextAudioPts)-Z.pts;ot>at?((a=ot-it)<0&&(a=it),o.logger.log("It is approximately "+x(ot,!1)+" ms to the next segment; using duration "+x(a,!1)+" ms for the last video frame.")):a=it}else a=it}Y=Math.round(Z.pts-Z.dts),p.push({size:Q,duration:a,cts:Y,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Z.key?2:1,isNonSync:Z.key?0:1}})}this.nextAvcDts=h+a;var ct=t.dropped;if(t.nbNalu=0,t.dropped=0,p.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var lt=p[0].flags;lt.dependsOn=2,lt.isNonSync=0}t.samples=p,l=I.moof(t.sequenceNumber++,u,t),t.samples=[];var ut={data1:l,data2:c,startPTS:y/d,endPTS:(b+a)/d,startDTS:u/d,endDTS:this.nextAvcDts/d,type:"video",hasAudio:!1,hasVideo:!0,nb:p.length,dropped:ct};return this.observer.trigger(n.default.FRAG_PARSING_DATA,ut),ut}},e.remuxAudio=function(t,e,r,s){var a,c,l,u,h,d,f=t.inputTimeScale,p=t.timescale,g=f/p,m=(t.isAAC?1024:1152)*g,v=this._initPTS,y=!t.isAAC&&this.typeSupported.mpeg,b=y?0:8,E=t.samples,w=[],T=this.nextAudioPts;if(r|=E.length&&T&&(s&&Math.abs(e-T/f)<.1||Math.abs(E[0].pts-T-v)<20*m),E.forEach((function(t){t.pts=t.dts=F(t.pts-v,e*f)})),E=E.filter((function(t){return t.pts>=0})),0!==E.length){if(r||(T=s?Math.max(0,e*f):E[0].pts),t.isAAC)for(var S=this.config.maxAudioFramesDrift,_=0,A=T;_<E.length;){var R=E[_],k=R.pts,O=k-A;if(O<=-S*m)r||_>0?(o.logger.warn("Dropping 1 audio frame @ "+x(A,!0)/1e3+"s due to "+x(O,!0)+" ms overlap."),E.splice(_,1)):(o.logger.warn("Audio frame @ "+x(k,!0)/1e3+"s overlaps nextAudioPts by "+x(O,!0)+" ms."),A=k+m,_++);else if(O>=S*m&&O<P&&A){var D=Math.round(O/m);o.logger.warn("Injecting "+D+" audio frames @ "+x(A,!0)/1e3+"s due to "+x(O,!0)+" ms gap.");for(var L=0;L<D;L++){var N=Math.max(A,0);(c=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=R.unit.subarray()),E.splice(_,0,{unit:c,pts:N,dts:N}),A+=m,_++}R.pts=R.dts=A,A+=m,_++}else Math.abs(O),R.pts=R.dts=A,A+=m,_++}for(var M=E.length,U=0;M--;)U+=E[M].unit.byteLength;for(var B=0,j=E.length;B<j;B++){var V=E[B],G=V.unit,K=V.pts;if(void 0!==d&&a)a.duration=Math.round((K-d)/g);else{var H=K-T,z=0;if(r&&t.isAAC&&H){if(H>0&&H<P)z=Math.round((K-T)/m),o.logger.log(x(H,!0)+" ms hole between AAC samples detected,filling it"),z>0&&((c=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(c=G.subarray()),U+=z*c.length);else if(H<-12){o.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+x(T,!0)+" ms / "+x(K,!0)+" ms / "+x(-H,!0)+" ms"),U-=G.byteLength;continue}K=T}if(h=K,!(U>0))return;U+=b;try{l=new Uint8Array(U)}catch($){return void this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MUX_ERROR,details:i.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:U,reason:"fail allocating audio mdat "+U})}y||(new DataView(l.buffer).setUint32(0,U),l.set(I.types.mdat,4));for(var q=0;q<z;q++)(c=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=G.subarray()),l.set(c,b),b+=c.byteLength,a={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},w.push(a)}l.set(G,b);var W=G.byteLength;b+=W,a={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},w.push(a),d=K}var Y=0;if((M=w.length)>=2&&(Y=w[M-2].duration,a.duration=Y),M){this.nextAudioPts=T=d+g*Y,t.samples=w,u=y?new Uint8Array:I.moof(t.sequenceNumber++,h/g,t),t.samples=[];var Z=h/f,X=T/f,Q={data1:u,data2:l,startPTS:Z,endPTS:X,startDTS:Z,endDTS:X,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.observer.trigger(n.default.FRAG_PARSING_DATA,Q),Q}return null}},e.remuxEmptyAudio=function(t,e,r,n){var i=t.inputTimeScale,s=i/(t.samplerate?t.samplerate:i),a=this.nextAudioPts,c=(void 0!==a?a:n.startDTS*i)+this._initDTS,l=n.endDTS*i+this._initDTS,u=1024*s,h=Math.ceil((l-c)/u),d=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(o.logger.warn("remux empty Audio"),d){for(var f=[],p=0;p<h;p++){var g=c+p*u;f.push({unit:d,pts:g,dts:g})}t.samples=f,this.remuxAudio(t,e,r)}else o.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.remuxID3=function(t,e){var r=t.samples.length;if(r){for(var i=t.inputTimeScale,s=this._initPTS,a=this._initDTS,o=0;o<r;o++){var c=t.samples[o];c.pts=F(c.pts-s,e*i)/i,c.dts=F(c.dts-a,e*i)/i}this.observer.trigger(n.default.FRAG_PARSING_METADATA,{samples:t.samples}),t.samples=[]}},e.remuxText=function(t,e){var r=t.samples.length,i=t.inputTimeScale,s=this._initPTS;if(r){for(var a=0;a<r;a++){var o=t.samples[a];o.pts=F(o.pts-s,e*i)/i}t.samples.sort((function(t,e){return t.pts-e.pts})),this.observer.trigger(n.default.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]},t}(),j=function(){function t(t){this.observer=t}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(){},e.resetInitSegment=function(){},e.remux=function(t,e,r,i,s,a,o,c){var l=this.observer,u="";t&&(u+="audio"),e&&(u+="video"),l.trigger(n.default.FRAG_PARSING_DATA,{data1:c,startPTS:s,startDTS:s,type:u,hasAudio:!!t,hasVideo:!!e,nb:1,dropped:0}),l.trigger(n.default.FRAG_PARSED)},t}(),V=Object(c.getSelfScope)();try{U=V.performance.now.bind(V.performance)}catch(K){o.logger.debug("Unable to use Performance API on this environment"),U=V.Date.now}var G=function(){function t(t,e,r,n){this.observer=t,this.typeSupported=e,this.config=r,this.vendor=n}var e=t.prototype;return e.destroy=function(){var t=this.demuxer;t&&t.destroy()},e.push=function(t,e,r,i,a,o,c,l,u,h,d,f){var p=this;if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var g=this.decrypter;null==g&&(g=this.decrypter=new s.default(this.observer,this.config));var m=U();g.decrypt(t,e.key.buffer,e.iv.buffer,(function(t){var s=U();p.observer.trigger(n.default.FRAG_DECRYPTED,{stats:{tstart:m,tdecrypt:s}}),p.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),i,a,o,c,l,u,h,d,f)}))}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),i,a,o,c,l,u,h,d,f)},e.pushDecrypted=function(t,e,r,s,a,o,c,l,u,h,d,f){var p=this.demuxer,g=this.remuxer;if(!p||c||l){for(var m,v=this.observer,E=this.typeSupported,w=this.config,T=[{demux:A,remux:B},{demux:b.default,remux:j},{demux:y,remux:B},{demux:R,remux:B}],S=0,_=T.length;S<_&&!(m=T[S]).demux.probe(t);S++);if(!m)return void v.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});g&&g instanceof m.remux||(g=new m.remux(v,w,E,this.vendor)),p&&p instanceof m.demux||(p=new m.demux(v,g,w,E),this.probe=m.demux.probe),this.demuxer=p,this.remuxer=g}(c||l)&&(p.resetInitSegment(r,s,a,h),g.resetInitSegment()),c&&(p.resetTimeStamp(f),g.resetTimeStamp(f)),"function"===typeof p.setDecryptData&&p.setDecryptData(e),p.append(t,o,u,d)},t}();e.default=G},"./src/demux/demuxer-worker.js":function(t,e,r){"use strict";r.r(e);var n=r("./src/demux/demuxer-inline.js"),i=r("./src/events.js"),s=r("./src/utils/logger.js"),a=r("./node_modules/eventemitter3/index.js");e.default=function(t){var e=new a.EventEmitter;e.trigger=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.emit.apply(e,[t,t].concat(n))},e.off=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.removeListener.apply(e,[t].concat(n))};var r=function(e,r){t.postMessage({event:e,data:r})};t.addEventListener("message",(function(i){var a=i.data;switch(a.cmd){case"init":var o=JSON.parse(a.config);t.demuxer=new n.default(e,a.typeSupported,o,a.vendor),Object(s.enableLogs)(o.debug),r("init",null);break;case"demux":t.demuxer.push(a.data,a.decryptdata,a.initSegment,a.audioCodec,a.videoCodec,a.timeOffset,a.discontinuity,a.trackSwitch,a.contiguous,a.duration,a.accurateTimeOffset,a.defaultInitPTS)}})),e.on(i.default.FRAG_DECRYPTED,r),e.on(i.default.FRAG_PARSING_INIT_SEGMENT,r),e.on(i.default.FRAG_PARSED,r),e.on(i.default.ERROR,r),e.on(i.default.FRAG_PARSING_METADATA,r),e.on(i.default.FRAG_PARSING_USERDATA,r),e.on(i.default.INIT_PTS_FOUND,r),e.on(i.default.FRAG_PARSING_DATA,(function(e,r){var n=[],i={event:e,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),t.postMessage(i,n)}))}},"./src/demux/id3.js":function(t,e,r){"use strict";r.r(e),r.d(e,"utf8ArrayToStr",(function(){return o}));var n,i=r("./src/utils/get-self-scope.js"),s=function(){function t(){}return t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.getID3Data=function(e,r){for(var n=r,i=0;t.isHeader(e,r);)i+=10,i+=t._readSize(e,r+6),t.isFooter(e,r+10)&&(i+=10),r+=i;if(i>0)return e.subarray(n,n+i)},t._readSize=function(t,e){var r=0;return r=(127&t[e])<<21,r|=(127&t[e+1])<<14,r|=(127&t[e+2])<<7,r|=127&t[e+3]},t.getTimeStamp=function(e){for(var r=t.getID3Frames(e),n=0;n<r.length;n++){var i=r[n];if(t.isTimeStampFrame(i))return t._readTimeStamp(i)}},t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},t._getFrameData=function(e){var r=String.fromCharCode(e[0],e[1],e[2],e[3]),n=t._readSize(e,4);return{type:r,size:n,data:e.subarray(10,10+n)}},t.getID3Frames=function(e){for(var r=0,n=[];t.isHeader(e,r);){for(var i=t._readSize(e,r+6),s=(r+=10)+i;r+8<s;){var a=t._getFrameData(e.subarray(r)),o=t._decodeFrame(a);o&&n.push(o),r+=a.size+10}t.isFooter(e,r)&&(r+=10)}return n},t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):t._decodeTextFrame(e)},t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),r=1&e[3],n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},t._decodePrivFrame=function(e){if(!(e.size<2)){var r=t._utf8ArrayToStr(e.data,!0),n=new Uint8Array(e.data.subarray(r.length+1));return{key:e.type,info:r,data:n.buffer}}},t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var r=1,n=t._utf8ArrayToStr(e.data.subarray(r),!0);r+=n.length+1;var i=t._utf8ArrayToStr(e.data.subarray(r));return{key:e.type,info:n,data:i}}var s=t._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:s}}},t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var r=1,n=t._utf8ArrayToStr(e.data.subarray(r),!0);r+=n.length+1;var i=t._utf8ArrayToStr(e.data.subarray(r));return{key:e.type,info:n,data:i}}var s=t._utf8ArrayToStr(e.data);return{key:e.type,data:s}},t._utf8ArrayToStr=function(t,e){void 0===e&&(e=!1);var r=a();if(r){var n=r.decode(t);if(e){var i=n.indexOf("\0");return-1!==i?n.substring(0,i):n}return n.replace(/\0/g,"")}for(var s,o,c,l=t.length,u="",h=0;h<l;){if(0===(s=t[h++])&&e)return u;if(0!==s&&3!==s)switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(s);break;case 12:case 13:o=t[h++],u+=String.fromCharCode((31&s)<<6|63&o);break;case 14:o=t[h++],c=t[h++],u+=String.fromCharCode((15&s)<<12|(63&o)<<6|(63&c)<<0)}}return u},t}();function a(){var t=Object(i.getSelfScope)();return n||"undefined"===typeof t.TextDecoder||(n=new t.TextDecoder("utf-8")),n}var o=s._utf8ArrayToStr;e.default=s},"./src/demux/mp4demuxer.js":function(t,e,r){"use strict";r.r(e);var n=r("./src/utils/logger.js"),i=r("./src/events.js"),s=Math.pow(2,32)-1,a=function(){function t(t,e){this.observer=t,this.remuxer=e}var e=t.prototype;return e.resetTimeStamp=function(t){this.initPTS=t},e.resetInitSegment=function(e,r,n,s){if(e&&e.byteLength){var a=this.initData=t.parseInitSegment(e);null==r&&(r="mp4a.40.5"),null==n&&(n="avc1.42e01e");var o={};a.audio&&a.video?o.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:s?e:null}:(a.audio&&(o.audio={container:"audio/mp4",codec:r,initSegment:s?e:null}),a.video&&(o.video={container:"video/mp4",codec:n,initSegment:s?e:null})),this.observer.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)},t.probe=function(e){return t.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0},t.bin2str=function(t){return String.fromCharCode.apply(null,t)},t.readUint16=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<8|t[e+1];return r<0?65536+r:r},t.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return r<0?4294967296+r:r},t.writeUint32=function(t,e,r){t.data&&(e+=t.start,t=t.data),t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},t.findBox=function(e,r){var n,i,s,a,o,c,l=[];if(e.data?(o=e.start,s=e.end,e=e.data):(o=0,s=e.byteLength),!r.length)return null;for(n=o;n<s;)c=(i=t.readUint32(e,n))>1?n+i:s,t.bin2str(e.subarray(n+4,n+8))===r[0]&&(1===r.length?l.push({data:e,start:n+8,end:c}):(a=t.findBox({data:e,start:n+8,end:c},r.slice(1))).length&&(l=l.concat(a))),n=c;return l},t.parseSegmentIndex=function(e){var r,n=t.findBox(e,["moov"])[0],i=n?n.end:null,s=0,a=t.findBox(e,["sidx"]);if(!a||!a[0])return null;r=[];var o=(a=a[0]).data[0];s=0===o?8:16;var c=t.readUint32(a,s);s+=4,s+=0===o?8:16,s+=2;var l=a.end+0,u=t.readUint16(a,s);s+=2;for(var h=0;h<u;h++){var d=s,f=t.readUint32(a,d);d+=4;var p=2147483647&f;if(1===(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=t.readUint32(a,d);d+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/c,start:l,end:l+p-1}}),l+=p,s=d+=4}return{earliestPresentationTime:0,timescale:c,version:o,referencesCount:u,references:r,moovEndOffset:i}},t.parseInitSegment=function(e){var r=[];return t.findBox(e,["moov","trak"]).forEach((function(e){var i=t.findBox(e,["tkhd"])[0];if(i){var s=i.data[i.start],a=0===s?12:20,o=t.readUint32(i,a),c=t.findBox(e,["mdia","mdhd"])[0];if(c){a=0===(s=c.data[c.start])?12:20;var l=t.readUint32(c,a),u=t.findBox(e,["mdia","hdlr"])[0];if(u){var h={soun:"audio",vide:"video"}[t.bin2str(u.data.subarray(u.start+8,u.start+12))];if(h){var d=t.findBox(e,["mdia","minf","stbl","stsd"]);if(d.length){d=d[0];var f=t.bin2str(d.data.subarray(d.start+12,d.start+16));n.logger.log("MP4Demuxer:"+h+":"+f+" found")}r[o]={timescale:l,type:h},r[h]={timescale:l,id:o}}}}}})),r},t.getStartDTS=function(e,r){var n,i,s;return n=t.findBox(r,["moof","traf"]),i=[].concat.apply([],n.map((function(r){return t.findBox(r,["tfhd"]).map((function(n){var i,s,a;return i=t.readUint32(n,4),s=e[i].timescale||9e4,a=t.findBox(r,["tfdt"]).map((function(e){var r,n;return r=e.data[e.start],n=t.readUint32(e,4),1===r&&(n*=Math.pow(2,32),n+=t.readUint32(e,8)),n}))[0],a/s}))}))),s=Math.min.apply(null,i),isFinite(s)?s:0},t.offsetStartDTS=function(e,r,n){t.findBox(r,["moof","traf"]).map((function(r){return t.findBox(r,["tfhd"]).map((function(i){var a=t.readUint32(i,4),o=e[a].timescale||9e4;t.findBox(r,["tfdt"]).map((function(e){var r=e.data[e.start],i=t.readUint32(e,4);if(0===r)t.writeUint32(e,4,i-n*o);else{i*=Math.pow(2,32),i+=t.readUint32(e,8),i-=n*o,i=Math.max(i,0);var a=Math.floor(i/(s+1)),c=Math.floor(i%(s+1));t.writeUint32(e,4,a),t.writeUint32(e,8,c)}}))}))}))},e.append=function(e,r,n,s){var a=this.initData;a||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),a=this.initData);var o,c=this.initPTS;if(void 0===c){var l=t.getStartDTS(a,e);this.initPTS=c=l-r,this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:c})}t.offsetStartDTS(a,e,c),o=t.getStartDTS(a,e),this.remuxer.remux(a.audio,a.video,null,null,o,n,s,e)},e.destroy=function(){},t}();e.default=a},"./src/errors.ts":function(t,e,r){"use strict";var n,i;r.r(e),r.d(e,"ErrorTypes",(function(){return n})),r.d(e,"ErrorDetails",(function(){return i})),function(t){t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError"}(n||(n={})),function(t){t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException"}(i||(i={}))},"./src/events.js":function(t,e,r){"use strict";r.r(e),e.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return cr}));var n={};r.r(n),r.d(n,"newCue",(function(){return fe}));var i,s,a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/errors.ts"),c=r("./src/polyfills/number.js"),l=r("./src/events.js"),u=r("./src/utils/logger.js"),h={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},d=function(){function t(t){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=t,this.onEvent=this.onEvent.bind(this);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var e=t.prototype;return e.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.onHandlerDestroying=function(){},e.onHandlerDestroyed=function(){},e.isEventHandler=function(){return"object"===typeof this.handledEvents&&this.handledEvents.length&&"function"===typeof this.onEvent},e.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(t){if(h[t])throw new Error("Forbidden event-name: "+t);this.hls.on(t,this.onEvent)}),this)},e.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(t){this.hls.off(t,this.onEvent)}),this)},e.onEvent=function(t,e){this.onEventGeneric(t,e)},e.onEventGeneric=function(t,e){try{(function(t,e){var r="on"+t.replace("hls","");if("function"!==typeof this[r])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,e)}).call(this,t,e).call()}catch(r){u.logger.error("An internal error happened while handling event "+t+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:t,err:r})}},t}(),f=d;!function(t){t.MANIFEST="manifest",t.LEVEL="level",t.AUDIO_TRACK="audioTrack",t.SUBTITLE_TRACK="subtitleTrack"}(i||(i={})),function(t){t.MAIN="main",t.AUDIO="audio",t.SUBTITLE="subtitle"}(s||(s={}));var p=r("./src/demux/mp4demuxer.js");function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var m,v=function(){function t(t,e){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=t,this.reluri=e}var e,r,n;return e=t,(r=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(a.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&g(e.prototype,r),n&&g(e,n),t}();function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}!function(t){t.AUDIO="audio",t.VIDEO="video"}(m||(m={}));var b=function(){function t(){var t;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((t={})[m.AUDIO]=!1,t[m.VIDEO]=!1,t),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var e,r,n,i=t.prototype;return i.setByteRange=function(t,e){var r=t.split("@",2),n=[];1===r.length?n[0]=e?e.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},i.addElementaryStream=function(t){this._elementaryStreams[t]=!0},i.hasElementaryStream=function(t){return!0===this._elementaryStreams[t]},i.createInitializationVector=function(t){for(var e=new Uint8Array(16),r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e},i.setDecryptDataFromLevelKey=function(t,e){var r=t;return(null===t||void 0===t?void 0:t.method)&&t.uri&&!t.iv&&((r=new v(t.baseuri,t.reluri)).method=t.method,r.iv=this.createInitializationVector(e)),r},e=t,(r=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var t=this.sn;"number"!==typeof t&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&u.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),t=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(c.isFiniteNumber)(this.programDateTime))return null;var t=Object(c.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*t}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&y(e.prototype,r),n&&y(e,n),t}();function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var w=function(){function t(t){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=t,this.version=null}var e,r,n;return e=t,(r=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(c.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&E(e.prototype,r),n&&E(e,n),t}(),T=/^(\d+)x(\d+)$/,S=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,_=function(){function t(e){for(var r in"string"===typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}var e=t.prototype;return e.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var r=new Uint8Array(e.length/2),n=0;n<e.length/2;n++)r[n]=parseInt(e.slice(2*n,2*n+2),16);return r}return null},e.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.decimalFloatingPoint=function(t){return parseFloat(this[t])},e.enumeratedString=function(t){return this[t]},e.decimalResolution=function(t){var e=T.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e,r={};for(S.lastIndex=0;null!==(e=S.exec(t));){var n=e[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[e[1]]=n}return r},t}(),A={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function R(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}var C=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,k=/#EXT-X-MEDIA:(.*)/g,O=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),I=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,D=/\.(mp4|m4s|m4v|m4a)$/i,x=function(){function t(){}return t.findGroup=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.id===e)return n}},t.convertAVC1ToAVCOTI=function(t){var e,r=t.split(".");return r.length>2?(e=r.shift()+".",e+=parseInt(r.shift()).toString(16),e+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):e=t,e},t.resolve=function(t,e){return a.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var n,i=[],s={},a=!1;function o(t,e){["video","audio"].forEach((function(r){var n=t.filter((function(t){return function(t,e){var r=A[e];return!!r&&!0===r[t.slice(0,4)]}(t,r)}));if(n.length){var i=n.filter((function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)}));e[r+"Codec"]=i.length>0?i[0]:n[0],t=t.filter((function(t){return-1===n.indexOf(t)}))}})),e.unknownCodecs=t}for(C.lastIndex=0;null!=(n=C.exec(e));)if(n[1]){var c={},l=c.attrs=new _(n[1]);c.url=t.resolve(n[2],r);var u=l.decimalResolution("RESOLUTION");u&&(c.width=u.width,c.height=u.height),c.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),c.name=l.NAME,o([].concat((l.CODECS||"").split(/[ ,]+/)),c),c.videoCodec&&-1!==c.videoCodec.indexOf("avc1")&&(c.videoCodec=t.convertAVC1ToAVCOTI(c.videoCodec)),i.push(c)}else if(n[3]){var h=new _(n[3]);h["DATA-ID"]&&(a=!0,s[h["DATA-ID"]]=h)}return{levels:i,sessionData:a?s:null}},t.parseMasterPlaylistMedia=function(e,r,n,i){var s;void 0===i&&(i=[]);var a=[],o=0;for(k.lastIndex=0;null!==(s=k.exec(e));){var c=new _(s[1]);if(c.TYPE===n){var l={attrs:c,id:o++,groupId:c["GROUP-ID"],instreamId:c["INSTREAM-ID"],name:c.NAME||c.LANGUAGE,type:n,default:"YES"===c.DEFAULT,autoselect:"YES"===c.AUTOSELECT,forced:"YES"===c.FORCED,lang:c.LANGUAGE};if(c.URI&&(l.url=t.resolve(c.URI,r)),i.length){var u=t.findGroup(i,l.groupId);l.audioCodec=u?u.codec:i[0].codec}a.push(l)}}return a},t.parseLevelPlaylist=function(t,e,r,n,i){var s,a,o,l=0,h=0,d=new w(e),f=0,p=null,g=new b,m=null;for(O.lastIndex=0;null!==(s=O.exec(t));){var y=s[1];if(y){g.duration=parseFloat(y);var E=(" "+s[2]).slice(1);g.title=E||null,g.tagList.push(E?["INF",y,E]:["INF",y])}else if(s[3]){if(Object(c.isFiniteNumber)(g.duration)){var T=l++;g.type=n,g.start=h,o&&(g.levelkey=o),g.sn=T,g.level=r,g.cc=f,g.urlId=i,g.baseurl=e,g.relurl=(" "+s[3]).slice(1),L(g,p),d.fragments.push(g),p=g,h+=g.duration,g=new b}}else if(s[4]){var S=(" "+s[4]).slice(1);p?g.setByteRange(S,p):g.setByteRange(S)}else if(s[5])g.rawProgramDateTime=(" "+s[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),null===m&&(m=d.fragments.length);else{if(!(s=s[0].match(I))){u.logger.warn("No matches on slow regex match for level playlist!");continue}for(a=1;a<s.length&&"undefined"===typeof s[a];a++);var A=(" "+s[a+1]).slice(1),R=(" "+s[a+2]).slice(1);switch(s[a]){case"#":g.tagList.push(R?[A,R]:[A]);break;case"PLAYLIST-TYPE":d.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":l=d.startSN=parseInt(A);break;case"TARGETDURATION":d.targetduration=parseFloat(A);break;case"VERSION":d.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":d.live=!1;break;case"DIS":f++,g.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(A);break;case"KEY":var C=new _(A),k=C.enumeratedString("METHOD"),x=C.URI,P=C.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(C.KEYFORMAT||"identity")){u.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}k&&(o=new v(e,x),x&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(k)>=0&&(o.method=k,o.key=null,o.iv=P));break;case"START":var N=new _(A).decimalFloatingPoint("TIME-OFFSET");Object(c.isFiniteNumber)(N)&&(d.startTimeOffset=N);break;case"MAP":var M=new _(A);g.relurl=M.URI,M.BYTERANGE&&g.setByteRange(M.BYTERANGE),g.baseurl=e,g.level=r,g.type=n,g.sn="initSegment",d.initSegment=g,(g=new b).rawProgramDateTime=d.initSegment.rawProgramDateTime;break;default:u.logger.warn("line parsed but not handled: "+s)}}}return(g=p)&&!g.relurl&&(d.fragments.pop(),h-=g.duration),d.totalduration=h,d.averagetargetduration=h/d.fragments.length,d.endSN=l-1,d.startCC=d.fragments[0]?d.fragments[0].cc:0,d.endCC=f,!d.initSegment&&d.fragments.length&&d.fragments.every((function(t){return D.test(t.relurl)}))&&(u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(g=new b).relurl=d.fragments[0].relurl,g.baseurl=e,g.level=r,g.type=n,g.sn="initSegment",d.initSegment=g,d.needSidxRanges=!0),m&&function(t,e){for(var r=t[e],n=e-1;n>=0;n--){var i=t[n];i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(d.fragments,m),d},t}();function L(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):(null===e||void 0===e?void 0:e.programDateTime)&&(t.programDateTime=e.endProgramDateTime),Object(c.isFiniteNumber)(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}var P=window.performance,N=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MANIFEST_LOADING,l.default.LEVEL_LOADING,l.default.AUDIO_TRACK_LOADING,l.default.SUBTITLE_TRACK_LOADING)||this).loaders={},r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n.canHaveQualityLevels=function(t){return t!==i.AUDIO_TRACK&&t!==i.SUBTITLE_TRACK},n.mapContextToLevelType=function(t){switch(t.type){case i.AUDIO_TRACK:return s.AUDIO;case i.SUBTITLE_TRACK:return s.SUBTITLE;default:return s.MAIN}},n.getResponseUrl=function(t,e){var r=t.url;return void 0!==r&&0!==r.indexOf("data:")||(r=e.url),r};var a=n.prototype;return a.createInternalLoader=function(t){var e=this.hls.config,r=e.pLoader,n=e.loader,i=new(r||n)(e);return t.loader=i,this.loaders[t.type]=i,i},a.getInternalLoader=function(t){return this.loaders[t.type]},a.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},a.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},a.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},a.onManifestLoading=function(t){this.load({url:t.url,type:i.MANIFEST,level:0,id:null,responseType:"text"})},a.onLevelLoading=function(t){this.load({url:t.url,type:i.LEVEL,level:t.level,id:t.id,responseType:"text"})},a.onAudioTrackLoading=function(t){this.load({url:t.url,type:i.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})},a.onSubtitleTrackLoading=function(t){this.load({url:t.url,type:i.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})},a.load=function(t){var e=this.hls.config;u.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var r,n,s,a,o=this.getInternalLoader(t);if(o){var c=o.context;if(c&&c.url===t.url)return u.logger.trace("playlist request ongoing"),!1;u.logger.warn("aborting previous loader for type: "+t.type),o.abort()}switch(t.type){case i.MANIFEST:r=e.manifestLoadingMaxRetry,n=e.manifestLoadingTimeOut,s=e.manifestLoadingRetryDelay,a=e.manifestLoadingMaxRetryTimeout;break;case i.LEVEL:r=0,a=0,s=0,n=e.levelLoadingTimeOut;break;default:r=e.levelLoadingMaxRetry,n=e.levelLoadingTimeOut,s=e.levelLoadingRetryDelay,a=e.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(t);var l={timeout:n,maxRetry:r,retryDelay:s,maxRetryDelay:a},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return u.logger.debug("Calling internal loader delegate for URL: "+t.url),o.load(t,l,h),!0},a.loadsuccess=function(t,e,r,n){if(void 0===n&&(n=null),r.isSidxRequest)return this._handleSidxRequest(t,r),void this._handlePlaylistLoaded(t,e,r,n);if(this.resetInternalLoader(r.type),"string"!==typeof t.data)throw new Error('expected responseType of "text" for PlaylistLoader');var i=t.data;e.tload=P.now(),0===i.indexOf("#EXTM3U")?i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,e,r,n):this._handleMasterPlaylist(t,e,r,n):this._handleManifestParsingError(t,r,"no EXTM3U delimiter",n)},a.loaderror=function(t,e,r){void 0===r&&(r=null),this._handleNetworkError(e,r,!1,t)},a.loadtimeout=function(t,e,r){void 0===r&&(r=null),this._handleNetworkError(e,r,!0)},a._handleMasterPlaylist=function(t,e,r,i){var s=this.hls,a=t.data,o=n.getResponseUrl(t,r),c=x.parseMasterPlaylist(a,o),h=c.levels,d=c.sessionData;if(h.length){var f=h.map((function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}})),p=x.parseMasterPlaylistMedia(a,o,"AUDIO",f),g=x.parseMasterPlaylistMedia(a,o,"SUBTITLES"),m=x.parseMasterPlaylistMedia(a,o,"CLOSED-CAPTIONS");if(p.length){var v=!1;p.forEach((function(t){t.url||(v=!0)})),!1===v&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(u.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}s.trigger(l.default.MANIFEST_LOADED,{levels:h,audioTracks:p,subtitles:g,captions:m,url:o,stats:e,networkDetails:i,sessionData:d})}else this._handleManifestParsingError(t,r,"no level found in manifest",i)},a._handleTrackOrLevelPlaylist=function(t,e,r,s){var a=this.hls,u=r.id,h=r.level,d=r.type,f=n.getResponseUrl(t,r),p=Object(c.isFiniteNumber)(u)?u:0,g=Object(c.isFiniteNumber)(h)?h:p,m=n.mapContextToLevelType(r),v=x.parseLevelPlaylist(t.data,f,g,m,p);if(v.tload=e.tload,v.fragments.length){if(d===i.MANIFEST){var y={url:f,details:v};a.trigger(l.default.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:f,stats:e,networkDetails:s,sessionData:null})}if(e.tparsed=P.now(),v.needSidxRanges){var b=v.initSegment.url;this.load({url:b,isSidxRequest:!0,type:d,level:h,levelDetails:v,id:u,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=v,this._handlePlaylistLoaded(t,e,r,s)}else a.trigger(l.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:f,reason:"no fragments found in level",level:"number"===typeof r.level?r.level:void 0})},a._handleSidxRequest=function(t,e){if("string"===typeof t.data)throw new Error("sidx request must be made with responseType of array buffer");var r=p.default.parseSegmentIndex(new Uint8Array(t.data));if(r){var n=r.references,i=e.levelDetails;n.forEach((function(t,e){var r=t.info;if(i){var n=i.fragments[e];0===n.byteRange.length&&n.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}})),i&&i.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},a._handleManifestParsingError=function(t,e,r,n){this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:r,networkDetails:n})},a._handleNetworkError=function(t,e,r,n){var s,a;void 0===r&&(r=!1),void 0===n&&(n=null),u.logger.info("A network error occured while loading a "+t.type+"-type playlist");var c=this.getInternalLoader(t);switch(t.type){case i.MANIFEST:s=r?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case i.LEVEL:s=r?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case i.AUDIO_TRACK:s=r?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;default:a=!1}c&&(c.abort(),this.resetInternalLoader(t.type));var h={type:o.ErrorTypes.NETWORK_ERROR,details:s,fatal:a,url:t.url,loader:c,context:t,networkDetails:e};n&&(h.response=n),this.hls.trigger(l.default.ERROR,h)},a._handlePlaylistLoaded=function(t,e,r,s){var a=r.type,o=r.level,c=r.id,u=r.levelDetails;if(u&&u.targetduration)if(n.canHaveQualityLevels(r.type))this.hls.trigger(l.default.LEVEL_LOADED,{details:u,level:o||0,id:c||0,stats:e,networkDetails:s});else switch(a){case i.AUDIO_TRACK:this.hls.trigger(l.default.AUDIO_TRACK_LOADED,{details:u,id:c,stats:e,networkDetails:s});break;case i.SUBTITLE_TRACK:this.hls.trigger(l.default.SUBTITLE_TRACK_LOADED,{details:u,id:c,stats:e,networkDetails:s})}else this._handleManifestParsingError(t,r,"invalid target duration",s)},n}(f),M=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.FRAG_LOADING)||this).loaders={},r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){var e=this.loaders;for(var r in e){var n=e[r];n&&n.destroy()}this.loaders={},t.prototype.destroy.call(this)},i.onFragLoading=function(t){var e=t.frag,r=e.type,n=this.loaders,i=this.hls.config,s=i.fLoader,a=i.loader;e.loaded=0;var o,l,h,d=n[r];d&&(u.logger.warn("abort previous fragment loader for type: "+r),d.abort()),d=n[r]=e.loader=i.fLoader?new s(i):new a(i),o={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var f=e.byteRangeStartOffset,p=e.byteRangeEndOffset;Object(c.isFiniteNumber)(f)&&Object(c.isFiniteNumber)(p)&&(o.rangeStart=f,o.rangeEnd=p),l={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},d.load(o,l,h)},i.loadsuccess=function(t,e,r,n){void 0===n&&(n=null);var i=t.data,s=r.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(l.default.FRAG_LOADED,{payload:i,frag:s,stats:e,networkDetails:n})},i.loaderror=function(t,e,r){void 0===r&&(r=null);var n=e.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:r})},i.loadtimeout=function(t,e,r){void 0===r&&(r=null);var n=e.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:r})},i.loadprogress=function(t,e,r,n){void 0===n&&(n=null);var i=e.frag;i.loaded=t.loaded,this.hls.trigger(l.default.FRAG_LOAD_PROGRESS,{frag:i,stats:t,networkDetails:n})},n}(f),F=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){for(var e in this.loaders){var r=this.loaders[e];r&&r.destroy()}this.loaders={},t.prototype.destroy.call(this)},i.onKeyLoading=function(t){var e=t.frag,r=e.type,n=this.loaders[r];if(e.decryptdata){var i=e.decryptdata.uri;if(i!==this.decrypturl||null===this.decryptkey){var s=this.hls.config;if(n&&(u.logger.warn("abort previous key loader for type:"+r),n.abort()),!i)return void u.logger.warn("key uri is falsy");e.loader=this.loaders[r]=new s.loader(s),this.decrypturl=i,this.decryptkey=null;var a={url:i,frag:e,responseType:"arraybuffer"},o={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};e.loader.load(a,o,c)}else this.decryptkey&&(e.decryptdata.key=this.decryptkey,this.hls.trigger(l.default.KEY_LOADED,{frag:e}))}else u.logger.warn("Missing decryption data on fragment in onKeyLoading")},i.loadsuccess=function(t,e,r){var n=r.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(t.data),n.loader=void 0,delete this.loaders[n.type],this.hls.trigger(l.default.KEY_LOADED,{frag:n})):u.logger.error("after key load, decryptdata unset")},i.loaderror=function(t,e){var r=e.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:t})},i.loadtimeout=function(t,e){var r=e.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},n}(f),U="NOT_LOADED",B="APPENDING",j="PARTIAL",V="OK",G=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.BUFFER_APPENDED,l.default.FRAG_BUFFERED,l.default.FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=e.config,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,f.prototype.destroy.call(this),t.prototype.destroy.call(this)},i.getBufferedFrag=function(t,e){var r=this.fragments,n=Object.keys(r).filter((function(n){var i=r[n];if(i.body.type!==e)return!1;if(!i.buffered)return!1;var s=i.body;return s.startPTS<=t&&t<=s.endPTS}));if(0===n.length)return null;var i=n.pop();return r[i].body},i.detectEvictedFragments=function(t,e){var r=this;Object.keys(this.fragments).forEach((function(n){var i=r.fragments[n];if(i&&i.buffered){var s=i.range[t];if(s)for(var a=s.time,o=0;o<a.length;o++){var c=a[o];if(!r.isTimeBuffered(c.startPTS,c.endPTS,e)){r.removeFragment(i.body);break}}}}))},i.detectPartialFragments=function(t){var e=this,r=this.getFragmentKey(t),n=this.fragments[r];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach((function(r){if(t.hasElementaryStream(r)){var i=e.timeRanges[r];n.range[r]=e.getBufferedTimes(t.startPTS,t.endPTS,i)}})))},i.getBufferedTimes=function(t,e,r){for(var n,i,s=[],a=!1,o=0;o<r.length;o++){if(n=r.start(o)-this.bufferPadding,i=r.end(o)+this.bufferPadding,t>=n&&e<=i){s.push({startPTS:Math.max(t,r.start(o)),endPTS:Math.min(e,r.end(o))});break}if(t<i&&e>n)s.push({startPTS:Math.max(t,r.start(o)),endPTS:Math.min(e,r.end(o))}),a=!0;else if(e<=n)break}return{time:s,partial:a}},i.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn},i.getPartialFragment=function(t){var e,r,n,i=this,s=null,a=0;return Object.keys(this.fragments).forEach((function(o){var c=i.fragments[o];i.isPartial(c)&&(r=c.body.startPTS-i.bufferPadding,n=c.body.endPTS+i.bufferPadding,t>=r&&t<=n&&(e=Math.min(t-r,n-t),a<=e&&(s=c.body,a=e)))})),s},i.getState=function(t){var e=this.getFragmentKey(t),r=this.fragments[e],n=U;return void 0!==r&&(n=r.buffered?!0===this.isPartial(r)?j:V:B),n},i.isPartial=function(t){return!0===t.buffered&&(void 0!==t.range.video&&!0===t.range.video.partial||void 0!==t.range.audio&&!0===t.range.audio.partial)},i.isTimeBuffered=function(t,e,r){for(var n,i,s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,i=r.end(s)+this.bufferPadding,t>=n&&e<=i)return!0;if(e<=n)return!1}return!1},i.onFragLoaded=function(t){var e=t.frag;Object(c.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.fragments[this.getFragmentKey(e)]={body:e,range:Object.create(null),buffered:!1})},i.onBufferAppended=function(t){var e=this;this.timeRanges=t.timeRanges,Object.keys(this.timeRanges).forEach((function(t){var r=e.timeRanges[t];e.detectEvictedFragments(t,r)}))},i.onFragBuffered=function(t){this.detectPartialFragments(t.frag)},i.hasFragment=function(t){var e=this.getFragmentKey(t);return void 0!==this.fragments[e]},i.removeFragment=function(t){var e=this.getFragmentKey(t);delete this.fragments[e]},i.removeAllFragments=function(){this.fragments=Object.create(null)},n}(f),K={search:function(t,e){for(var r=0,n=t.length-1,i=null,s=null;r<=n;){var a=e(s=t[i=(r+n)/2|0]);if(a>0)r=i+1;else{if(!(a<0))return s;n=i-1}}return null}},H=function(){function t(){}return t.isBuffered=function(t,e){try{if(t)for(var r=t.buffered,n=0;n<r.length;n++)if(e>=r.start(n)&&e<=r.end(n))return!0}catch(i){}return!1},t.bufferInfo=function(t,e,r){try{if(t){var n,i=t.buffered,s=[];for(n=0;n<i.length;n++)s.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(s,e,r)}}catch(a){}return{len:0,start:e,end:e,nextStart:void 0}},t.bufferedInfo=function(t,e,r){t.sort((function(t,e){var r=t.start-e.start;return r||e.end-t.end}));var n=[];if(r)for(var i=0;i<t.length;i++){var s=n.length;if(s){var a=n[s-1].end;t[i].start-a<r?t[i].end>a&&(n[s-1].end=t[i].end):n.push(t[i])}else n.push(t[i])}else n=t;for(var o,c=0,l=e,u=e,h=0;h<n.length;h++){var d=n[h].start,f=n[h].end;if(e+r>=d&&e<f)l=d,c=(u=f)-e;else if(e+r<d){o=d;break}}return{len:c,start:l,end:u,nextStart:o}},t}(),z=r("./node_modules/eventemitter3/index.js"),q=r("./node_modules/webworkify-webpack/index.js"),W=r("./src/demux/demuxer-inline.js");function Y(){return window.MediaSource||window.WebKitMediaSource}var Z=r("./src/utils/get-self-scope.js"),X=function(t){var e,r;function n(){return t.apply(this,arguments)||this}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n.prototype.trigger=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.emit.apply(this,[t,t].concat(r))},n}(z.EventEmitter),Q=Object(Z.getSelfScope)(),$=Y()||{isTypeSupported:function(){return!1}},J=function(){function t(t,e){var r=this;this.hls=t,this.id=e;var n=this.observer=new X,i=t.config,s=function(e,n){(n=n||{}).frag=r.frag,n.id=r.id,t.trigger(e,n)};n.on(l.default.FRAG_DECRYPTED,s),n.on(l.default.FRAG_PARSING_INIT_SEGMENT,s),n.on(l.default.FRAG_PARSING_DATA,s),n.on(l.default.FRAG_PARSED,s),n.on(l.default.ERROR,s),n.on(l.default.FRAG_PARSING_METADATA,s),n.on(l.default.FRAG_PARSING_USERDATA,s),n.on(l.default.INIT_PTS_FOUND,s);var a={mp4:$.isTypeSupported("video/mp4"),mpeg:$.isTypeSupported("audio/mpeg"),mp3:$.isTypeSupported('audio/mp4; codecs="mp3"')},c=navigator.vendor;if(i.enableWorker&&"undefined"!==typeof Worker){var h;u.logger.log("demuxing in webworker");try{h=this.w=q("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),h.addEventListener("message",this.onwmsg),h.onerror=function(e){t.trigger(l.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},h.postMessage({cmd:"init",typeSupported:a,vendor:c,id:e,config:JSON.stringify(i)})}catch(d){u.logger.warn("Error in worker:",d),u.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),h&&Q.URL.revokeObjectURL(h.objectURL),this.demuxer=new W.default(n,a,i,c),this.w=void 0}}else this.demuxer=new W.default(n,a,i,c)}var e=t.prototype;return e.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},e.push=function(t,e,r,n,i,s,a,o){var l=this.w,h=Object(c.isFiniteNumber)(i.startPTS)?i.startPTS:i.start,d=i.decryptdata,f=this.frag,p=!(f&&i.cc===f.cc),g=!(f&&i.level===f.level),m=f&&i.sn===f.sn+1,v=!g&&m;if(p&&u.logger.log(this.id+":discontinuity detected"),g&&u.logger.log(this.id+":switch detected"),this.frag=i,l)l.postMessage({cmd:"demux",data:t,decryptdata:d,initSegment:e,audioCodec:r,videoCodec:n,timeOffset:h,discontinuity:p,trackSwitch:g,contiguous:v,duration:s,accurateTimeOffset:a,defaultInitPTS:o},t instanceof ArrayBuffer?[t]:[]);else{var y=this.demuxer;y&&y.push(t,d,e,r,n,h,p,g,v,s,a,o)}},e.onWorkerMessage=function(t){var e=t.data,r=this.hls;switch(e.event){case"init":Q.URL.revokeObjectURL(this.w.objectURL);break;case l.default.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}},t}();function tt(t,e,r){switch(e){case"audio":t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds.push(r);break;case"text":t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds.push(r)}}function et(t,e,r){var n=t[e],i=t[r],s=i.startPTS;if(Object(c.isFiniteNumber)(s))r>e?(n.duration=s-n.start,n.duration<0&&u.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(i.duration=n.start-s,i.duration<0&&u.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"));else if(r>e){var a=n.cc===i.cc;i.start=n.start+(a&&n.minEndPTS?n.minEndPTS-n.start:n.duration)}else i.start=Math.max(n.start-i.duration,0)}function rt(t,e,r,n,i,s){var a=r,o=n;if(Object(c.isFiniteNumber)(e.startPTS)){var l=Math.abs(e.startPTS-r);Object(c.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(l,e.deltaPTS):e.deltaPTS=l,a=Math.max(r,e.startPTS),r=Math.min(r,e.startPTS),o=Math.min(n,e.endPTS),n=Math.max(n,e.endPTS),i=Math.min(i,e.startDTS),s=Math.max(s,e.endDTS)}var u=r-e.start;e.start=e.startPTS=r,e.maxStartPTS=a,e.endPTS=n,e.minEndPTS=o,e.startDTS=i,e.endDTS=s,e.duration=n-r;var h,d,f,p=e.sn;if(!t||p<t.startSN||p>t.endSN)return 0;for(h=p-t.startSN,(d=t.fragments)[h]=e,f=h;f>0;f--)et(d,f,f-1);for(f=h;f<d.length-1;f++)et(d,f,f+1);return t.PTSKnown=!0,u}function nt(t,e){e.initSegment&&t.initSegment&&(e.initSegment=t.initSegment);var r,n=0;if(it(t,e,(function(t,i){n=t.cc-i.cc,Object(c.isFiniteNumber)(t.startPTS)&&(i.start=i.startPTS=t.startPTS,i.endPTS=t.endPTS,i.duration=t.duration,i.backtracked=t.backtracked,i.dropped=t.dropped,r=i),e.PTSKnown=!0})),e.PTSKnown){if(n){u.logger.log("discontinuity sliding from playlist, take drift into account");for(var i=e.fragments,s=0;s<i.length;s++)i[s].cc+=n}r?rt(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(t,e){var r=e.startSN-t.startSN,n=t.fragments,i=e.fragments;if(!(r<0||r>n.length))for(var s=0;s<i.length;s++)i[s].start+=n[r].start}(t,e),e.PTSKnown=t.PTSKnown}}function it(t,e,r){if(t&&e)for(var n=Math.max(t.startSN,e.startSN)-e.startSN,i=Math.min(t.endSN,e.endSN)-e.startSN,s=e.startSN-t.startSN,a=n;a<=i;a++){var o=t.fragments[s+a],c=e.fragments[a];if(!o||!c)break;r(o,c,a)}}function st(t,e,r){var n=1e3*(e.averagetargetduration?e.averagetargetduration:e.targetduration),i=n/2;return t&&e.endSN===t.endSN&&(n=i),r&&(n=Math.max(i,n-(window.performance.now()-r))),Math.round(n)}var at={toString:function(t){for(var e="",r=t.length,n=0;n<r;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e}};function ot(t,e){e.fragments.forEach((function(e){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}})),e.PTSKnown=!0}function ct(t,e,r){!function(t,e,r){if(function(t,e,r){var n=!1;return e&&e.details&&r&&(r.endCC>r.startCC||t&&t.cc<r.startCC)&&(n=!0),n}(t,r,e)){var n=function(t,e){var r=t.fragments,n=e.fragments;if(n.length&&r.length){var i=function(t,e){for(var r=null,n=0;n<t.length;n+=1){var i=t[n];if(i&&i.cc===e){r=i;break}}return r}(r,n[0].cc);if(i&&(!i||i.startPTS))return i;u.logger.log("No frag in previous level to align on")}else u.logger.log("No fragments to align")}(r.details,e);n&&(u.logger.log("Adjusting PTS using last level due to CC increase within current level"),ot(n.start,e))}}(t,r,e),!r.PTSKnown&&e&&function(t,e){if(e&&e.fragments.length){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;var r=e.fragments[0].programDateTime,n=(t.fragments[0].programDateTime-r)/1e3+e.fragments[0].start;Object(c.isFiniteNumber)(n)&&(u.logger.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),ot(n,t))}}(r,e.details)}function lt(t,e,r){if(null===e||!Array.isArray(t)||!t.length||!Object(c.isFiniteNumber)(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;r=r||0;for(var n=0;n<t.length;++n){var i=t[n];if(dt(e,r,i))return i}return null}function ut(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=null;if(t?i=e[t.sn-e[0].sn+1]:0===r&&0===e[0].start&&(i=e[0]),i&&0===ht(r,n,i))return i;var s=K.search(e,ht.bind(null,r,n));return s||i}function ht(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0);var n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=t?1:r.start-n>t&&r.start?-1:0}function dt(t,e,r){var n=1e3*Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>t}var ft=function(){function t(t,e,r,n){this.config=t,this.media=e,this.fragmentTracker=r,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var e=t.prototype;return e.poll=function(t){var e=this.config,r=this.media,n=this.stalled,i=r.currentTime,s=r.seeking,a=this.seeking&&!s,o=!this.seeking&&s;if(this.seeking=s,i===t){if((o||a)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var c=H.bufferInfo(r,i,0),l=c.len>0,h=c.nextStart||0;if(l||h){if(s){var d=c.len>2,f=!h||h-i>2&&!this.fragmentTracker.getPartialFragment(i);if(d||f)return;this.moved=!1}if(!this.moved&&this.stalled){var p=Math.max(h,c.start||0)-i;if(p>0&&p<=2)return void this._trySkipBufferHole(null)}var g=self.performance.now();if(null!==n){var m=g-n;!s&&m>=250&&this._reportStall(c.len);var v=H.bufferInfo(r,i,e.maxBufferHole);this._tryFixBufferStall(v,m)}else this.stalled=g}}}else if(this.moved=!0,null!==n){if(this.stallReported){var y=self.performance.now()-n;u.logger.warn("playback not stuck anymore @"+i+", after "+Math.round(y)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},e._tryFixBufferStall=function(t,e){var r=this.config,n=this.fragmentTracker,i=this.media.currentTime,s=n.getPartialFragment(i);s&&this._trySkipBufferHole(s)||t.len>r.maxBufferHole&&e>1e3*r.highBufferWatchdogPeriod&&(u.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},e._reportStall=function(t){var e=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,u.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+t+")"),e.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:t}))},e._trySkipBufferHole=function(t){for(var e=this.config,r=this.hls,n=this.media,i=n.currentTime,s=0,a=0;a<n.buffered.length;a++){var c=n.buffered.start(a);if(i+e.maxBufferHole>=s&&i<c){var h=Math.max(c+.05,n.currentTime+.1);return u.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+h),this.moved=!0,this.stalled=null,n.currentTime=h,t&&r.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+h,frag:t}),h}s=n.buffered.end(a)}return 0},e._tryNudgeBuffer=function(){var t=this.config,e=this.hls,r=this.media,n=r.currentTime,i=(this.nudgeRetry||0)+1;if(this.nudgeRetry=i,i<t.nudgeMaxRetry){var s=n+i*t.nudgeOffset;u.logger.warn("Nudging 'currentTime' from "+n+" to "+s),r.currentTime=s,e.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else u.logger.error("Playhead still not moving while enough data buffered @"+n+" after "+t.nudgeMaxRetry+" nudges"),e.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},t}(),pt=function(t){var e,r;function n(e){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return(r=t.call.apply(t,[this,e].concat(i))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},i.hasInterval=function(){return!!this._tickInterval},i.hasNextTick=function(){return!!this._tickTimer},i.setInterval=function(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)},i.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},i.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},i.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},i.doTick=function(){},n}(f),gt="STOPPED",mt="STARTING",vt="IDLE",yt="PAUSED",bt="KEY_LOADING",Et="FRAG_LOADING",wt="FRAG_LOADING_WAITING_RETRY",Tt="WAITING_TRACK",St="PARSING",_t="PARSED",At="BUFFER_FLUSHING",Rt="ENDED",Ct="ERROR",kt="WAITING_INIT_PTS",Ot="WAITING_LEVEL",It=function(t){var e,r;function n(){return t.apply(this,arguments)||this}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.doTick=function(){},i.startLoad=function(){},i.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=gt},i._streamEnded=function(t,e){var r=this.fragCurrent,n=this.fragmentTracker;if(!e.live&&r&&!r.backtracked&&r.sn===e.endSN&&!t.nextStart){var i=n.getState(r);return i===j||i===V}return!1},i.onMediaSeeking=function(){var t=this.config,e=this.media,r=this.mediaBuffer,n=this.state,i=e?e.currentTime:null,s=H.bufferInfo(r||e,i,this.config.maxBufferHole);if(u.logger.log("media seeking to "+(Object(c.isFiniteNumber)(i)?i.toFixed(3):i)),n===Et){var a=this.fragCurrent;if(0===s.len&&a){var o=t.maxFragLookUpTolerance,l=a.start-o,h=a.start+a.duration+o;i<l||i>h?(a.loader&&(u.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=vt):u.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else n===Rt&&(0===s.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=vt);e&&(this.lastCurrentTime=i),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=i),this.tick()},i.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},i.onHandlerDestroying=function(){this.stopLoad(),t.prototype.onHandlerDestroying.call(this)},i.onHandlerDestroyed=function(){this.state=gt,this.fragmentTracker=null},i.computeLivePosition=function(t,e){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-r)},n}(pt);function Dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var xt,Lt=function(t){var e,r;function n(e,r){var n;return(n=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.MANIFEST_LOADING,l.default.MANIFEST_PARSED,l.default.LEVEL_LOADED,l.default.LEVELS_UPDATED,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.FRAG_LOAD_EMERGENCY_ABORTED,l.default.FRAG_PARSING_INIT_SEGMENT,l.default.FRAG_PARSING_DATA,l.default.FRAG_PARSED,l.default.ERROR,l.default.AUDIO_TRACK_SWITCHING,l.default.AUDIO_TRACK_SWITCHED,l.default.BUFFER_CREATED,l.default.BUFFER_APPENDED,l.default.BUFFER_FLUSHED)||this).fragmentTracker=r,n.config=e.config,n.audioCodecSwap=!1,n._state=gt,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n.audioOnly=!1,n.bitrateTest=!1,n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,a,h,d=n.prototype;return d.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(r.config.testBandwidth?(n=0,this.bitrateTest=!0):n=r.nextAutoLevel),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}e>0&&-1===t&&(u.logger.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=vt,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=gt},d.stopLoad=function(){this.forceStartLoad=!1,t.prototype.stopLoad.call(this)},d.doTick=function(){switch(this.state){case At:this.fragLoadError=0;break;case vt:this._doTickIdle();break;case Ot:var t=this.levels[this.level];t&&t.details&&(this.state=vt);break;case wt:var e=window.performance.now(),r=this.retryDate;(!r||e>=r||this.media&&this.media.seeking)&&(u.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=vt)}this._checkBuffer(),this._checkFragmentChanged()},d._doTickIdle=function(){var t=this.hls,e=t.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&e.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var n;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=t.nextLoadLevel,s=this.levels[i];if(s){var a,o=s.bitrate;a=o?Math.max(8*e.maxBufferSize/o,e.maxBufferLength):e.maxBufferLength,a=Math.min(a,e.maxMaxBufferLength);var c=n<e.maxBufferHole?Math.max(2,e.maxBufferHole):e.maxBufferHole,h=H.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,c),d=h.len;if(!(d>=a)){u.logger.trace("buffer length of "+d.toFixed(3)+" is below max of "+a.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=i;var f=s.details;if(!f||f.live&&this.levelLastLoaded!==i)this.state=Ot;else{if(this._streamEnded(h,f)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(l.default.BUFFER_EOS,p),void(this.state=Rt)}this._fetchPayloadOrEos(n,h,f)}}}}},d._fetchPayloadOrEos=function(t,e,r){var n=this.fragPrevious,i=(this.level,r.fragments),s=i.length;if(0!==s){var a,o=i[0].start,c=i[s-1].start+i[s-1].duration,l=e.end;if(r.initSegment&&!r.initSegment.data)a=r.initSegment;else if(r.live){var h=this.config.initialLiveManifestSize;if(s<h)return void u.logger.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+h);if(null===(a=this._ensureFragmentAtLivePoint(r,l,o,c,n,i)))return}else l<o&&(a=i[0]);a||(a=this._findFragment(o,n,s,i,l,c,r)),a&&(a.encrypted?this._loadKey(a,r):this._loadFragment(a,r,t,l))}},d._ensureFragmentAtLivePoint=function(t,e,r,n,i,s){var a,o=this.hls.config,l=this.media,h=1/0;if(void 0!==o.liveMaxLatencyDuration?h=o.liveMaxLatencyDuration:Object(c.isFiniteNumber)(o.liveMaxLatencyDurationCount)&&(h=o.liveMaxLatencyDurationCount*t.targetduration),e<Math.max(r-o.maxFragLookUpTolerance,n-h)){var d=this.liveSyncPosition=this.computeLivePosition(r,t);e=d,l&&!l.paused&&l.readyState&&l.duration>d&&d>l.currentTime&&(u.logger.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+d.toFixed(3)),l.currentTime=d),this.nextLoadPosition=d}if(t.PTSKnown&&e>n&&l&&l.readyState)return null;if(this.startFragRequested&&!t.PTSKnown&&i)if(t.hasProgramDateTime)u.logger.log("live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),a=lt(s,i.endProgramDateTime,o.maxFragLookUpTolerance);else{var f=i.sn+1;if(f>=t.startSN&&f<=t.endSN){var p=s[f-t.startSN];i.cc===p.cc&&(a=p,u.logger.log("live playlist, switching playlist, load frag with next SN: "+a.sn))}a||(a=K.search(s,(function(t){return i.cc-t.cc})))&&u.logger.log("live playlist, switching playlist, load frag with same CC: "+a.sn)}return a},d._findFragment=function(t,e,r,n,i,s,a){var o,c=this.hls.config;if(o=i<s?ut(e,n,i,i>s-c.maxFragLookUpTolerance?0:c.maxFragLookUpTolerance):n[r-1]){var l=o.sn-a.startSN,h=e&&o.level===e.level,d=n[l-1],f=n[l+1];if(e&&o.sn===e.sn)if(h&&!o.backtracked)if(o.sn<a.endSN){var p=e.deltaPTS;p&&p>c.maxBufferHole&&e.dropped&&l?(o=d,u.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=f,this.fragmentTracker.getState(o)!==V&&u.logger.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(f&&f.backtracked?(u.logger.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+f.sn),o=f):(u.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,d?(o=d).backtracked=!0:l&&(o=null)))}return o},d._loadKey=function(t,e){u.logger.log("Loading key for "+t.sn+" of ["+e.startSN+"-"+e.endSN+"], level "+this.level),this.state=bt,this.hls.trigger(l.default.KEY_LOADING,{frag:t})},d._loadFragment=function(t,e,r,n){var i=this.fragmentTracker.getState(t);this.fragCurrent=t,"initSegment"!==t.sn&&(this.startFragRequested=!0),Object(c.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||i===U||i===j?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,u.logger.log("Loading "+t.sn+" of ["+e.startSN+"-"+e.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(r.toFixed(3))+", bufferEnd: "+parseFloat(n.toFixed(3))),this.hls.trigger(l.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new J(this.hls,"main")),this.state=Et):i===B&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},d.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,s.MAIN)},d.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},d._checkFragmentChanged=function(){var t,e,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((e=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=e),H.isBuffered(r,e)?t=this.getBufferedFrag(e):H.isBuffered(r,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var n=t;if(n!==this.fragPlaying){this.hls.trigger(l.default.FRAG_CHANGED,{frag:n});var i=n.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(l.default.LEVEL_SWITCHED,{level:i}),this.fragPlaying=n}}},d.immediateLevelSwitch=function(){if(u.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t,e=this.media;e?(t=e.paused)||e.pause():t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},d.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,t.currentTime>0&&H.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},d.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e,r=this.getBufferedFrag(t.currentTime);if(r&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)e=0;else{var n=this.hls.nextLoadLevel,i=this.levels[n],s=this.fragLastKbps;e=s&&this.fragCurrent?this.fragCurrent.duration*i.bitrate/(1e3*s)+1:0}var a=this.getBufferedFrag(t.currentTime+e);if(a){var o=this.followingBufferedFrag(a);if(o){var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null;var l=Math.max(a.endPTS,o.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,o.duration));this.flushMainBuffer(l,Number.POSITIVE_INFINITY)}}}},d.flushMainBuffer=function(t,e){this.state=At;var r={startOffset:t,endOffset:e};this.altAudio&&(r.type="video"),this.hls.trigger(l.default.BUFFER_FLUSHING,r)},d.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new ft(r,e,this.fragmentTracker,this.hls)},d.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(u.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach((function(t){t.details&&t.details.fragments.forEach((function(t){t.backtracked=void 0}))})),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},d.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;Object(c.isFiniteNumber)(e)&&u.logger.log("media seeked to "+e.toFixed(3)),this.tick()},d.onManifestLoading=function(){u.logger.log("trigger BUFFER_RESET"),this.hls.trigger(l.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},d.onManifestParsed=function(t){var e,r=!1,n=!1;t.levels.forEach((function(t){(e=t.audioCodec)&&(-1!==e.indexOf("mp4a.40.2")&&(r=!0),-1!==e.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&u.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=t.altAudio,this.levels=t.levels,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},d.onLevelLoaded=function(t){var e=t.details,r=t.level,n=this.levels[this.levelLastLoaded],i=this.levels[r],s=e.totalduration,a=0;if(u.logger.log("level "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+s),e.live||i.details&&i.details.live){var o=i.details;o&&e.fragments.length>0?(nt(o,e),a=e.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),e.PTSKnown&&Object(c.isFiniteNumber)(a)?u.logger.log("live playlist sliding:"+a.toFixed(3)):(u.logger.log("live playlist - outdated PTS, unknown sliding"),ct(this.fragPrevious,n,e))):(u.logger.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,ct(this.fragPrevious,n,e))}else e.PTSKnown=!1;if(i.details=e,this.levelLastLoaded=r,this.hls.trigger(l.default.LEVEL_UPDATED,{details:e,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var h=e.startTimeOffset;Object(c.isFiniteNumber)(h)?(h<0&&(u.logger.log("negative start time offset "+h+", count from end of last fragment"),h=a+s+h),u.logger.log("start time offset found in playlist, adjust startPosition to "+h),this.startPosition=h):e.live?(this.startPosition=this.computeLivePosition(a,e),u.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Ot&&(this.state=vt),this.tick()},d.onKeyLoaded=function(){this.state===bt&&(this.state=vt,this.tick())},d.onFragLoaded=function(t){var e=this.fragCurrent,r=this.hls,n=this.levels,i=this.media,s=t.frag;if(this.state===Et&&e&&"main"===s.type&&s.level===e.level&&s.sn===e.sn){var a=t.stats,o=n[e.level],c=o.details;if(this.bitrateTest=!1,this.stats=a,u.logger.log("Loaded "+e.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+e.level),s.bitrateTest&&r.nextLoadLevel)this.state=vt,this.startFragRequested=!1,a.tparsed=a.tbuffered=window.performance.now(),r.trigger(l.default.FRAG_BUFFERED,{stats:a,frag:e,id:"main"}),this.tick();else if("initSegment"===s.sn)this.state=vt,a.tparsed=a.tbuffered=window.performance.now(),c.initSegment.data=t.payload,r.trigger(l.default.FRAG_BUFFERED,{stats:a,frag:e,id:"main"}),this.tick();else{u.logger.log("Parsing "+e.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+e.level+", cc "+e.cc),this.state=St,this.pendingBuffering=!0,this.appended=!1,s.bitrateTest&&(s.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:s}));var h=!(i&&i.seeking)&&(c.PTSKnown||!c.live),d=c.initSegment?c.initSegment.data:[],f=this._getAudioCodec(o);(this.demuxer=this.demuxer||new J(this.hls,"main")).push(t.payload,d,f,o.videoCodec,e,c.totalduration,h)}}this.fragLoadError=0},d.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===St){var n,i,s=t.tracks;if(this.audioOnly=s.audio&&!s.video,this.altAudio&&!this.audioOnly&&delete s.audio,i=s.audio){var a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(u.logger.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===o.indexOf("firefox")&&(a="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==i.container&&(a="mp4a.40.2",u.logger.log("Android: force audio codec to "+a)),i.levelCodec=a,i.id=t.id}for(n in(i=s.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=t.id),this.hls.trigger(l.default.BUFFER_CODECS,s),s){i=s[n],u.logger.log("main track:"+n+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var c=i.initSegment;c&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.default.BUFFER_APPENDING,{type:n,data:c,parent:"main",content:"initSegment"}))}this.tick()}},d.onFragParsingData=function(t){var e=this,r=this.fragCurrent,n=t.frag;if(r&&"main"===t.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==t.type||!this.altAudio)&&this.state===St){var i=this.levels[this.level],s=r;if(Object(c.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),!0===t.hasAudio&&s.addElementaryStream(m.AUDIO),!0===t.hasVideo&&s.addElementaryStream(m.VIDEO),u.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(s.dropped=t.dropped,s.dropped)if(s.backtracked)u.logger.warn("Already backtracked on this fragment, appending with the gap",s.sn);else{var a=i.details;if(!a||s.sn!==a.startSN)return u.logger.warn("missing video frame(s), backtracking fragment",s.sn),this.fragmentTracker.removeFragment(s),s.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=vt,this.fragPrevious=s,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();u.logger.warn("missing video frame(s) on first frag, appending with gap",s.sn)}else s.backtracked=!1;var o=rt(i.details,s,t.startPTS,t.endPTS,t.startDTS,t.endDTS),h=this.hls;h.trigger(l.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:o,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach((function(r){r&&r.length&&e.state===St&&(e.appended=!0,e.pendingBuffering=!0,h.trigger(l.default.BUFFER_APPENDING,{type:t.type,data:r,parent:"main",content:"data"}))})),this.tick()}},d.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===St&&(this.stats.tparsed=window.performance.now(),this.state=_t,this._checkAppendedParsed())},d.onAudioTrackSwitching=function(t){var e=this.altAudio,r=!!t.url,n=t.id;if(!r){if(this.mediaBuffer!==this.media){u.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(u.logger.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=vt}var s=this.hls;e&&s.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),s.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:n})}},d.onAudioTrackSwitched=function(t){var e=t.id,r=!!this.hls.audioTracks[e].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(u.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()},d.onBufferCreated=function(t){var e,r,n=t.tracks,i=!1;for(var s in n){var a=n[s];"main"===a.id?(r=s,e=a,"video"===s&&(this.videoBuffer=n[s].buffer)):i=!0}i&&e?(u.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=e.buffer):this.mediaBuffer=this.media},d.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==St&&e!==_t||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(this.state===_t&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var e=this.mediaBuffer?this.mediaBuffer:this.media;u.logger.log("main buffered : "+at.toString(e.buffered)),this.fragPrevious=t;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(l.default.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.state=vt}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},d.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var r=!!this.media&&H.isBuffered(this.media,this.media.currentTime)&&H.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);u.logger.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=wt}else u.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=Ct;break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Ct&&(t.fatal?(this.state=Ct,u.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==Ot||(this.state=vt));break;case o.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==St&&this.state!==_t||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=vt):(u.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},d._reduceMaxBufferLength=function(t){var e=this.config;return e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,u.logger.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),!0)},d._checkBuffer=function(){var t=this.media;if(t&&0!==t.readyState){var e=(this.mediaBuffer?this.mediaBuffer:t).buffered;!this.loadedmetadata&&e.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,e)}},d.onFragLoadEmergencyAborted=function(){this.state=vt,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},d.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var e=this.audioOnly?m.AUDIO:m.VIDEO;this.fragmentTracker.detectEvictedFragments(e,t.buffered)}this.state=vt,this.fragPrevious=null},d.onLevelsUpdated=function(t){this.levels=t.levels},d.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},d._seekToStartPos=function(){var t=this.media,e=t.currentTime,r=this.startPosition;if(e!==r&&r>=0){if(t.seeking)return void u.logger.log("could not seek to "+r+", already seeking at "+e);var n=(t.buffered.length?t.buffered.start(0):0)-r;n>0&&n<this.config.maxBufferHole&&(u.logger.log("adjusting start position by "+n+" to match buffer start"),r+=n,this.startPosition=r),u.logger.log("seek to target start position "+r+" from current time "+e+". ready state "+t.readyState),t.currentTime=r}},d._getAudioCodec=function(t){var e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&(u.logger.log("swapping playlist audio codec"),e&&(e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),e},i=n,(a=[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,u.logger.log("main stream-controller: "+e+"->"+t),this.hls.trigger(l.default.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}])&&Dt(i.prototype,a),h&&Dt(i,h),n}(It);function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Nt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MANIFEST_LOADED,l.default.LEVEL_LOADED,l.default.AUDIO_TRACK_SWITCHED,l.default.FRAG_LOADED,l.default.ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,xt=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,c=n.prototype;return c.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},c.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},c.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach((function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)})),null!==this.timer&&this.loadLevel()},c.stopLoad=function(){this.canload=!1},c.onManifestLoaded=function(t){var e,r=[],n=[],i={},s=null,a=!1,c=!1;if(t.levels.forEach((function(t){var e=t.attrs;t.loadError=0,t.fragmentError=!1,a=a||!!t.videoCodec,c=c||!!t.audioCodec,xt&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),(s=i[t.bitrate])?s.url.push(t.url):(t.url=[t.url],t.urlId=0,i[t.bitrate]=t,r.push(t)),e&&(e.AUDIO&&tt(s||t,"audio",e.AUDIO),e.SUBTITLES&&tt(s||t,"text",e.SUBTITLES))})),a&&c&&(r=r.filter((function(t){return!!t.videoCodec}))),r=r.filter((function(t){var e=t.audioCodec,r=t.videoCodec;return(!e||R(e,"audio"))&&(!r||R(r,"video"))})),t.audioTracks&&(n=t.audioTracks.filter((function(t){return!t.audioCodec||R(t.audioCodec,"audio")}))).forEach((function(t,e){t.id=e})),r.length>0){e=r[0].bitrate,r.sort((function(t,e){return t.bitrate-e.bitrate})),this._levels=r;for(var h=0;h<r.length;h++)if(r[h].bitrate===e){this._firstLevel=h,u.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+e);break}var d=c&&!a;this.hls.trigger(l.default.MANIFEST_PARSED,{levels:r,audioTracks:n,firstLevel:this._firstLevel,stats:t.stats,audio:c,video:a,altAudio:!d&&n.some((function(t){return!!t.url}))})}else this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},c.setLevelInternal=function(t){var e=this._levels,r=this.hls;if(t>=0&&t<e.length){if(this.clearTimer(),this.currentLevelIndex!==t){u.logger.log("switching to level "+t),this.currentLevelIndex=t;var n=e[t];n.level=t,r.trigger(l.default.LEVEL_SWITCHING,n)}var i=e[t],s=i.details;if(!s||s.live){var a=i.urlId;r.trigger(l.default.LEVEL_LOADING,{url:i.url[a],level:t,id:a})}}else r.trigger(l.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},c.onError=function(t){if(t.fatal)t.type===o.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var e,r=!1,n=!1;switch(t.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:e=t.frag.level,n=!0;break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:e=t.context.level,r=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:e=t.level,r=!0}void 0!==e&&this.recoverLevel(t,e,r,n)}},c.recoverLevel=function(t,e,r,n){var i,s,a,o=this,c=this.hls.config,l=t.details,h=this._levels[e];if(h.loadError++,h.fragmentError=n,r){if(!(this.levelRetryCount+1<=c.levelLoadingMaxRetry))return u.logger.error("level controller, cannot recover from "+l+" error"),this.currentLevelIndex=null,this.clearTimer(),void(t.fatal=!0);s=Math.min(Math.pow(2,this.levelRetryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return o.loadLevel()}),s),t.levelRetry=!0,this.levelRetryCount++,u.logger.warn("level controller, "+l+", retry in "+s+" ms, current retry count is "+this.levelRetryCount)}(r||n)&&((i=h.url.length)>1&&h.loadError<i?(h.urlId=(h.urlId+1)%i,h.details=void 0,u.logger.warn("level controller, "+l+" for level "+e+": switching to redundant URL-id "+h.urlId)):-1===this.manualLevelIndex?(a=0===e?this._levels.length-1:e-1,u.logger.warn("level controller, "+l+": switch to "+a),this.hls.nextAutoLevel=this.currentLevelIndex=a):n&&(u.logger.warn("level controller, "+l+": reload a fragment"),this.currentLevelIndex=null))},c.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var r=this._levels[e.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},c.onLevelLoaded=function(t){var e=this,r=t.level,n=t.details;if(r===this.currentLevelIndex){var i=this._levels[r];if(i.fragmentError||(i.loadError=0,this.levelRetryCount=0),n.live){var s=st(i.details,n,t.stats.trequest);u.logger.log("live playlist, reload in "+Math.round(s)+" ms"),this.timer=setTimeout((function(){return e.loadLevel()}),s)}else this.clearTimer()}},c.onAudioTrackSwitched=function(t){var e=this.hls.audioTracks[t.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var n=-1,i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===e){n=i;break}n!==r.urlId&&(r.urlId=n,this.startLoad())}},c.loadLevel=function(){if(u.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var t=this._levels[this.currentLevelIndex];if("object"===typeof t&&t.url.length>0){var e=this.currentLevelIndex,r=t.urlId,n=t.url[r];u.logger.log("Attempt loading level index "+e+" with URL-id "+r),this.hls.trigger(l.default.LEVEL_LOADING,{url:n,level:e,id:r})}}},c.removeLevel=function(t,e){var r=this.levels.filter((function(r,n){return n!==t||r.url.length>1&&void 0!==e&&(r.url=r.url.filter((function(t,r){return r!==e})),r.urlId=0,!0)})).map((function(t,e){var r=t.details;return r&&r.fragments&&r.fragments.forEach((function(t){t.level=e})),t}));this._levels=r,this.hls.trigger(l.default.LEVELS_UPDATED,{levels:r})},i=n,(s=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;e&&(t=Math.min(t,e.length-1),this.currentLevelIndex===t&&e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}])&&Pt(i.prototype,s),a&&Pt(i,a),n}(f),Mt=r("./src/demux/id3.js");function Ft(t,e){var r;try{r=new Event("addtrack")}catch(n){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function Ut(t){if(null===t||void 0===t?void 0:t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}var Bt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.FRAG_PARSING_METADATA,l.default.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,r.media=void 0,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){f.prototype.destroy.call(this)},i.onMediaAttached=function(t){this.media=t.media,this.media},i.onMediaDetaching=function(){Ut(this.id3Track),this.id3Track=void 0,this.media=void 0},i.getID3Track=function(t){for(var e=0;e<t.length;e++){var r=t[e];if("metadata"===r.kind&&"id3"===r.label)return Ft(r,this.media),r}return this.media.addTextTrack("metadata","id3")},i.onFragParsingMetadata=function(t){var e=t.frag,r=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var s=Mt.default.getID3Frames(r[i].data);if(s){var a=Math.max(r[i].pts,0),o=i<r.length-1?r[i+1].pts:e.endPTS;o||(o=e.start+e.duration),o-a<=0&&(o=a+.25);for(var c=0;c<s.length;c++){var l=s[c];if(!Mt.default.isTimeStampFrame(l)){var u=new n(a,o,"");u.value=l,this.id3Track.addCue(u)}}}}},i.onLiveBackBufferReached=function(t){var e=t.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var n=function(t,e){if(e<t[0].endTime)return t[0];if(e>t[t.length-1].endTime)return t[t.length-1];for(var r=0,n=t.length-1;r<=n;){var i=Math.floor((n+r)/2);if(e<t[i].endTime)n=i-1;else{if(!(e>t[i].endTime))return t[i];r=i+1}}return t[r].endTime-e<e-t[n].endTime?t[r]:t[n]}(r.cues,e);if(n)for(;r.cues[0]!==n;)r.removeCue(r.cues[0])}},n}(f),jt=function(){function t(t){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}var e=t.prototype;return e.sample=function(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t},e.getTotalWeight=function(){return this.totalWeight_},e.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},t}(),Vt=function(){function t(t,e,r,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=t,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new jt(e),this.fast_=new jt(r)}var e=t.prototype;return e.sample=function(t,e){var r=(t=Math.max(t,this.minDelayMs_))/1e3,n=8*e/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},e.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},e.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.destroy=function(){},t}();function Gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Kt=window.performance,Ht=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.FRAG_LOADING,l.default.FRAG_LOADED,l.default.FRAG_BUFFERED,l.default.ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,h=n.prototype;return h.destroy=function(){this.clearTimer(),f.prototype.destroy.call(this)},h.onFragLoading=function(t){var e=t.frag;if("main"===e.type&&(this.timer||(this.fragCurrent=e,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,n,i=this.hls,s=i.config,a=e.level;i.levels[a].details.live?(r=s.abrEwmaFastLive,n=s.abrEwmaSlowLive):(r=s.abrEwmaFastVoD,n=s.abrEwmaSlowVoD),this._bwEstimator=new Vt(i,n,r,s.abrEwmaDefaultEstimate)}},h._abandonRulesCheck=function(){var t=this.hls,e=t.media,r=this.fragCurrent;if(r){var n=r.loader;if(!n||n.stats&&n.stats.aborted)return u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var i=n.stats;if(e&&i&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&r.autoLevel&&r.level){var s=Kt.now()-i.trequest,a=Math.abs(e.playbackRate);if(s>500*r.duration/a){var o=t.levels,c=Math.max(1,i.bw?i.bw/8:1e3*i.loaded/s),h=o[r.level];if(!h)return;var d=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,f=i.total?i.total:Math.max(i.loaded,Math.round(r.duration*d/8)),p=e.currentTime,g=(f-i.loaded)/c,m=(H.bufferInfo(e,p,t.config.maxBufferHole).end-p)/a;if(m<2*r.duration/a&&g>m){var v,y,b=t.minAutoLevel;for(y=r.level-1;y>b;y--){var E=o[y].realBitrate?Math.max(o[y].realBitrate,o[y].bitrate):o[y].bitrate;if(r.duration*E/(6.4*c)<m)break}v<g&&(u.logger.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+v.toFixed(1)+"<"+g.toFixed(1)+":"+m.toFixed(1)),t.nextLoadLevel=y,this._bwEstimator.sample(s,i.loaded),n.abort(),this.clearTimer(),t.trigger(l.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:i}))}}}}},h.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&Object(c.isFiniteNumber)(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[e.level],n=(r.loaded?r.loaded.bytes:0)+t.stats.loaded,i=(r.loaded?r.loaded.duration:0)+t.frag.duration;r.loaded={bytes:n,duration:i},r.realBitrate=Math.round(8*n/i)}if(t.frag.bitrateTest){var s=t.stats;s.tparsed=s.tbuffered=s.tload,this.onFragBuffered(t)}}},h.onFragBuffered=function(t){var e=t.stats,r=t.frag;if(!0!==e.aborted&&"main"===r.type&&Object(c.isFiniteNumber)(r.sn)&&(!r.bitrateTest||e.tload===e.tbuffered)){var n=e.tparsed-e.trequest;u.logger.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(n,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},h.onError=function(t){switch(t.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},h.clearTimer=function(){clearInterval(this.timer),this.timer=null},h._findBestLevel=function(t,e,r,n,i,s,a,o,c){for(var l=i;l>=n;l--){var h=c[l];if(h){var d=h.details,f=d?d.totalduration/d.fragments.length:e,p=!!d&&d.live,g=void 0;g=l<=t?a*r:o*r;var m=c[l].realBitrate?Math.max(c[l].realBitrate,c[l].bitrate):c[l].bitrate,v=m*f/g;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+l+"/"+Math.round(g)+"/"+m+"/"+f+"/"+s+"/"+v),g>m&&(!v||p&&!this.bitrateTestDelay||v<s))return l}}return-1},i=n,(s=[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(-1!==t&&(!e||!e.canEstimate()))return t;var r=this._nextABRAutoLevel;return-1!==t&&(r=Math.min(t,r)),r},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,r=t.levels,n=t.config,i=t.minAutoLevel,s=t.media,a=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,c=s?s.currentTime:0,l=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,d=(H.bufferInfo(s,c,n.maxBufferHole).end-c)/l,f=this._findBestLevel(a,o,h,i,e,d,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(f>=0)return f;u.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===d){var v=this.bitrateTestDelay;v&&(p=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-v,u.logger.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),g=m=1)}return f=this._findBestLevel(a,o,h,i,e,d+p,g,m,r),Math.max(f,0)}}])&&Gt(i.prototype,s),a&&Gt(i,a),n}(f),zt=Y(),qt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.MANIFEST_PARSED,l.default.BUFFER_RESET,l.default.BUFFER_APPENDING,l.default.BUFFER_CODECS,l.default.BUFFER_EOS,l.default.BUFFER_FLUSHING,l.default.LEVEL_PTS_UPDATED,l.default.LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){u.logger.log("media source opened"),r.hls.trigger(l.default.MEDIA_ATTACHED,{media:r.media});var t=r.mediaSource;t&&t.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){u.logger.log("media source closed")},r._onMediaSourceEnded=function(){u.logger.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var t=r.sourceBuffer.audio;u.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+r.audioTimestampOffset),t.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var e=r.parent,n=r.segments.reduce((function(t,r){return r.parent===e?t+1:t}),0),i={},s=r.sourceBuffer;for(var a in s){var o=s[a];if(!o)throw Error("handling source buffer update end error: source buffer for "+a+" uninitilized and unable to update buffered TimeRanges.");i[a]=o.buffered}r.hls.trigger(l.default.BUFFER_APPENDED,{parent:e,pending:n,timeRanges:i}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===n&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(t){u.logger.error("sourceBuffer error:",t),r.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=e.config,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){f.prototype.destroy.call(this)},i.onLevelPtsUpdated=function(t){var e=t.type,r=this.tracks.audio;if("audio"===e&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio;if(!n)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(n.timestampOffset-t.start)>.1){var i=n.updating;try{n.abort()}catch(s){u.logger.warn("can not abort audio buffer: "+s)}i?this.audioTimestampOffset=t.start:(u.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.start),n.timestampOffset=t.start)}}},i.onManifestParsed=function(t){var e=2;(t.audio&&!t.video||!t.altAudio)&&(e=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e,u.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},i.onMediaAttaching=function(t){var e=this.media=t.media;if(e&&zt){var r=this.mediaSource=new zt;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),e.src=window.URL.createObjectURL(r),this._objectUrl=e.src}},i.onMediaDetaching=function(){u.logger.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(e){u.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):u.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(l.default.MEDIA_DETACHED)},i.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,e=this.pendingTracks,r=Object.keys(e).length;(r&&!t||2===r)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},i.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var r=t[e];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(n){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},i.onBufferCodecs=function(t){var e=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach((function(r){e.pendingTracks[r]=t[r]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},i.createSourceBuffers=function(t){var e=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var n in t)if(!e[n]){var i=t[n];if(!i)throw Error("source buffer exists for track "+n+", however track does not");var s=i.levelCodec||i.codec,a=i.container+";codecs="+s;u.logger.log("creating sourceBuffer("+a+")");try{var c=e[n]=r.addSourceBuffer(a);c.addEventListener("updateend",this._onSBUpdateEnd),c.addEventListener("error",this._onSBUpdateError),this.tracks[n]={buffer:c,codec:s,id:i.id,container:i.container,levelCodec:i.levelCodec}}catch(h){u.logger.error("error while trying to add sourceBuffer:"+h.message),this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:h,mimeType:a})}}this.hls.trigger(l.default.BUFFER_CREATED,{tracks:this.tracks})},i.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},i.onBufferEos=function(t){for(var e in this.sourceBuffer)if(!t.type||t.type===e){var r=this.sourceBuffer[e];r&&!r.ended&&(r.ended=!0,u.logger.log(e+" sourceBuffer now EOS"))}this.checkEos()},i.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(e&&"open"===e.readyState){for(var r in t){var n=t[r];if(n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}}u.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(i){u.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},i.onBufferFlushing=function(t){t.type?this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}):(this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"}),this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},i.flushLiveBackBuffer=function(){if(this._live){var t=this.config.liveBackBufferLength;if(isFinite(t)&&!(t<0))if(this.media)for(var e=this.media.currentTime,r=this.sourceBuffer,n=Object.keys(r),i=e-Math.max(t,this._levelTargetDuration),s=n.length-1;s>=0;s--){var a=n[s],o=r[a];if(o){var c=o.buffered;c.length>0&&i>c.start(0)&&this.removeBufferRange(a,o,0,i)&&this.hls.trigger(l.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i})}}else u.logger.error("flushLiveBackBuffer called without attaching media")}},i.onLevelUpdated=function(t){var e=t.details;e.fragments.length>0&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._levelTargetDuration=e.averagetargetduration||e.targetduration||10,this._live=e.live,this.updateMediaElementDuration())},i.updateMediaElementDuration=function(){var t,e=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var n=this.sourceBuffer[r];if(n&&!0===n.updating)return}t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===e.liveDurationInfinity?(u.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!Object(c.isFiniteNumber)(t))&&(u.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},i.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,r=this.sourceBuffer;try{for(var n in r){var i=r[n];i&&(e+=i.buffered.length)}}catch(s){u.logger.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(l.default.BUFFER_FLUSHED)}},i.doAppending=function(){var t=this.config,e=this.hls,r=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(!this.media||this.media.error)return this.segments=[],void u.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var i=r.shift();if(i)try{var s=n[i.type];if(!s)return void this._onSBUpdateEnd();if(s.updating)return void r.unshift(i);s.ended=!1,this.parent=i.parent,s.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0}catch(c){u.logger.error("error while trying to append buffer:"+c.message),r.unshift(i);var a={type:o.ErrorTypes.MEDIA_ERROR,parent:i.parent,details:"",fatal:!1};22===c.code?(this.segments=[],a.details=o.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,a.details=o.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>t.appendErrorMaxRetry&&(u.logger.log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],a.fatal=!0)),e.trigger(l.default.ERROR,a)}}}},i.flushBuffer=function(t,e,r){var n=this.sourceBuffer;if(!Object.keys(n).length)return!0;var i="null";if(this.media&&(i=this.media.currentTime.toFixed(3)),u.logger.log("flushBuffer,pos/start/end: "+i+"/"+t+"/"+e),this.flushBufferCounter>=this.appended)return u.logger.warn("abort flushing too many retries"),!0;var s=n[r];if(s){if(s.ended=!1,s.updating)return u.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,s,t,e))return this.flushBufferCounter++,!1}return u.logger.log("buffer flushed"),!0},i.removeBufferRange=function(t,e,r,n){try{for(var i=0;i<e.buffered.length;i++){var s=e.buffered.start(i),a=e.buffered.end(i),o=Math.max(s,r),c=Math.min(a,n);if(Math.min(c,a)-o>.5){var l="null";return this.media&&(l=this.media.currentTime.toString()),u.logger.log("sb remove "+t+" ["+o+","+c+"], of ["+s+","+a+"], pos:"+l),e.remove(o,c),!0}}}catch(h){u.logger.warn("removeBufferRange failed",h)}return!1},n}(f);function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Yt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.FPS_DROP_LEVEL_CAPPING,l.default.MEDIA_ATTACHING,l.default.MANIFEST_PARSED,l.default.LEVELS_UPDATED,l.default.BUFFER_CODECS,l.default.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r.clientRect=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,o=n.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},o.onFpsDropLevelCapping=function(t){n.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},o.onMediaAttaching=function(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null},o.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],this.levels=t.levels,this.firstLevel=t.firstLevel,e.config.capLevelToPlayerSize&&t.video&&this.startCapping()},o.onBufferCodecs=function(t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},o.onLevelsUpdated=function(t){this.levels=t.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},o.getMaxLevel=function(t){var e=this;if(!this.levels)return-1;var r=this.levels.filter((function(r,i){return n.isLevelAllowed(i,e.restrictedLevels)&&i<=t}));return this.clientRect=null,n.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},o.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,e={width:0,height:0};if(t){var r=t.getBoundingClientRect();e.width=r.width,e.height=r.height,e.width||e.height||(e.width=r.right-r.left||t.width||0,e.height=r.bottom-r.top||t.height||0)}return this.clientRect=e,e},n.isLevelAllowed=function(t,e){return void 0===e&&(e=[]),-1===e.indexOf(t)},n.getMaxLevelByMediaSize=function(t,e,r){if(!t||t&&!t.length)return-1;for(var n,i,s=t.length-1,a=0;a<t.length;a+=1){var o=t[a];if((o.width>=e||o.height>=r)&&(n=o,!(i=t[a+1])||n.width!==i.width||n.height!==i.height)){s=a;break}}return s},i=n,a=[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(e){}return t}}],(s=[{key:"mediaWidth",get:function(){return this.getDimensions().width*n.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*n.contentScaleFactor}}])&&Wt(i.prototype,s),a&&Wt(i,a),n}(f),Zt=window.performance,Xt=function(t){var e,r;function n(e){return t.call(this,e,l.default.MEDIA_ATTACHING)||this}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},i.onMediaAttaching=function(t){var e=this.hls.config;e.capLevelOnFPSDrop&&("function"===typeof(this.video=t.media instanceof window.HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod))},i.checkFPS=function(t,e,r){var n=Zt.now();if(e){if(this.lastTime){var i=n-this.lastTime,s=r-this.lastDroppedFrames,a=e-this.lastDecodedFrames,o=1e3*s/i,c=this.hls;if(c.trigger(l.default.FPS_DROP,{currentDropped:s,currentDecoded:a,totalDroppedFrames:r}),o>0&&s>c.config.fpsDroppedMonitoringThreshold*a){var h=c.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=h)&&(h-=1,c.trigger(l.default.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:c.currentLevel}),c.autoLevelCapping=h,c.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=e}},i.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},n}(f),Qt=function(){function t(t){t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}var e=t.prototype;return e.destroy=function(){this.abort(),this.loader=null},e.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.load=function(t,e,r){this.context=t,this.config=e,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},e.loadInternal=function(){var t,e=this.context;t=this.loader=new window.XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(i){t.open("GET",e.url,!0),n(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(i){return void this.callbacks.onError({code:t.status,text:i.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},e.readystatechange=function(t){var e=t.currentTarget,r=e.readyState,n=this.stats,i=this.context,s=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(window.performance.now(),n.trequest)),4===r){var a=e.status;if(a>=200&&a<300){var o,c;n.tload=Math.max(n.tfirst,window.performance.now()),c="arraybuffer"===i.responseType?(o=e.response).byteLength:(o=e.responseText).length,n.loaded=n.total=c;var l={url:e.responseURL,data:o};this.callbacks.onSuccess(l,n,i,e)}else n.retry>=s.maxRetry||a>=400&&a<499?(u.logger.error(a+" while loading "+i.url),this.callbacks.onError({code:a,text:e.statusText},i,e)):(u.logger.warn(a+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)},e.loadtimeout=function(){u.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.loadprogress=function(t){var e=t.currentTarget,r=this.stats;r.loaded=t.loaded,t.lengthComputable&&(r.total=t.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,e)},t}();function $t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Jt=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MANIFEST_LOADING,l.default.MANIFEST_PARSED,l.default.AUDIO_TRACK_LOADED,l.default.AUDIO_TRACK_SWITCHED,l.default.LEVEL_LOADED,l.default.ERROR)||this)._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,c=n.prototype;return c.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},c.onManifestParsed=function(t){var e=this.tracks=t.audioTracks||[];this.hls.trigger(l.default.AUDIO_TRACKS_UPDATED,{audioTracks:e}),this._selectAudioGroup(this.hls.nextLoadLevel)},c.onAudioTrackLoaded=function(t){if(t.id>=this.tracks.length)u.logger.warn("Invalid audio track id:",t.id);else{if(u.logger.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.hasInterval()){var e=1e3*t.details.targetduration;this.setInterval(e)}!t.details.live&&this.hasInterval()&&this.clearInterval()}},c.onAudioTrackSwitched=function(t){var e=this.tracks[t.id].groupId;e&&this.audioGroupId!==e&&(this.audioGroupId=e)},c.onLevelLoaded=function(t){this._selectAudioGroup(t.level)},c.onError=function(t){t.type===o.ErrorTypes.NETWORK_ERROR&&(t.fatal&&this.clearInterval(),t.details===o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(u.logger.warn("Network failure on audio-track id:",t.context.id),this._handleLoadError()))},c._setAudioTrack=function(t){if(this._trackId===t&&this.tracks[this._trackId].details)u.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(t<0||t>=this.tracks.length)u.logger.warn("Invalid id passed to audio-track controller");else{var e=this.tracks[t];u.logger.log("Now switching to audio-track index "+t),this.clearInterval(),this._trackId=t;var r=e.url,n=e.type,i=e.id;this.hls.trigger(l.default.AUDIO_TRACK_SWITCHING,{id:i,type:n,url:r}),this._loadTrackDetailsIfNeeded(e)}},c.doTick=function(){this._updateTrack(this._trackId)},c._selectAudioGroup=function(t){var e=this.hls.levels[t];if(e&&e.audioGroupIds){var r=e.audioGroupIds[e.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},c._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var r=this.tracks[this._trackId],n=null;if(r&&(n=r.name),this._selectDefaultTrack){var i=e.filter((function(t){return t.default}));i.length?e=i:u.logger.warn("No default audio tracks defined")}var s=!1,a=function(){e.forEach((function(e){s||t.audioGroupId&&e.groupId!==t.audioGroupId||n&&n!==e.name||(t._setAudioTrack(e.id),s=!0)}))};a(),s||(n=null,a()),s||(u.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},c._needsTrackLoading=function(t){var e=t.details,r=t.url;return!(e&&!e.live)&&!!r},c._loadTrackDetailsIfNeeded=function(t){if(this._needsTrackLoading(t)){var e=t.url,r=t.id;u.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(l.default.AUDIO_TRACK_LOADING,{url:e,id:r})}},c._updateTrack=function(t){if(!(t<0||t>=this.tracks.length)){this.clearInterval(),this._trackId=t,u.logger.log("trying to update audio-track "+t);var e=this.tracks[t];this._loadTrackDetailsIfNeeded(e)}},c._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var t=this._trackId,e=this.tracks[t],r=e.name,n=e.language,i=e.groupId;u.logger.warn("Loading failed on audio track id: "+t+", group-id: "+i+', name/language: "'+r+'" / "'+n+'"');for(var s=t,a=0;a<this.tracks.length;a++)if(!this.trackIdBlacklist[a]&&this.tracks[a].name===r){s=a;break}s!==t?(u.logger.log("Attempting audio-track fallback id:",s,"group-id:",this.tracks[s].groupId),this._setAudioTrack(s)):u.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+n+'"')},i=n,(s=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(t){this._setAudioTrack(t),this._selectDefaultTrack=!1}}])&&$t(i.prototype,s),a&&$t(i,a),n}(pt);function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ee=window.performance,re=function(t){var e,r;function n(e,r){var n;return(n=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.AUDIO_TRACKS_UPDATED,l.default.AUDIO_TRACK_SWITCHING,l.default.AUDIO_TRACK_LOADED,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.FRAG_PARSING_INIT_SEGMENT,l.default.FRAG_PARSING_DATA,l.default.FRAG_PARSED,l.default.ERROR,l.default.BUFFER_RESET,l.default.BUFFER_CREATED,l.default.BUFFER_APPENDED,l.default.BUFFER_FLUSHED,l.default.INIT_PTS_FOUND)||this).fragmentTracker=r,n.config=e.config,n.audioCodecSwap=!1,n._state=gt,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n.waitingVideoCC=null,n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,h=n.prototype;return h.onInitPtsFound=function(t){var e=t.id,r=t.frag.cc,n=t.initPTS;"main"===e&&(this.initPTS[r]=n,this.videoTrackCC=r,u.logger.log("InitPTS for cc: "+r+" found from main: "+n),this.state===kt&&this.tick())},h.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,e>0&&-1===t?(u.logger.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=vt):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=mt),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=gt},h.doTick=function(){var t,e,r,n=this.hls,i=n.config;switch(this.state){case Ct:case yt:case At:break;case mt:this.state=Tt,this.loadedmetadata=!1;break;case vt:var s=this.tracks;if(!s)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var a=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,h=t<i.maxBufferHole?Math.max(2,i.maxBufferHole):i.maxBufferHole,d=H.bufferInfo(a,t,h),f=H.bufferInfo(o,t,h),p=d.len,g=d.end,m=this.fragPrevious,v=Math.min(i.maxBufferLength,i.maxMaxBufferLength),y=Math.max(v,f.len),b=this.audioSwitch,E=this.trackId;if((p<y||b)&&E<s.length){if("undefined"===typeof(r=s[E].details)){this.state=Tt;break}if(!b&&this._streamEnded(d,r))return this.hls.trigger(l.default.BUFFER_EOS,{type:"audio"}),void(this.state=Rt);var w,T=r.fragments,S=T.length,_=T[0].start,A=T[S-1].start+T[S-1].duration;if(b)if(r.live&&!r.PTSKnown)u.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),g=0;else if(g=t,r.PTSKnown&&t<_){if(!(d.end>_||d.nextStart))return;u.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=_+.05}if(r.initSegment&&!r.initSegment.data)w=r.initSegment;else if(g<=_){if(w=T[0],null!==this.videoTrackCC&&w.cc!==this.videoTrackCC&&(w=function(t,e){return K.search(t,(function(t){return t.cc<e?1:t.cc>e?-1:0}))}(T,this.videoTrackCC)),r.live&&w.loadIdx&&w.loadIdx===this.fragLoadIdx){var R=d.nextStart?d.nextStart:_;return u.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(R+.05)),void(this.media.currentTime=R+.05)}}else{var C,k=i.maxFragLookUpTolerance,O=m?T[m.sn-T[0].sn+1]:void 0;g<A?(g>A-k&&(k=0),C=O&&!ht(g,k,O)?O:K.search(T,(function(t){return ht(g,k,t)}))):C=T[S-1],C&&(w=C,_=C.start,m&&w.level===m.level&&w.sn===m.sn&&(w.sn<r.endSN?(w=T[w.sn+1-r.startSN],this.fragmentTracker.getState(w)!==V&&u.logger.log("SN just loaded, load next one: "+w.sn)):w=null))}w&&(w.encrypted?(u.logger.log("Loading key for "+w.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+E),this.state=bt,n.trigger(l.default.KEY_LOADING,{frag:w})):(this.fragCurrent=w,(b||this.fragmentTracker.getState(w)===U)&&(u.logger.log("Loading "+w.sn+", cc: "+w.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+E+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+t+", bufferEnd: "+g.toFixed(3)),"initSegment"!==w.sn&&(this.startFragRequested=!0),Object(c.isFiniteNumber)(w.sn)&&(this.nextLoadPosition=w.start+w.duration),n.trigger(l.default.FRAG_LOADING,{frag:w}),this.state=Et)))}break;case Tt:(e=this.tracks[this.trackId])&&e.details&&(this.state=vt);break;case wt:var I=ee.now(),D=this.retryDate,x=(a=this.media)&&a.seeking;(!D||I>=D||x)&&(u.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=vt);break;case kt:var L=this.waitingFragment;if(L){var P=L.frag.cc;if(void 0!==this.initPTS[P])this.waitingFragment=null,this.state=Et,this.onFragLoaded(L);else if(this.videoTrackCC!==this.waitingVideoCC)u.logger.log("Waiting fragment cc ("+P+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=H.bufferInfo(this.mediaBuffer,this.media.currentTime,i.maxBufferHole);ht(N.end,i.maxFragLookUpTolerance,L.frag)<0&&(u.logger.log("Waiting fragment cc ("+P+") @ "+L.frag.start+" cancelled because another fragment at "+N.end+" is needed"),this.clearWaitingFragment())}}else this.state=vt}},h.clearWaitingFragment=function(){var t=this.waitingFragment;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=vt)},h.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},h.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(u.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},h.onAudioTracksUpdated=function(t){u.logger.log("audio tracks updated"),this.tracks=t.audioTracks},h.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=yt,e?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=vt),this.tick()},h.onAudioTrackLoaded=function(t){var e=t.details,r=t.id,n=this.tracks[r],i=n.details,s=e.totalduration,a=0;if(u.logger.log("track "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+s),e.live||i&&i.live?i&&e.fragments.length>0?(nt(i,e),a=e.fragments[0].start,e.PTSKnown?u.logger.log("live audio playlist sliding:"+a.toFixed(3)):u.logger.log("live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,u.logger.log("live audio playlist - first load, unknown sliding")):e.PTSKnown=!1,n.details=e,!this.startFragRequested){if(-1===this.startPosition){var o=e.startTimeOffset;Object(c.isFiniteNumber)(o)?(u.logger.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):e.live?(this.startPosition=this.computeLivePosition(a,e),u.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===Tt&&(this.state=vt),this.tick()},h.onKeyLoaded=function(){this.state===bt&&(this.state=vt,this.tick())},h.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag;if(this.state===Et&&e&&"audio"===r.type&&r.level===e.level&&r.sn===e.sn){var n=this.tracks[this.trackId],i=n.details,s=i.totalduration,a=e.level,o=e.sn,c=e.cc,h=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",d=this.stats=t.stats;if("initSegment"===o)this.state=vt,d.tparsed=d.tbuffered=ee.now(),i.initSegment.data=t.payload,this.hls.trigger(l.default.FRAG_BUFFERED,{stats:d,frag:e,id:"audio"}),this.tick();else{this.state=St,this.appended=!1,this.demuxer||(this.demuxer=new J(this.hls,"audio"));var f=this.initPTS[c],p=i.initSegment?i.initSegment.data:[];void 0!==f?(this.pendingBuffering=!0,u.logger.log("Demuxing "+o+" of ["+i.startSN+" ,"+i.endSN+"],track "+a),this.demuxer.push(t.payload,p,h,null,e,s,!1,f)):(u.logger.log("Unknown video PTS for cc "+c+", waiting for video PTS before demuxing audio frag "+o+" of ["+i.startSN+" ,"+i.endSN+"],track "+a),this.waitingFragment=t,this.waitingVideoCC=this.videoTrackCC,this.state=kt)}}this.fragLoadError=0},h.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===St){var n,i=t.tracks;if(i.video&&delete i.video,n=i.audio){n.levelCodec=n.codec,n.id=t.id,this.hls.trigger(l.default.BUFFER_CODECS,i),u.logger.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var s=n.initSegment;if(s){var a={type:"audio",data:s,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.default.BUFFER_APPENDING,a))}this.tick()}}},h.onFragParsingData=function(t){var e=this,r=this.fragCurrent,n=t.frag;if(r&&"audio"===t.id&&"audio"===t.type&&n.sn===r.sn&&n.level===r.level&&this.state===St){var i=this.trackId,s=this.tracks[i],a=this.hls;Object(c.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),r.addElementaryStream(m.AUDIO),u.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),rt(s.details,r,t.startPTS,t.endPTS);var h=this.media,d=!1;if(this.audioSwitch)if(h&&h.readyState){var f=h.currentTime;u.logger.log("switching audio track : currentTime:"+f),f>=t.startPTS&&(u.logger.log("switching audio track : flushing all audio"),this.state=At,a.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),d=!0,this.audioSwitch=!1,a.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:i}))}else this.audioSwitch=!1,a.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:i});var p=this.pendingData;if(!p)return u.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void a.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach((function(e){e&&e.length&&p.push({type:t.type,data:e,parent:"audio",content:"data"})})),!d&&p.length&&(p.forEach((function(t){e.state===St&&(e.pendingBuffering=!0,e.hls.trigger(l.default.BUFFER_APPENDING,t))})),this.pendingData=[],this.appended=!0)),this.tick()}},h.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===St&&(this.stats.tparsed=ee.now(),this.state=_t,this._checkAppendedParsed())},h.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},h.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},h.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==St&&e!==_t||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},h._checkAppendedParsed=function(){if(this.state===_t&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,r=this.hls;if(t){this.fragPrevious=t,e.tbuffered=ee.now(),r.trigger(l.default.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&u.logger.log("audio buffered : "+at.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=vt}this.tick()}},h.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:var r=t.frag;if(r&&"audio"!==r.type)break;if(!t.fatal){var n=this.fragLoadError;n?n++:n=1;var i=this.config;if(n<=i.fragLoadingMaxRetry){this.fragLoadError=n;var s=Math.min(Math.pow(2,n-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);u.logger.warn("AudioStreamController: frag loading failed, retry in "+s+" ms"),this.retryDate=ee.now()+s,this.state=wt}else u.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=Ct}break;case o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==Ct&&(this.state=t.fatal?Ct:vt,u.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case o.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===St||this.state===_t)){var a=this.mediaBuffer,c=this.media.currentTime;if(a&&H.isBuffered(a,c)&&H.isBuffered(a,c+.5)){var h=this.config;h.maxMaxBufferLength>=h.maxBufferLength&&(h.maxMaxBufferLength/=2,u.logger.warn("AudioStreamController: reduce max buffer length to "+h.maxMaxBufferLength+"s")),this.state=vt}else u.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=At,this.hls.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},h.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(u.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach((function(e){t.hls.trigger(l.default.BUFFER_APPENDING,e)})),this.appended=!0,this.pendingData=[],this.state=_t):(this.state=vt,this.fragPrevious=null,this.tick())},i=n,(s=[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,u.logger.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}])&&te(i.prototype,s),a&&te(i,a),n}(It),ne=function(){if("undefined"!==typeof window&&window.VTTCue)return window.VTTCue;var t={"":!0,lr:!0,rl:!0},e={start:!0,middle:!0,end:!0,left:!0,right:!0};function r(t){return"string"===typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}function n(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function i(e,i,s){var a=this,o={enumerable:!0};a.hasBeenReset=!1;var c="",l=!1,u=e,h=i,d=s,f=null,p="",g=!0,m="auto",v="start",y=50,b="middle",E=50,w="middle";Object.defineProperty(a,"id",n({},o,{get:function(){return c},set:function(t){c=""+t}})),Object.defineProperty(a,"pauseOnExit",n({},o,{get:function(){return l},set:function(t){l=!!t}})),Object.defineProperty(a,"startTime",n({},o,{get:function(){return u},set:function(t){if("number"!==typeof t)throw new TypeError("Start time must be set to a number.");u=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",n({},o,{get:function(){return h},set:function(t){if("number"!==typeof t)throw new TypeError("End time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",n({},o,{get:function(){return d},set:function(t){d=""+t,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",n({},o,{get:function(){return f},set:function(t){f=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",n({},o,{get:function(){return p},set:function(e){var r=function(e){return"string"===typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");p=r,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",n({},o,{get:function(){return g},set:function(t){g=!!t,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",n({},o,{get:function(){return m},set:function(t){if("number"!==typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",n({},o,{get:function(){return v},set:function(t){var e=r(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",n({},o,{get:function(){return y},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",n({},o,{get:function(){return b},set:function(t){var e=r(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",n({},o,{get:function(){return E},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",n({},o,{get:function(){return w},set:function(t){var e=r(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");w=e,this.hasBeenReset=!0}})),a.displayState=void 0}return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}(),ie=function(){return{decode:function(t){if(!t)return"";if("string"!==typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};function se(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new ie,this.regionList=[]}function ae(){this.values=Object.create(null)}function oe(t,e,r,n){var i=n?t.split(n):[t];for(var s in i)if("string"===typeof i[s]){var a=i[s].split(r);2===a.length&&e(a[0],a[1])}}ae.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var n=0;n<r.length;++n)if(e===r[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var ce=new ne(0,0,0),le="middle"===ce.align?"middle":"center";function ue(t,e,r){var n=t;function i(){var e=function(t){function e(t,e,r,n){return 3600*(0|t)+60*(0|e)+(0|r)+(0|n)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}(t);if(null===e)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=i(),s(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.substr(3),s(),e.endTime=i(),s(),function(t,e){var n=new ae;oe(t,(function(t,e){switch(t){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===e){n.set(t,r[i].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":var s=e.split(","),a=s[0];n.integer(t,a),n.percent(t,a)&&n.set("snapToLines",!1),n.alt(t,a,["auto"]),2===s.length&&n.alt("lineAlign",s[1],["start",le,"end"]);break;case"position":s=e.split(","),n.percent(t,s[0]),2===s.length&&n.alt("positionAlign",s[1],["start",le,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",le,"end","left","right"])}}),/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===ce.line&&(i=-1),e.line=i,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",le);var s=n.get("position","auto");"auto"===s&&50===ce.position&&(s="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=s}(t,e)}function he(t){return t.replace(/<br(?: \/)?>/gi,"\n")}se.prototype={parse:function(t){var e=this;function r(){var t=e.buffer,r=0;for(t=he(t);r<t.length&&"\r"!==t[r]&&"\n"!==t[r];)++r;var n=t.substr(0,r);return"\r"===t[r]&&++r,"\n"===t[r]&&++r,e.buffer=t.substr(r),n}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var n;if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;var i=(n=r()).match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}for(var s=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(s?s=!1:n=r(),e.state){case"HEADER":/:/.test(n)?oe(n,(function(t,e){}),/:/):n||(e.state="ID");continue;case"NOTE":n||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){e.state="NOTE";break}if(!n)continue;if(e.cue=new ne(0,0,""),e.state="CUE",-1===n.indexOf("--\x3e")){e.cue.id=n;continue}case"CUE":try{ue(n,e.cue,e.regionList)}catch(o){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var a=-1!==n.indexOf("--\x3e");if(!n||a&&(s=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+="\n"),e.cue.text+=n;continue;case"BADCUE":n||(e.state="ID");continue}}}catch(o){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return t.onflush&&t.onflush(),this}};var de=se;function fe(t,e,r,n){for(var i,s,a,o,c,l=[],u=window.VTTCue||TextTrackCue,h=0;h<n.rows.length;h++)if(a=!0,o=0,c="",!(i=n.rows[h]).isEmpty()){for(var d=0;d<i.chars.length;d++)i.chars[d].uchar.match(/\s/)&&a?o++:(c+=i.chars[d].uchar,a=!1);i.cueStartTime=e,e===r&&(r+=1e-4),s=new u(e,r,he(c.trim())),o>=16?o--:o++,navigator.userAgent.match(/Firefox\//)?s.line=h+1:s.line=h>7?h-2:h+1,s.align="left",s.position=Math.max(0,Math.min(100,o/32*100)),l.push(s),t&&t.addCue(s)}return l}var pe,ge={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},me=function(t){var e=t;return ge.hasOwnProperty(t)&&(e=ge[t]),String.fromCharCode(e)},ve=15,ye=100,be={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Ee={17:2,18:4,21:6,22:8,23:10,19:13,20:15},we={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Te={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Se=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(t){t[t.ERROR=0]="ERROR",t[t.TEXT=1]="TEXT",t[t.WARNING=2]="WARNING",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG",t[t.DATA=3]="DATA"}(pe||(pe={}));var _e=function(){function t(){this.time=null,this.verboseLevel=pe.ERROR}return t.prototype.log=function(t,e){this.verboseLevel>=t&&u.logger.log(this.time+" ["+t+"] "+e)},t}(),Ae=function(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].toString(16));return e},Re=function(){function t(t,e,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=e||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}var e=t.prototype;return e.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],r=0;r<e.length;r++){var n=e[r];t.hasOwnProperty(n)&&(this[n]=t[n])}},e.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},e.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},e.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),Ce=function(){function t(t,e,r,n,i,s){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new Re(e,r,n,i,s)}var e=t.prototype;return e.reset=function(){this.uchar=" ",this.penState.reset()},e.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},e.setPenState=function(t){this.penState.copy(t)},e.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},e.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},e.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),ke=function(){function t(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var e=0;e<ye;e++)this.chars.push(new Ce);this.logger=t,this.pos=0,this.currPenState=new Re}var e=t.prototype;return e.equals=function(t){for(var e=!0,r=0;r<ye;r++)if(!this.chars[r].equals(t.chars[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<ye;e++)this.chars[e].copy(t.chars[e])},e.isEmpty=function(){for(var t=!0,e=0;e<ye;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},e.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(pe.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>ye&&(this.logger.log(pe.DEBUG,"Too large cursor position "+this.pos),this.pos=ye)},e.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var r=this.pos+1;r<e+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(e)},e.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.insertChar=function(t){t>=144&&this.backSpace();var e=me(t);this.pos>=ye?this.logger.log(pe.ERROR,"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))},e.clearFromPos=function(t){var e;for(e=t;e<ye;e++)this.chars[e].reset()},e.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.getTextString=function(){for(var t=[],e=!0,r=0;r<ye;r++){var n=this.chars[r].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")},e.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),Oe=function(){function t(t){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var e=0;e<ve;e++)this.rows.push(new ke(t));this.logger=t,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var e=t.prototype;return e.reset=function(){for(var t=0;t<ve;t++)this.rows[t].clear();this.currRow=14},e.equals=function(t){for(var e=!0,r=0;r<ve;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<ve;e++)this.rows[e].copy(t.rows[e])},e.isEmpty=function(){for(var t=!0,e=0;e<ve;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},e.backSpace=function(){this.rows[this.currRow].backSpace()},e.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.insertChar=function(t){this.rows[this.currRow].insertChar(t)},e.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},e.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},e.setCursor=function(t){this.logger.log(pe.INFO,"setCursor: "+t),this.rows[this.currRow].setCursor(t)},e.setPAC=function(t){this.logger.log(pe.INFO,"pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var r=0;r<ve;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var s=i.rows[n].cueStartTime,a=this.logger.time;if(s&&null!==a&&s<a)for(var o=0;o<this.nrRollUpRows;o++)this.rows[e-this.nrRollUpRows+o+1].copy(i.rows[n+o])}}this.currRow=e;var c=this.rows[this.currRow];if(null!==t.indent){var l=t.indent,u=Math.max(l-1,0);c.setCursor(t.indent),t.color=c.chars[u].penState.foreground}var h={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(h)},e.setBkgData=function(t){this.logger.log(pe.INFO,"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},e.setRollUpRows=function(t){this.nrRollUpRows=t},e.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(pe.TEXT,this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(pe.INFO,"Rolling up")}else this.logger.log(pe.DEBUG,"roll_up but nrRollUpRows not set yet")},e.getDisplayText=function(t){t=t||!1;for(var e=[],r="",n=-1,i=0;i<ve;i++){var s=this.rows[i].getTextString();s&&(n=i+1,t?e.push("Row "+n+": '"+s+"'"):e.push(s.trim()))}return e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n")),r},e.getTextAndFormat=function(){return this.rows},t}(),Ie=function(){function t(t,e,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new Oe(r),this.nonDisplayedMemory=new Oe(r),this.lastOutputScreen=new Oe(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var e=t.prototype;return e.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},e.getHandler=function(){return this.outputFilter},e.setHandler=function(t){this.outputFilter=t},e.setPAC=function(t){this.writeScreen.setPAC(t)},e.setBkgData=function(t){this.writeScreen.setBkgData(t)},e.setMode=function(t){t!==this.mode&&(this.mode=t,this.logger.log(pe.INFO,"MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},e.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(pe.INFO,r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(pe.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.ccRCL=function(){this.logger.log(pe.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.ccBS=function(){this.logger.log(pe.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.ccAOF=function(){},e.ccAON=function(){},e.ccDER=function(){this.logger.log(pe.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.ccRU=function(t){this.logger.log(pe.INFO,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},e.ccFON=function(){this.logger.log(pe.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.ccRDC=function(){this.logger.log(pe.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.ccTR=function(){this.logger.log(pe.INFO,"TR"),this.setMode("MODE_TEXT")},e.ccRTD=function(){this.logger.log(pe.INFO,"RTD"),this.setMode("MODE_TEXT")},e.ccEDM=function(){this.logger.log(pe.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.ccCR=function(){this.logger.log(pe.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.ccENM=function(){this.logger.log(pe.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.ccEOC=function(){if(this.logger.log(pe.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(pe.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.ccTO=function(t){this.logger.log(pe.INFO,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},e.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{var r=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(pe.INFO,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},e.outputDataUpdate=function(t){void 0===t&&(t=!1);var e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},e.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}(),De=function(){function t(t,e,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new _e;this.channels=[null,new Ie(t,e,n),new Ie(t+1,r,n)],this.cmdHistory={a:null,b:null},this.logger=n}var e=t.prototype;return e.getHandler=function(t){return this.channels[t].getHandler()},e.setHandler=function(t,e){this.channels[t].setHandler(e)},e.addData=function(t,e){var r,n,i,s=!1;this.logger.time=t;for(var a=0;a<e.length;a+=2)if(n=127&e[a],i=127&e[a+1],0!==n||0!==i){if(this.logger.log(pe.DATA,"["+Ae([e[a],e[a+1]])+"] -> ("+Ae([n,i])+")"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(s=this.parseChars(n,i))){var o=this.currentChannel;o&&o>0?this.channels[o].insertChars(s):this.logger.log(pe.WARNING,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(pe.WARNING,"Couldn't parse cleaned data "+Ae([n,i])+" orig: "+Ae([e[a],e[a+1]]))}},e.parseCmd=function(t,e){var r=this.cmdHistory;if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;if(Le(t,e,r))return xe(null,null,r),this.logger.log(pe.DEBUG,"Repeated command ("+Ae([t,e])+") is dropped"),!0;var n=20===t||21===t||23===t?1:2,i=this.channels[n];return 20===t||21===t||28===t||29===t?32===e?i.ccRCL():33===e?i.ccBS():34===e?i.ccAOF():35===e?i.ccAON():36===e?i.ccDER():37===e?i.ccRU(2):38===e?i.ccRU(3):39===e?i.ccRU(4):40===e?i.ccFON():41===e?i.ccRDC():42===e?i.ccTR():43===e?i.ccRTD():44===e?i.ccEDM():45===e?i.ccCR():46===e?i.ccENM():47===e&&i.ccEOC():i.ccTO(e-32),xe(t,e,r),this.currentChannel=n,!0},e.parseMidrow=function(t,e){var r=0;if((17===t||25===t)&&e>=32&&e<=47){if((r=17===t?1:2)!==this.currentChannel)return this.logger.log(pe.ERROR,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(e),this.logger.log(pe.DEBUG,"MIDROW ("+Ae([t,e])+")"),!0)}return!1},e.parsePAC=function(t,e){var r,n=this.cmdHistory;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;if(Le(t,e,n))return xe(null,null,n),!0;var i=t<=23?1:2;r=e>=64&&e<=95?1===i?be[t]:we[t]:1===i?Ee[t]:Te[t];var s=this.channels[i];return!!s&&(s.setPAC(this.interpretPAC(r,e)),xe(t,e,n),this.currentChannel=i,!0)},e.interpretPAC=function(t,e){var r=e,n={color:null,italics:!1,indent:null,underline:!1,row:t};return r=e>95?e-96:e-64,n.underline=1===(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},e.parseChars=function(t,e){var r,n=null,i=null;if(t>=25?(r=2,i=t-8):(r=1,i=t),i>=17&&i<=19){var s=e;s=17===i?e+80:18===i?e+112:e+144,this.logger.log(pe.INFO,"Special char '"+me(s)+"' in channel "+r),n=[s]}else t>=32&&t<=127&&(n=0===e?[t]:[t,e]);if(n){var a=Ae(n);this.logger.log(pe.DEBUG,"Char codes =  "+a.join(",")),xe(t,e,this.cmdHistory)}return n},e.parseBackgroundAttributes=function(t,e){var r;if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;var n={};16===t||24===t?(r=Math.floor((e-32)/2),n.background=Se[r],e%2===1&&(n.background=n.background+"_semi")):45===e?n.background="transparent":(n.foreground="black",47===e&&(n.underline=!0));var i=t<=23?1:2;return this.channels[i].setBkgData(n),xe(t,e,this.cmdHistory),!0},e.reset=function(){for(var t=0;t<Object.keys(this.channels).length;t++){var e=this.channels[t];e&&e.reset()}this.cmdHistory={a:null,b:null}},e.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++){var r=this.channels[e];r&&r.cueSplitAtTime(t)}},t}();function xe(t,e,r){r.a=t,r.b=e}function Le(t,e,r){return r.a===t&&r.b===e}var Pe=De,Ne=function(){function t(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}var e=t.prototype;return e.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},e.newCue=function(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e.reset=function(){this.cueRanges=[]},t}(),Me=function(t,e,r){return t.substr(r||0,e.length)===e},Fe=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()},Ue={parse:function(t,e,r,n,i,s){var a,o=Object(Mt.utf8ArrayToStr)(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),l="00:00.000",u=0,h=0,d=0,f=[],p=!0,g=!1,m=new de;m.oncue=function(t){var e=r[n],i=r.ccOffset;e&&e.new&&(void 0!==h?i=r.ccOffset=e.start:function(t,e,r){var n=t[e],i=t[n.prevCC];if(!i||!i.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;i&&i.new;)t.ccOffset+=n.start-i.start,n.new=!1,i=t[(n=i).prevCC];t.presentationOffset=r}(r,n,d)),d&&(i=d-r.presentationOffset),g&&(t.startTime+=i-h,t.endTime+=i-h),t.id=Fe(t.startTime.toString())+Fe(t.endTime.toString())+Fe(t.text),t.text=decodeURIComponent(encodeURIComponent(t.text)),t.endTime>0&&f.push(t)},m.onparsingerror=function(t){a=t},m.onflush=function(){a&&s?s(a):i(f)},o.forEach((function(t){if(p){if(Me(t,"X-TIMESTAMP-MAP=")){p=!1,g=!0,t.substr(16).split(",").forEach((function(t){Me(t,"LOCAL:")?l=t.substr(6):Me(t,"MPEGTS:")&&(u=parseInt(t.substr(7)))}));try{e+(9e4*r[n].start||0)<0&&(e+=8589934592),u-=e,h=function(t){var e=parseInt(t.substr(-3)),r=parseInt(t.substr(-6,2)),n=parseInt(t.substr(-9,2)),i=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;if(!Object(c.isFiniteNumber)(e)||!Object(c.isFiniteNumber)(r)||!Object(c.isFiniteNumber)(n)||!Object(c.isFiniteNumber)(i))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t);return e+=1e3*r,(e+=6e4*n)+36e5*i}(l)/1e3,d=u/9e4}catch(i){g=!1,a=i}return}""===t&&(p=!1)}m.parse(t+"\n")})),m.flush()}};function Be(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function je(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}var Ve=function(t){var e,r;function n(e){var r;if((r=t.call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.FRAG_PARSING_USERDATA,l.default.FRAG_DECRYPTED,l.default.MANIFEST_LOADING,l.default.MANIFEST_LOADED,l.default.FRAG_LOADED,l.default.INIT_PTS_FOUND)||this).media=null,r.config=void 0,r.enabled=!0,r.Cues=void 0,r.textTracks=[],r.tracks=[],r.initPTS=[],r.unparsedVttFrags=[],r.captionsTracks={},r.nonNativeCaptionsTracks={},r.captionsProperties=void 0,r.cea608Parser1=void 0,r.cea608Parser2=void 0,r.lastSn=-1,r.prevCC=-1,r.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},r.hls=e,r.config=e.config,r.Cues=e.config.cueHandler,r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode},textTrack3:{label:r.config.captionsTextTrack3Label,languageCode:r.config.captionsTextTrack3LanguageCode},textTrack4:{label:r.config.captionsTextTrack4Label,languageCode:r.config.captionsTextTrack4LanguageCode}},r.config.enableCEA708Captions){var n=new Ne(Be(r),"textTrack1"),i=new Ne(Be(r),"textTrack2"),s=new Ne(Be(r),"textTrack3"),a=new Ne(Be(r),"textTrack4");r.cea608Parser1=new Pe(1,n,i),r.cea608Parser2=new Pe(3,s,a)}return r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.addCues=function(t,e,r,n,i){for(var s,a,o,c,u=!1,h=i.length;h--;){var d=i[h],f=(s=d[0],a=d[1],o=e,c=r,Math.min(a,c)-Math.max(s,o));if(f>=0&&(d[0]=Math.min(d[0],e),d[1]=Math.max(d[1],r),u=!0,f/(r-e)>.5))return}if(u||i.push([e,r]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[t],e,r,n);else{var p=this.Cues.newCue(null,e,r,n);this.hls.trigger(l.default.CUES_PARSED,{type:"captions",cues:p,track:t})}},i.onInitPtsFound=function(t){var e=this,r=t.frag,n=t.id,i=t.initPTS,s=this.unparsedVttFrags;"main"===n&&(this.initPTS[r.cc]=i),s.length&&(this.unparsedVttFrags=[],s.forEach((function(t){e.onFragLoaded(t)})))},i.getExistingTrack=function(t){var e=this.media;if(e)for(var r=0;r<e.textTracks.length;r++){var n=e.textTracks[r];if(n[t])return n}return null},i.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},i.createNativeTrack=function(t){if(!this.captionsTracks[t]){var e=this.captionsProperties,r=this.captionsTracks,n=this.media,i=e[t],s=i.label,a=i.languageCode,o=this.getExistingTrack(t);if(o)r[t]=o,Ut(r[t]),Ft(r[t],n);else{var c=this.createTextTrack("captions",s,a);c&&(c[t]=!0,r[t]=c)}}},i.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var e=this.captionsProperties[t];if(e){var r={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=r,this.hls.trigger(l.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},i.createTextTrack=function(t,e,r){var n=this.media;if(n)return n.addTextTrack(t,e,r)},i.destroy=function(){t.prototype.destroy.call(this)},i.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},i.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach((function(e){Ut(t[e]),delete t[e]})),this.nonNativeCaptionsTracks={}},i.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},i._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var r=0;r<e.length;r++)Ut(e[r])}},i.onManifestLoaded=function(t){var e=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var r=t.subtitles||[],n=this.tracks&&r&&this.tracks.length===r.length;if(this.tracks=t.subtitles||[],this.config.renderTextTracksNatively){var i=this.media?this.media.textTracks:[];this.tracks.forEach((function(t,r){var n;if(r<i.length){for(var s=null,a=0;a<i.length;a++)if(je(i[a],t)){s=i[a];break}s&&(n=s)}n||(n=e.createTextTrack("subtitles",t.name,t.lang)),t.default?n.mode=e.hls.subtitleDisplay?"showing":"hidden":n.mode="disabled",e.textTracks.push(n)}))}else if(!n&&this.tracks&&this.tracks.length){var s=this.tracks.map((function(t){return{label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t}}));this.hls.trigger(l.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:s})}}this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(t){var r=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(r){var n="textTrack"+r[1],i=e.captionsProperties[n];i&&(i.label=t.name,t.lang&&(i.languageCode=t.lang),i.media=t)}}))},i.onFragLoaded=function(t){var e=t.frag,r=t.payload,n=this.cea608Parser1,i=this.cea608Parser2,s=this.initPTS,a=this.lastSn,o=this.unparsedVttFrags;if("main"===e.type){var u=e.sn;e.sn!==a+1&&n&&i&&(n.reset(),i.reset()),this.lastSn=u}else if("subtitle"===e.type)if(r.byteLength){if(!Object(c.isFiniteNumber)(s[e.cc]))return o.push(t),void(s.length&&this.hls.trigger(l.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e}));var h=e.decryptdata;null!=h&&null!=h.key&&"AES-128"===h.method||this._parseVTTs(e,r)}else this.hls.trigger(l.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},i._parseVTTs=function(t,e){var r=this,n=this.hls,i=this.prevCC,s=this.textTracks,a=this.vttCCs;a[t.cc]||(a[t.cc]={start:t.start,prevCC:i,new:!0},this.prevCC=t.cc),Ue.parse(e,this.initPTS[t.cc],a,t.cc,(function(e){if(r.config.renderTextTracksNatively){var i=s[t.level];if("disabled"===i.mode)return void n.trigger(l.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t});e.forEach((function(t){if(!i.cues.getCueById(t.id))try{if(i.addCue(t),!i.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){u.logger.debug("Failed occurred on adding cues: "+r);var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,i.addCue(e)}}))}else{var a=r.tracks[t.level].default?"default":"subtitles"+t.level;n.trigger(l.default.CUES_PARSED,{type:"subtitles",cues:e,track:a})}n.trigger(l.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}),(function(e){u.logger.log("Failed to parse VTT cue: "+e),n.trigger(l.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})}))},i.onFragDecrypted=function(t){var e=t.frag,r=t.payload;if("subtitle"===e.type){if(!Object(c.isFiniteNumber)(this.initPTS[e.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(e,r)}},i.onFragParsingUserdata=function(t){var e=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&e&&r)for(var n=0;n<t.samples.length;n++){var i=t.samples[n].bytes;if(i){var s=this.extractCea608Data(i);e.addData(t.samples[n].pts,s[0]),r.addData(t.samples[n].pts,s[1])}}},i.extractCea608Data=function(t){for(var e=31&t[0],r=2,n=[[],[]],i=0;i<e;i++){var s=t[r++],a=127&t[r++],o=127&t[r++],c=3&s;0===a&&0===o||0!==(4&s)&&(0!==c&&1!==c||(n[c].push(a),n[c].push(o)))}return n},n}(f);function Ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ke(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];"subtitles"===n.kind&&n.label&&e.push(t[r])}return e}var He,ze=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.MANIFEST_LOADED,l.default.SUBTITLE_TRACK_LOADED)||this).tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,o=n.prototype;return o.destroy=function(){f.prototype.destroy.call(this)},o.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(Object(c.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){e.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},o.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(c.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Ke(this.media.textTracks).forEach((function(t){Ut(t)})),this.subtitleTrack=-1,this.media=null)},o.onManifestLoaded=function(t){var e=this,r=t.subtitles||[];this.tracks=r,this.hls.trigger(l.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach((function(t){t.default&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)}))},o.onSubtitleTrackLoaded=function(t){var e=this,r=t.id,n=t.details,i=this.trackId,s=this.tracks,a=s[i];if(r>=s.length||r!==i||!a||this.stopped)this._clearReloadTimer();else if(u.logger.log("subtitle track "+r+" loaded"),n.live){var o=st(a.details,n,t.stats.trequest);u.logger.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout((function(){e._loadCurrentTrack()}),o)}else this._clearReloadTimer()},o.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},o.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},o._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},o._loadCurrentTrack=function(){var t=this.trackId,e=this.tracks,r=this.hls,n=e[t];t<0||!n||n.details&&!n.details.live||(u.logger.log("Loading subtitle track "+t),r.trigger(l.default.SUBTITLE_TRACK_LOADING,{url:n.url,id:t}))},o._toggleTrackModes=function(t){var e=this.media,r=this.subtitleDisplay,n=this.trackId;if(e){var i=Ke(e.textTracks);if(-1===t)[].slice.call(i).forEach((function(t){t.mode="disabled"}));else{var s=i[n];s&&(s.mode="disabled")}var a=i[t];a&&(a.mode=r?"showing":"hidden")}},o._setSubtitleTrackInternal=function(t){var e=this.hls,r=this.tracks;!Object(c.isFiniteNumber)(t)||t<-1||t>=r.length||(this.trackId=t,u.logger.log("Switching to subtitle track "+t),e.trigger(l.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},o._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var t=-1,e=Ke(this.media.textTracks),r=0;r<e.length;r++)if("hidden"===e[r].mode)t=r;else if("showing"===e[r].mode){t=r;break}this.subtitleTrack=t}},i=n,(s=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&(this._toggleTrackModes(t),this._setSubtitleTrackInternal(t))}}])&&Ge(i.prototype,s),a&&Ge(i,a),n}(f),qe=r("./src/crypt/decrypter.js"),We=window.performance,Ye=function(t){var e,r;function n(e,r){var n;return(n=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.ERROR,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.SUBTITLE_TRACKS_UPDATED,l.default.SUBTITLE_TRACK_SWITCH,l.default.SUBTITLE_TRACK_LOADED,l.default.SUBTITLE_FRAG_PROCESSED,l.default.LEVEL_UPDATED)||this).fragmentTracker=r,n.config=e.config,n.state=gt,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new qe.default(e,e.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)),n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i=n.prototype;return i.startLoad=function(){this.stopLoad(),this.state=vt;var t=this.tracks[this.currentTrackId];t&&t.details&&(this.setInterval(500),this.tick())},i.onSubtitleFragProcessed=function(t){var e=t.frag,r=t.success;if(this.fragPrevious=e,this.state=vt,r){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var i,s=e.start,a=0;a<n.length;a++)if(s>=n[a].start&&s<=n[a].end){i=n[a];break}var o=e.start+e.duration;i?i.end=o:(i={start:s,end:o},n.push(i))}}},i.onMediaAttached=function(t){var e=t.media;this.media=e,e.addEventListener("seeking",this._onMediaSeeking),this.state=vt},i.onMediaDetaching=function(){var t=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]})),this.media=null,this.state=gt)},i.onError=function(t){var e=t.frag;e&&"subtitle"===e.type&&(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=vt)},i.onSubtitleTracksUpdated=function(t){var e=this;u.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=t.subtitleTracks,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]}))},i.onSubtitleTrackSwitch=function(t){if(this.currentTrackId=t.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var e=this.tracks[this.currentTrackId];e&&e.details&&this.setInterval(500)}else this.clearInterval()},i.onSubtitleTrackLoaded=function(t){var e=t.id,r=t.details,n=this.currentTrackId,i=this.tracks,s=i[n];e>=i.length||e!==n||!s||(r.live&&function(t,e,r){void 0===r&&(r=0);var n=-1;it(t,e,(function(t,e,r){e.start=t.start,n=r}));var i=e.fragments;if(n<0)i.forEach((function(t){t.start+=r}));else for(var s=n+1;s<i.length;s++)i[s].start=i[s-1].start+i[s-1].duration}(s.details,r,this.lastAVStart),s.details=r,this.setInterval(500))},i.onKeyLoaded=function(){this.state===bt&&(this.state=vt)},i.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag.decryptdata,n=t.frag,i=this.hls;if(this.state===Et&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&t.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var s=We.now();this.decrypter.decrypt(t.payload,r.key.buffer,r.iv.buffer,(function(t){var e=We.now();i.trigger(l.default.FRAG_DECRYPTED,{frag:n,payload:t,stats:{tstart:s,tdecrypt:e}})}))}},i.onLevelUpdated=function(t){var e=t.details.fragments;this.lastAVStart=e.length?e[0].start:0},i.doTick=function(){if(this.media)switch(this.state){case vt:var t=this.config,e=this.currentTrackId,r=this.fragmentTracker,n=this.media,i=this.tracks;if(!i||!i[e]||!i[e].details)break;var s,a=t.maxBufferHole,o=t.maxFragLookUpTolerance,c=Math.min(t.maxBufferLength,t.maxMaxBufferLength),h=H.bufferedInfo(this._getBuffered(),n.currentTime,a),d=h.end,f=h.len,p=i[e].details,g=p.fragments,m=g.length,v=g[m-1].start+g[m-1].duration;if(f>c)return;var y=this.fragPrevious;d<v?(y&&p.hasProgramDateTime&&(s=lt(g,y.endProgramDateTime,o)),s||(s=ut(y,g,d,o))):s=g[m-1],s&&s.encrypted?(u.logger.log("Loading key for "+s.sn),this.state=bt,this.hls.trigger(l.default.KEY_LOADING,{frag:s})):s&&r.getState(s)===U&&(this.fragCurrent=s,this.state=Et,this.hls.trigger(l.default.FRAG_LOADING,{frag:s}))}else this.state=vt},i.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,t.prototype.stopLoad.call(this)},i._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},i.onMediaSeeking=function(){if(this.fragCurrent){var t=this.media?this.media.currentTime:0,e=this.config.maxFragLookUpTolerance,r=this.fragCurrent.start-e,n=this.fragCurrent.start+this.fragCurrent.duration+e;(t<r||t>n)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=vt,this.tick())}},n}(It);!function(t){t.WIDEVINE="com.widevine.alpha",t.PLAYREADY="com.microsoft.playready"}(He||(He={}));var Ze="undefined"!==typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Qe=function(t){var e,r;function n(e){var r;return(r=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHED,l.default.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(t){if(u.logger.log('Media is encrypted using "'+t.initDataType+'" init data type'),!r.mediaKeysPromise)return u.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void r.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var e=function(e){r._media&&(r._attemptSetMediaKeys(e),r._generateRequestWithPreferredKeySession(t.initDataType,t.initData))};r.mediaKeysPromise.then(e).catch(e)},r._config=e.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=e.config.drmSystemOptions,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var i,s,a,c=n.prototype;return c.getLicenseServerUrl=function(t){switch(t){case He.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},c._attemptKeySystemAccess=function(t,e,r){var n=this,i=function(t,e,r,n){if(t===He.WIDEVINE)return function(t,e,r){var n={audioCapabilities:[],videoCapabilities:[]};return t.forEach((function(t){n.audioCapabilities.push({contentType:'audio/mp4; codecs="'+t+'"',robustness:r.audioRobustness||""})})),e.forEach((function(t){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"',robustness:r.videoRobustness||""})})),[n]}(e,r,n);throw new Error("Unknown key-system: "+t)}(t,e,r,this._drmSystemOptions);u.logger.log("Requesting encrypted media key-system access");var s=this.requestMediaKeySystemAccess(t,i);this.mediaKeysPromise=s.then((function(e){return n._onMediaKeySystemAccessObtained(t,e)})),s.catch((function(e){u.logger.error('Failed to obtain key-system "'+t+'" access:',e)}))},c._onMediaKeySystemAccessObtained=function(t,e){var r=this;u.logger.log('Access for key-system "'+t+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(n);var i=Promise.resolve().then((function(){return e.createMediaKeys()})).then((function(e){return n.mediaKeys=e,u.logger.log('Media-keys created for key-system "'+t+'"'),r._onMediaKeysCreated(),e}));return i.catch((function(t){u.logger.error("Failed to create media-keys:",t)})),i},c._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach((function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))}))},c._onNewMediaKeySession=function(t){var e=this;u.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",(function(r){e._onKeySessionMessage(t,r.message)}),!1)},c._onKeySessionMessage=function(t,e){u.logger.log("Got EME message event, creating license request"),this._requestLicense(e,(function(e){u.logger.log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session"),t.update(e)}))},c._attemptSetMediaKeys=function(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return u.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});u.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},c._generateRequestWithPreferredKeySession=function(t,e){var r=this,n=this._mediaKeysList[0];if(!n)return u.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)u.logger.warn("Key-Session already initialized but requested again");else{var i=n.mediaKeysSession;if(!i)return u.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!e)return u.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});u.logger.log('Generating key-session request for "'+t+'" init data type'),n.mediaKeysSessionInitialized=!0,i.generateRequest(t,e).then((function(){u.logger.debug("Key-session generation succeeded")})).catch((function(t){u.logger.error("Error generating key-session request:",t),r.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},c._createLicenseXhr=function(t,e,r){var n=new XMLHttpRequest,i=this._licenseXhrSetup;try{if(i)try{i(n,t)}catch(s){n.open("POST",t,!0),i(n,t)}n.readyState||n.open("POST",t,!0)}catch(s){throw new Error("issue setting up KeySystem license XHR "+s)}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,t,e,r),n},c._onLicenseRequestReadyStageChange=function(t,e,r,n){if(4===t.readyState)if(200===t.status)this._requestLicenseFailureCount=0,u.logger.log("License request succeeded"),"arraybuffer"!==t.responseType&&u.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),n(t.response);else{if(u.logger.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var i=3-this._requestLicenseFailureCount+1;u.logger.warn("Retrying license request, "+i+" attempts left"),this._requestLicense(r,n)}},c._generateLicenseRequestChallenge=function(t,e){if(t.mediaKeySystemDomain===He.WIDEVINE)return e;throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},c._requestLicense=function(t,e){u.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return u.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var n=this.getLicenseServerUrl(r.mediaKeySystemDomain),i=this._createLicenseXhr(n,t,e);u.logger.log("Sending license request to URL: "+n);var s=this._generateLicenseRequestChallenge(r,t);i.send(s)}catch(a){u.logger.error("Failure requesting DRM license: "+a),this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},c.onMediaAttached=function(t){if(this._emeEnabled){var e=t.media;this._media=e,e.addEventListener("encrypted",this._onMediaEncrypted)}},c.onMediaDetached=function(){var t=this._media,e=this._mediaKeysList;t&&(t.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(e.map((function(t){if(t.mediaKeysSession)return t.mediaKeysSession.close().catch((function(){}))}))).then((function(){return t.setMediaKeys(null)})).catch((function(){})))},c.onManifestParsed=function(t){if(this._emeEnabled){var e=t.levels.map((function(t){return t.audioCodec})),r=t.levels.map((function(t){return t.videoCodec}));this._attemptKeySystemAccess(He.WIDEVINE,e,r)}},i=n,(s=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Xe(i.prototype,s),a&&Xe(i,a),n}(f);function $e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Je(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$e(Object(r),!0).forEach((function(e){tr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function tr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var er=Je(Je({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Qt,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Ht,bufferController:qt,capLevelController:Yt,fpsController:Xt,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ze,testBandwidth:!0},{cueHandler:n,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Ye,subtitleTrackController:ze,timelineController:Ve,audioStreamController:re,audioTrackController:Jt,emeController:Qe});function rr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function nr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?rr(Object(r),!0).forEach((function(e){ir(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ir(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ar(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function or(t,e,r){return e&&ar(t.prototype,e),r&&ar(t,r),t}var cr=function(t){var e,r;function n(e){var r;void 0===e&&(e={}),(r=t.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var i=n.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");r.config=nr(nr({},i),e);var s=sr(r).config;if(void 0!==s.liveMaxLatencyDurationCount&&s.liveMaxLatencyDurationCount<=s.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==s.liveMaxLatencyDuration&&(void 0===s.liveSyncDuration||s.liveMaxLatencyDuration<=s.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(u.enableLogs)(s.debug),r._autoLevelCapping=-1;var a=r.abrController=new s.abrController(sr(r)),o=new s.bufferController(sr(r)),c=r.capLevelController=new s.capLevelController(sr(r)),l=new s.fpsController(sr(r)),h=new N(sr(r)),d=new M(sr(r)),f=new F(sr(r)),p=new Bt(sr(r)),g=r.levelController=new Nt(sr(r)),m=new G(sr(r)),v=[g,r.streamController=new Lt(sr(r),m)],y=s.audioStreamController;y&&v.push(new y(sr(r),m)),r.networkControllers=v;var b=[h,d,f,a,o,c,l,p,m];if(y=s.audioTrackController){var E=new y(sr(r));r.audioTrackController=E,b.push(E)}if(y=s.subtitleTrackController){var w=new y(sr(r));r.subtitleTrackController=w,v.push(w)}if(y=s.emeController){var T=new y(sr(r));r.emeController=T,b.push(T)}return(y=s.subtitleStreamController)&&v.push(new y(sr(r),m)),(y=s.timelineController)&&b.push(new y(sr(r))),r.coreComponents=b,r}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n.isSupported=function(){return function(){var t=Y();if(!t)return!1;var e=self.SourceBuffer||self.WebKitSourceBuffer,r=t&&"function"===typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&"function"===typeof e.prototype.appendBuffer&&"function"===typeof e.prototype.remove;return!!r&&!!n}()},or(n,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return l.default}},{key:"ErrorTypes",get:function(){return o.ErrorTypes}},{key:"ErrorDetails",get:function(){return o.ErrorDetails}},{key:"DefaultConfig",get:function(){return n.defaultConfig?n.defaultConfig:er},set:function(t){n.defaultConfig=t}}]);var i=n.prototype;return i.destroy=function(){u.logger.log("destroy"),this.trigger(l.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(t){t.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},i.attachMedia=function(t){u.logger.log("attachMedia"),this.media=t,this.trigger(l.default.MEDIA_ATTACHING,{media:t})},i.detachMedia=function(){u.logger.log("detachMedia"),this.trigger(l.default.MEDIA_DETACHING),this.media=null},i.loadSource=function(t){t=a.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),u.logger.log("loadSource:"+t),this.url=t,this.trigger(l.default.MANIFEST_LOADING,{url:t})},i.startLoad=function(t){void 0===t&&(t=-1),u.logger.log("startLoad("+t+")"),this.networkControllers.forEach((function(e){e.startLoad(t)}))},i.stopLoad=function(){u.logger.log("stopLoad"),this.networkControllers.forEach((function(t){t.stopLoad()}))},i.swapAudioCodec=function(){u.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},i.recoverMediaError=function(){u.logger.log("recoverMediaError");var t=this.media;this.detachMedia(),t&&this.attachMedia(t)},i.removeLevel=function(t,e){void 0===e&&(e=0),this.levelController.removeLevel(t,e)},or(n,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){u.logger.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){u.logger.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){u.logger.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){u.logger.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){u.logger.log("set startLevel:"+t),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function(t){var e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){u.logger.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,e=this.config.minAutoBitrate,r=t?t.length:0,n=0;n<r;n++)if((t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate)>e)return n;return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,e=this.autoLevelCapping;return-1===e&&t&&t.length?t.length-1:e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}}]),n}(X);cr.defaultConfig=void 0},"./src/polyfills/number.js":function(t,e,r){"use strict";r.r(e),r.d(e,"isFiniteNumber",(function(){return n})),r.d(e,"MAX_SAFE_INTEGER",(function(){return i}));var n=Number.isFinite||function(t){return"number"===typeof t&&isFinite(t)},i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(t,e,r){"use strict";function n(){return"undefined"===typeof window?self:window}r.r(e),r.d(e,"getSelfScope",(function(){return n}))},"./src/utils/logger.js":function(t,e,r){"use strict";r.r(e),r.d(e,"enableLogs",(function(){return l})),r.d(e,"logger",(function(){return u}));var n=r("./src/utils/get-self-scope.js");function i(){}var s={trace:i,debug:i,log:i,warn:i,info:i,error:i},a=s,o=Object(n.getSelfScope)();function c(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.forEach((function(e){a[e]=t[e]?t[e].bind(t):function(t){var e=o.console[t];return e?function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n[0]&&(n[0]=function(t,e){return"["+t+"] > "+e}(t,n[0])),e.apply(o.console,n)}:i}(e)}))}var l=function(t){if(o.console&&!0===t||"object"===typeof t){c(t,"debug","log","info","warn","error");try{a.log()}catch(e){a=s}}else a=s},u=a}}).default},t.exports=e())},1729:(t,e,r)=>{"use strict";var n=r(7201);function i(){}function s(){}s.resetWarningCache=i,t.exports=function(){function t(t,e,r,i,s,a){if(a!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function e(){return t}t.isRequired=t;var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:s,resetWarningCache:i};return r.PropTypes=r,r}},5192:(t,e,r)=>{t.exports=r(1729)()},7201:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7387:(t,e,r)=>{"use strict";r.d(e,{yh:()=>dt});var n=r(9165),i=r.n(n),s=r(7313);function a(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function o(t){return!!t&&!!t[X]}function c(t){var e;return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===Q}(t)||Array.isArray(t)||!!t[Z]||!!(null===(e=t.constructor)||void 0===e?void 0:e[Z])||g(t)||m(t))}function l(t,e,r){void 0===r&&(r=!1),0===u(t)?(r?Object.keys:$)(t).forEach((function(n){r&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(r,n){return e(n,r,t)}))}function u(t){var e=t[X];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:g(t)?2:m(t)?3:0}function h(t,e){return 2===u(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function d(t,e){return 2===u(t)?t.get(e):t[e]}function f(t,e,r){var n=u(t);2===n?t.set(e,r):3===n?t.add(r):t[e]=r}function p(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function g(t){return z&&t instanceof Map}function m(t){return q&&t instanceof Set}function v(t){return t.o||t.t}function y(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=J(t);delete e[X];for(var r=$(e),n=0;n<r.length;n++){var i=r[n],s=e[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[i]})}return Object.create(Object.getPrototypeOf(t),e)}function b(t,e){return void 0===e&&(e=!1),w(t)||o(t)||!c(t)||(u(t)>1&&(t.set=t.add=t.clear=t.delete=E),Object.freeze(t),e&&l(t,(function(t,e){return b(e,!0)}),!0)),t}function E(){a(2)}function w(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function T(t){var e=tt[t];return e||a(18,t),e}function S(t,e){tt[t]||(tt[t]=e)}function _(){return K}function A(t,e){e&&(T("Patches"),t.u=[],t.s=[],t.v=e)}function R(t){C(t),t.p.forEach(O),t.p=null}function C(t){t===K&&(K=t.l)}function k(t){return K={p:[],l:K,h:t,m:!0,_:0}}function O(t){var e=t[X];0===e.i||1===e.i?e.j():e.g=!0}function I(t,e){e._=e.p.length;var r=e.p[0],n=void 0!==t&&t!==r;return e.h.O||T("ES5").S(e,t,n),n?(r[X].P&&(R(e),a(4)),c(t)&&(t=D(e,t),e.l||L(e,t)),e.u&&T("Patches").M(r[X].t,t,e.u,e.s)):t=D(e,r,[]),R(e),e.u&&e.v(e.u,e.s),t!==Y?t:void 0}function D(t,e,r){if(w(e))return e;var n=e[X];if(!n)return l(e,(function(i,s){return x(t,n,e,i,s,r)}),!0),e;if(n.A!==t)return e;if(!n.P)return L(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=y(n.k):n.o,s=i,a=!1;3===n.i&&(s=new Set(i),i.clear(),a=!0),l(s,(function(e,s){return x(t,n,i,e,s,r,a)})),L(t,i,!1),r&&t.u&&T("Patches").N(n,r,t.u,t.s)}return n.o}function x(t,e,r,n,i,s,a){if(o(i)){var l=D(t,i,s&&e&&3!==e.i&&!h(e.R,n)?s.concat(n):void 0);if(f(r,n,l),!o(l))return;t.m=!1}else a&&r.add(i);if(c(i)&&!w(i)){if(!t.h.D&&t._<1)return;D(t,i),e&&e.A.l||L(t,i)}}function L(t,e,r){void 0===r&&(r=!1),!t.l&&t.h.D&&t.m&&b(e,r)}function P(t,e){var r=t[X];return(r?v(r):t)[e]}function N(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function M(t){t.P||(t.P=!0,t.l&&M(t.l))}function F(t){t.o||(t.o=y(t.t))}function U(t,e,r){var n=g(e)?T("MapSet").F(e,r):m(e)?T("MapSet").T(e,r):t.O?function(t,e){var r=Array.isArray(t),n={i:r?1:0,A:e?e.A:_(),P:!1,I:!1,R:{},l:e,t:t,k:null,o:null,j:null,C:!1},i=n,s=et;r&&(i=[n],s=rt);var a=Proxy.revocable(i,s),o=a.revoke,c=a.proxy;return n.k=c,n.j=o,c}(e,r):T("ES5").J(e,r);return(r?r.A:_()).p.push(n),n}function B(t){return o(t)||a(22,t),function t(e){if(!c(e))return e;var r,n=e[X],i=u(e);if(n){if(!n.P&&(n.i<4||!T("ES5").K(n)))return n.t;n.I=!0,r=j(e,i),n.I=!1}else r=j(e,i);return l(r,(function(e,i){n&&d(n.t,e)===i||f(r,e,t(i))})),3===i?new Set(r):r}(t)}function j(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return y(t)}function V(){function t(e){if(!c(e))return e;if(Array.isArray(e))return e.map(t);if(g(e))return new Map(Array.from(e.entries()).map((function(e){return[e[0],t(e[1])]})));if(m(e))return new Set(Array.from(e).map(t));var r=Object.create(Object.getPrototypeOf(e));for(var n in e)r[n]=t(e[n]);return h(e,Z)&&(r[Z]=e[Z]),r}function e(e){return o(e)?t(e):e}var r="add";S("Patches",{$:function(e,n){return n.forEach((function(n){for(var i=n.path,s=n.op,o=e,c=0;c<i.length-1;c++){var l=u(o),h=i[c];"string"!=typeof h&&"number"!=typeof h&&(h=""+h),0!==l&&1!==l||"__proto__"!==h&&"constructor"!==h||a(24),"function"==typeof o&&"prototype"===h&&a(24),"object"!=typeof(o=d(o,h))&&a(15,i.join("/"))}var f=u(o),p=t(n.value),g=i[i.length-1];switch(s){case"replace":switch(f){case 2:return o.set(g,p);case 3:a(16);default:return o[g]=p}case r:switch(f){case 1:return"-"===g?o.push(p):o.splice(g,0,p);case 2:return o.set(g,p);case 3:return o.add(p);default:return o[g]=p}case"remove":switch(f){case 1:return o.splice(g,1);case 2:return o.delete(g);case 3:return o.delete(n.value);default:return delete o[g]}default:a(17,s)}})),e},N:function(t,n,i,s){switch(t.i){case 0:case 4:case 2:return function(t,n,i,s){var a=t.t,o=t.o;l(t.R,(function(t,c){var l=d(a,t),u=d(o,t),f=c?h(a,t)?"replace":r:"remove";if(l!==u||"replace"!==f){var p=n.concat(t);i.push("remove"===f?{op:f,path:p}:{op:f,path:p,value:u}),s.push(f===r?{op:"remove",path:p}:"remove"===f?{op:r,path:p,value:e(l)}:{op:"replace",path:p,value:e(l)})}}))}(t,n,i,s);case 5:case 1:return function(t,n,i,s){var a=t.t,o=t.R,c=t.o;if(c.length<a.length){var l=[c,a];a=l[0],c=l[1];var u=[s,i];i=u[0],s=u[1]}for(var h=0;h<a.length;h++)if(o[h]&&c[h]!==a[h]){var d=n.concat([h]);i.push({op:"replace",path:d,value:e(c[h])}),s.push({op:"replace",path:d,value:e(a[h])})}for(var f=a.length;f<c.length;f++){var p=n.concat([f]);i.push({op:r,path:p,value:e(c[f])})}a.length<c.length&&s.push({op:"replace",path:n.concat(["length"]),value:a.length})}(t,n,i,s);case 3:return function(t,e,n,i){var s=t.t,a=t.o,o=0;s.forEach((function(t){if(!a.has(t)){var s=e.concat([o]);n.push({op:"remove",path:s,value:t}),i.unshift({op:r,path:s,value:t})}o++})),o=0,a.forEach((function(t){if(!s.has(t)){var a=e.concat([o]);n.push({op:r,path:a,value:t}),i.unshift({op:"remove",path:a,value:t})}o++}))}(t,n,i,s)}},M:function(t,e,r,n){r.push({op:"replace",path:[],value:e===Y?void 0:e}),n.push({op:"replace",path:[],value:t})}})}var G,K,H="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),z="undefined"!=typeof Map,q="undefined"!=typeof Set,W="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Y=H?Symbol.for("immer-nothing"):((G={})["immer-nothing"]=!0,G),Z=H?Symbol.for("immer-draftable"):"__$immer_draftable",X=H?Symbol.for("immer-state"):"__$immer_state",Q=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),$="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,J=Object.getOwnPropertyDescriptors||function(t){var e={};return $(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e},tt={},et={get:function(t,e){if(e===X)return t;var r=v(t);if(!h(r,e))return function(t,e,r){var n,i=N(e,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(t.k):void 0}(t,r,e);var n=r[e];return t.I||!c(n)?n:n===P(t.t,e)?(F(t),t.o[e]=U(t.A.h,n,t)):n},has:function(t,e){return e in v(t)},ownKeys:function(t){return Reflect.ownKeys(v(t))},set:function(t,e,r){var n=N(v(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var i=P(v(t),e),s=null==i?void 0:i[X];if(s&&s.t===r)return t.o[e]=r,t.R[e]=!1,!0;if(p(r,i)&&(void 0!==r||h(t.t,e)))return!0;F(t),M(t)}return t.o[e]===r&&(void 0!==r||e in t.o)||Number.isNaN(r)&&Number.isNaN(t.o[e])||(t.o[e]=r,t.R[e]=!0),!0},deleteProperty:function(t,e){return void 0!==P(t.t,e)||e in t.t?(t.R[e]=!1,F(t),M(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=v(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty:function(){a(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){a(12)}},rt={};l(et,(function(t,e){rt[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),rt.deleteProperty=function(t,e){return rt.set.call(this,t,e,void 0)},rt.set=function(t,e,r){return et.set.call(this,t[0],e,r,t[0])};var nt=function(){function t(t){var e=this;this.O=W,this.D=!0,this.produce=function(t,r,n){if("function"==typeof t&&"function"!=typeof r){var i=r;r=t;var s=e;return function(t){var e=this;void 0===t&&(t=i);for(var n=arguments.length,a=Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return s.produce(t,(function(t){var n;return(n=r).call.apply(n,[e,t].concat(a))}))}}var o;if("function"!=typeof r&&a(6),void 0!==n&&"function"!=typeof n&&a(7),c(t)){var l=k(e),u=U(e,t,void 0),h=!0;try{o=r(u),h=!1}finally{h?R(l):C(l)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(t){return A(l,n),I(t,l)}),(function(t){throw R(l),t})):(A(l,n),I(o,l))}if(!t||"object"!=typeof t){if(void 0===(o=r(t))&&(o=t),o===Y&&(o=void 0),e.D&&b(o,!0),n){var d=[],f=[];T("Patches").M(t,o,d,f),n(d,f)}return o}a(21,t)},this.produceWithPatches=function(t,r){if("function"==typeof t)return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return e.produceWithPatches(r,(function(e){return t.apply(void 0,[e].concat(i))}))};var n,i,s=e.produce(t,r,(function(t,e){n=t,i=e}));return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(t){return[t,n,i]})):[s,n,i]},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){c(t)||a(8),o(t)&&(t=B(t));var e=k(this),r=U(this,t,void 0);return r[X].C=!0,C(e),r},e.finishDraft=function(t,e){var r=(t&&t[X]).A;return A(r,e),I(void 0,r)},e.setAutoFreeze=function(t){this.D=t},e.setUseProxies=function(t){t&&!W&&a(20),this.O=t},e.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}r>-1&&(e=e.slice(r+1));var i=T("Patches").$;return o(t)?i(t,e):this.produce(t,(function(t){return i(t,e)}))},t}(),it=new nt,st=it.produce,at=it.produceWithPatches.bind(it),ot=(it.setAutoFreeze.bind(it),it.setUseProxies.bind(it),it.applyPatches.bind(it));it.createDraft.bind(it),it.finishDraft.bind(it);function ct(t,e,r){const n=(0,s.useRef)({state:void 0,initialized:!1});n.current.initialized||(n.current.state=e?e(t.getRawState()):t.getRawState(),n.current.initialized=!0);const[,a]=(0,s.useState)(0);if((0,s.useEffect)((()=>{const r={shouldUpdate:!0};function s(){if(r.shouldUpdate){const s=e?e(t.getRawState()):t.getRawState();i()(n.current.state,s)||r.shouldUpdate&&(n.current.state=s,a((t=>t+1)))}}return t._addUpdateListener(s),s(),()=>{r.shouldUpdate=!1,t._removeUpdateListener(s)}}),null!==r&&void 0!==r?r:[]),void 0!==r){const a=(0,s.useRef)(r);i()(r,a)||(n.current.state=e(t.getRawState()))}return n.current.state}function lt(t,e){const r=(0,s.useRef)();if(null==r.current&&(r.current=new dt(t)),void 0!==e){const n=(0,s.useRef)(e);i()(e,n)||(r.current=new dt(t))}return r.current}const ut={storeOrdinal:0,batching:!1,flushStores:{}};V();const ht="~._.~";class dt{constructor(t){if(this.updateListeners=[],this.ssr=!1,this.reactions=[],this.clientSubscriptions=[],this.reactionCreators=[],this.optimizedUpdateListeners={},this.optimizedUpdateListenerPaths={},this.optimizedListenerPropertyMap={},this._optListenerCount=0,this._patchListeners=[],t instanceof Function){const e=t();this.currentState=e,this.initialState=e,this.createInitialState=t}else this.currentState=t,this.initialState=t,this.createInitialState=()=>t;this.internalOrdId=ut.storeOrdinal++}_setInternalOptions(t){let{ssr:e,reactionCreators:r=[]}=t;this.ssr=e,this.reactionCreators=r,this.reactions=r.map((t=>t(this)))}_getReactionCreators(){return this.reactionCreators}_instantiateReactions(){this.reactions=this.reactionCreators.map((t=>t(this)))}_getInitialState(){return this.createInitialState()}_updateStateWithoutReaction(t){this.currentState=t}_updateState(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.currentState=t,this.batchState=void 0;for(const r of this.reactions)e.push(...r());if(!this.ssr){for(const t of this.clientSubscriptions)t();if(e.length>0){const t=new Set;for(const r of e)if(this.optimizedListenerPropertyMap[r])for(const e of this.optimizedListenerPropertyMap[r])t.add(e);for(const e of t.values())this.optimizedUpdateListeners[e]&&this.optimizedUpdateListeners[e]()}this.updateListeners.forEach((t=>t()))}}_addUpdateListener(t){this.updateListeners.push(t)}_removeUpdateListener(t){this.updateListeners=this.updateListeners.filter((e=>e!==t))}_removeUpdateListenerOpt(t){const e=this.optimizedUpdateListenerPaths[t];for(const r of e)this.optimizedListenerPropertyMap[r]=this.optimizedListenerPropertyMap[r].filter((e=>e!==t));delete this.optimizedUpdateListenerPaths[t],delete this.optimizedUpdateListeners[t],this._optListenerCount--}listenToPatches(t){return this._patchListeners.push(t),()=>{this._patchListeners=this._patchListeners.filter((e=>e!==t))}}subscribe(t,e){if(!this.ssr){const r=function(t,e,r){let n=e(t.getRawState());return()=>{const s=t.getRawState(),a=e(s);i()(a,n)||(r(a,s,n),n=a)}}(this,t,e);return this.clientSubscriptions.push(r),()=>{this.clientSubscriptions=this.clientSubscriptions.filter((t=>t!==r))}}return()=>{console.warn("Pullstate: Subscriptions made on the server side are not registered - so therefor this call to unsubscribe does nothing.")}}createReaction(t,e){let{runNow:r=!1,runNowWithSideEffects:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=function(t,e){return r=>{let n=t(r.getRawState());return function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const a=r.getRawState(),o=t(a);if(s||!i()(o,n))if(r._optListenerCount>0){const[t,i,s]=at(a,(t=>e(o,t,a,n)));if(r._updateStateWithoutReaction(t),n=o,i.length>0)return r._patchListeners.forEach((t=>t(i,s))),Object.keys(ft(i))}else{if(r._patchListeners.length>0){const[t,i,s]=at(a,(t=>e(o,t,a,n)));i.length>0&&r._patchListeners.forEach((t=>t(i,s))),r._updateStateWithoutReaction(t)}else r._updateStateWithoutReaction(st(a,(t=>e(o,t,a,n))));n=o}return[]}}}(t,e);this.reactionCreators.push(s);const a=s(this);return this.reactions.push(a),(r||n)&&(a(!0),n&&!this.ssr&&this._updateState(this.currentState)),()=>{this.reactions=this.reactions.filter((t=>t!==a))}}getRawState(){return void 0!==this.batchState?this.batchState:this.currentState}useState(t,e){return ct(this,t,e)}useLocalCopyInitial(t){return lt(this.createInitialState,t)}useLocalCopySnapshot(t){return lt(this.currentState,t)}flushBatch(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];void 0!==this.batchState?this.batchState!==this.currentState&&this._updateState(this.batchState):t||console.error("Pullstate: Trying to flush batch state which was never created or updated on"),this.batchState=void 0}update(t,e){if(ut.batching){void 0===this.batchState&&(this.batchState=this.currentState,ut.flushStores[this.internalOrdId]=this);const r="function"===typeof t,[n,i,s]=pt(this.batchState,t,r);i.length>0&&(this._patchListeners.length>0||e)&&(e&&e(i,s),this._patchListeners.forEach((t=>t(i,s)))),this.batchState=n}else this.batchState=void 0,function(t,e,r){const n=t.getRawState(),i="function"===typeof e;if(t._optListenerCount>0){const[s,a,o]=pt(n,e,i);a.length>0&&(r&&r(a,o),t._patchListeners.forEach((t=>t(a,o))),t._updateState(s,Object.keys(ft(a))))}else{let s;if(t._patchListeners.length>0||r){const[a,o,c]=pt(n,e,i);o.length>0&&(r&&r(o,c),t._patchListeners.forEach((t=>t(o,c)))),s=a}else s=st(n,(t=>i?e(t,n):e.reduce(((t,e)=>st(t,(r=>e(r,t)))),n)));s!==n&&t._updateState(s)}}(this,t,e)}replace(t){this._updateState(t)}replaceFromCurrent(t){this._updateState(t(this.currentState))}applyPatches(t){!function(t,e){const r=t.getRawState(),n=ot(r,e);n!==r&&t._updateState(n,Object.keys(ft(e)))}(this,t)}}function ft(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const r of t){let t;for(const n of r.path)t=t?"".concat(t).concat(ht).concat(n):n,e[t]=1}return e}function pt(t,e,r){return r?at(t,(r=>e(r,t))):e.reduce(((t,e)=>{let[r,n,i]=t;const s=at(r,(t=>e(t,r)));return n.push(...s[1]),i.push(...s[2]),[s[0],n,i]}),[t,[],[]])}var gt,mt;!function(t){t.THREW_ERROR="THREW_ERROR",t.RETURNED_ERROR="RETURNED_ERROR",t.UNFINISHED="UNFINISHED",t.DORMANT="DORMANT"}(gt||(gt={})),function(t){t.WATCH_HIT_CACHE="WATCH_HIT_CACHE",t.BECKON_HIT_CACHE="BECKON_HIT_CACHE",t.RUN_HIT_CACHE="RUN_HIT_CACHE",t.READ_HIT_CACHE="READ_HIT_CACHE",t.READ_RUN="READ_RUN",t.SHORT_CIRCUIT="SHORT_CIRCUIT",t.DIRECT_RUN="DIRECT_RUN",t.BECKON_RUN="BECKON_RUN",t.CACHE_UPDATE="CACHE_UPDATE"}(mt||(mt={}));let vt;try{vt=new Proxy({},{get:function(t,e){throw new Error("Pullstate: Trying to access store (".concat(String(e),') inside async actions without the correct usage or setup.\nIf this error occurred on the server:\n* If using run(), make use of your created instance for this request: instance.runAsyncAction()\n* If using read(), useWatch(), useBeckon() etc. - make sure you have properly set up your <PullstateProvider/>\n\nIf this error occurred on the client:\n* Make sure you have created your "pullstateCore" object with all your stores, using createPullstateCore(), and are making use of instantiate() before rendering.'))}})}catch{vt={}}gt.UNFINISHED;s.createContext(null);var yt;!function(t){t.WATCH="watch",t.BECKON="beckon"}(yt||(yt={}))},6939:t=>{var e="undefined"!==typeof Element,r="function"===typeof Map,n="function"===typeof Set,i="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function s(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var o,c,l,u;if(Array.isArray(t)){if((o=t.length)!=a.length)return!1;for(c=o;0!==c--;)if(!s(t[c],a[c]))return!1;return!0}if(r&&t instanceof Map&&a instanceof Map){if(t.size!==a.size)return!1;for(u=t.entries();!(c=u.next()).done;)if(!a.has(c.value[0]))return!1;for(u=t.entries();!(c=u.next()).done;)if(!s(c.value[1],a.get(c.value[0])))return!1;return!0}if(n&&t instanceof Set&&a instanceof Set){if(t.size!==a.size)return!1;for(u=t.entries();!(c=u.next()).done;)if(!a.has(c.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(a)){if((o=t.length)!=a.length)return!1;for(c=o;0!==c--;)if(t[c]!==a[c])return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf&&"function"===typeof t.valueOf&&"function"===typeof a.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString&&"function"===typeof t.toString&&"function"===typeof a.toString)return t.toString()===a.toString();if((o=(l=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(c=o;0!==c--;)if(!Object.prototype.hasOwnProperty.call(a,l[c]))return!1;if(e&&t instanceof Element)return!1;for(c=o;0!==c--;)if(("_owner"!==l[c]&&"__v"!==l[c]&&"__o"!==l[c]||!t.$$typeof)&&!s(t[l[c]],a[l[c]]))return!1;return!0}return t!==t&&a!==a}t.exports=function(t,e){try{return s(t,e)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}}},182:(t,e,r)=>{"use strict";r.d(e,{q:()=>ct});var n=r(5192),i=r.n(n),s=r(4063),a=r.n(s),o=r(6939),c=r.n(o),l=r(7313),u=r(1843),h=r.n(u),d="bodyAttributes",f="htmlAttributes",p="titleAttributes",g={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},m=(Object.keys(g).map((function(t){return g[t]})),"charset"),v="cssText",y="href",b="http-equiv",E="innerHTML",w="itemprop",T="name",S="property",_="rel",A="src",R="target",C={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},k="defaultTitle",O="defer",I="encodeSpecialCharacters",D="onChangeClientState",x="titleTemplate",L=Object.keys(C).reduce((function(t,e){return t[C[e]]=e,t}),{}),P=[g.NOSCRIPT,g.SCRIPT,g.STYLE],N="data-react-helmet",M="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),U=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},B=function(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r},j=function(t){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},V=function(t){var e=q(t,g.TITLE),r=q(t,x);if(r&&e)return r.replace(/%s/g,(function(){return Array.isArray(e)?e.join(""):e}));var n=q(t,k);return e||n||void 0},G=function(t){return q(t,D)||function(){}},K=function(t,e){return e.filter((function(e){return"undefined"!==typeof e[t]})).map((function(e){return e[t]})).reduce((function(t,e){return U({},t,e)}),{})},H=function(t,e){return e.filter((function(t){return"undefined"!==typeof t[g.BASE]})).map((function(t){return t[g.BASE]})).reverse().reduce((function(e,r){if(!e.length)for(var n=Object.keys(r),i=0;i<n.length;i++){var s=n[i].toLowerCase();if(-1!==t.indexOf(s)&&r[s])return e.concat(r)}return e}),[])},z=function(t,e,r){var n={};return r.filter((function(e){return!!Array.isArray(e[t])||("undefined"!==typeof e[t]&&Q("Helmet: "+t+' should be of type "Array". Instead found type "'+M(e[t])+'"'),!1)})).map((function(e){return e[t]})).reverse().reduce((function(t,r){var i={};r.filter((function(t){for(var r=void 0,s=Object.keys(t),a=0;a<s.length;a++){var o=s[a],c=o.toLowerCase();-1===e.indexOf(c)||r===_&&"canonical"===t[r].toLowerCase()||c===_&&"stylesheet"===t[c].toLowerCase()||(r=c),-1===e.indexOf(o)||o!==E&&o!==v&&o!==w||(r=o)}if(!r||!t[r])return!1;var l=t[r].toLowerCase();return n[r]||(n[r]={}),i[r]||(i[r]={}),!n[r][l]&&(i[r][l]=!0,!0)})).reverse().forEach((function(e){return t.push(e)}));for(var s=Object.keys(i),a=0;a<s.length;a++){var o=s[a],c=h()({},n[o],i[o]);n[o]=c}return t}),[]).reverse()},q=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t[r];if(n.hasOwnProperty(e))return n[e]}return null},W=function(){var t=Date.now();return function(e){var r=Date.now();r-t>16?(t=r,e(r)):setTimeout((function(){W(e)}),0)}}(),Y=function(t){return clearTimeout(t)},Z="undefined"!==typeof window?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||W:r.g.requestAnimationFrame||W,X="undefined"!==typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||Y:r.g.cancelAnimationFrame||Y,Q=function(t){return console&&"function"===typeof console.warn&&console.warn(t)},$=null,J=function(t,e){var r=t.baseTag,n=t.bodyAttributes,i=t.htmlAttributes,s=t.linkTags,a=t.metaTags,o=t.noscriptTags,c=t.onChangeClientState,l=t.scriptTags,u=t.styleTags,h=t.title,d=t.titleAttributes;rt(g.BODY,n),rt(g.HTML,i),et(h,d);var f={baseTag:nt(g.BASE,r),linkTags:nt(g.LINK,s),metaTags:nt(g.META,a),noscriptTags:nt(g.NOSCRIPT,o),scriptTags:nt(g.SCRIPT,l),styleTags:nt(g.STYLE,u)},p={},m={};Object.keys(f).forEach((function(t){var e=f[t],r=e.newTags,n=e.oldTags;r.length&&(p[t]=r),n.length&&(m[t]=f[t].oldTags)})),e&&e(),c(t,p,m)},tt=function(t){return Array.isArray(t)?t.join(""):t},et=function(t,e){"undefined"!==typeof t&&document.title!==t&&(document.title=tt(t)),rt(g.TITLE,e)},rt=function(t,e){var r=document.getElementsByTagName(t)[0];if(r){for(var n=r.getAttribute(N),i=n?n.split(","):[],s=[].concat(i),a=Object.keys(e),o=0;o<a.length;o++){var c=a[o],l=e[c]||"";r.getAttribute(c)!==l&&r.setAttribute(c,l),-1===i.indexOf(c)&&i.push(c);var u=s.indexOf(c);-1!==u&&s.splice(u,1)}for(var h=s.length-1;h>=0;h--)r.removeAttribute(s[h]);i.length===s.length?r.removeAttribute(N):r.getAttribute(N)!==a.join(",")&&r.setAttribute(N,a.join(","))}},nt=function(t,e){var r=document.head||document.querySelector(g.HEAD),n=r.querySelectorAll(t+"["+N+"]"),i=Array.prototype.slice.call(n),s=[],a=void 0;return e&&e.length&&e.forEach((function(e){var r=document.createElement(t);for(var n in e)if(e.hasOwnProperty(n))if(n===E)r.innerHTML=e.innerHTML;else if(n===v)r.styleSheet?r.styleSheet.cssText=e.cssText:r.appendChild(document.createTextNode(e.cssText));else{var o="undefined"===typeof e[n]?"":e[n];r.setAttribute(n,o)}r.setAttribute(N,"true"),i.some((function(t,e){return a=e,r.isEqualNode(t)}))?i.splice(a,1):s.push(r)})),i.forEach((function(t){return t.parentNode.removeChild(t)})),s.forEach((function(t){return r.appendChild(t)})),{oldTags:i,newTags:s}},it=function(t){return Object.keys(t).reduce((function(e,r){var n="undefined"!==typeof t[r]?r+'="'+t[r]+'"':""+r;return e?e+" "+n:n}),"")},st=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce((function(e,r){return e[C[r]||r]=t[r],e}),e)},at=function(t,e,r){switch(t){case g.TITLE:return{toComponent:function(){return function(t,e,r){var n,i=((n={key:e})[N]=!0,n),s=st(r,i);return[l.createElement(g.TITLE,s,e)]}(0,e.title,e.titleAttributes)},toString:function(){return function(t,e,r,n){var i=it(r),s=tt(e);return i?"<"+t+" "+N+'="true" '+i+">"+j(s,n)+"</"+t+">":"<"+t+" "+N+'="true">'+j(s,n)+"</"+t+">"}(t,e.title,e.titleAttributes,r)}};case d:case f:return{toComponent:function(){return st(e)},toString:function(){return it(e)}};default:return{toComponent:function(){return function(t,e){return e.map((function(e,r){var n,i=((n={key:r})[N]=!0,n);return Object.keys(e).forEach((function(t){var r=C[t]||t;if(r===E||r===v){var n=e.innerHTML||e.cssText;i.dangerouslySetInnerHTML={__html:n}}else i[r]=e[t]})),l.createElement(t,i)}))}(t,e)},toString:function(){return function(t,e,r){return e.reduce((function(e,n){var i=Object.keys(n).filter((function(t){return!(t===E||t===v)})).reduce((function(t,e){var i="undefined"===typeof n[e]?e:e+'="'+j(n[e],r)+'"';return t?t+" "+i:i}),""),s=n.innerHTML||n.cssText||"",a=-1===P.indexOf(t);return e+"<"+t+" "+N+'="true" '+i+(a?"/>":">"+s+"</"+t+">")}),"")}(t,e,r)}}}},ot=function(t){var e=t.baseTag,r=t.bodyAttributes,n=t.encode,i=t.htmlAttributes,s=t.linkTags,a=t.metaTags,o=t.noscriptTags,c=t.scriptTags,l=t.styleTags,u=t.title,h=void 0===u?"":u,p=t.titleAttributes;return{base:at(g.BASE,e,n),bodyAttributes:at(d,r,n),htmlAttributes:at(f,i,n),link:at(g.LINK,s,n),meta:at(g.META,a,n),noscript:at(g.NOSCRIPT,o,n),script:at(g.SCRIPT,c,n),style:at(g.STYLE,l,n),title:at(g.TITLE,{title:h,titleAttributes:p},n)}},ct=function(t){var e,r;return r=e=function(e){function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,e.apply(this,arguments))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,e),r.prototype.shouldComponentUpdate=function(t){return!c()(this.props,t)},r.prototype.mapNestedChildrenToProps=function(t,e){if(!e)return null;switch(t.type){case g.SCRIPT:case g.NOSCRIPT:return{innerHTML:e};case g.STYLE:return{cssText:e}}throw new Error("<"+t.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},r.prototype.flattenArrayTypeChildren=function(t){var e,r=t.child,n=t.arrayTypeChildren,i=t.newChildProps,s=t.nestedChildren;return U({},n,((e={})[r.type]=[].concat(n[r.type]||[],[U({},i,this.mapNestedChildrenToProps(r,s))]),e))},r.prototype.mapObjectTypeChildren=function(t){var e,r,n=t.child,i=t.newProps,s=t.newChildProps,a=t.nestedChildren;switch(n.type){case g.TITLE:return U({},i,((e={})[n.type]=a,e.titleAttributes=U({},s),e));case g.BODY:return U({},i,{bodyAttributes:U({},s)});case g.HTML:return U({},i,{htmlAttributes:U({},s)})}return U({},i,((r={})[n.type]=U({},s),r))},r.prototype.mapArrayTypeChildrenToProps=function(t,e){var r=U({},e);return Object.keys(t).forEach((function(e){var n;r=U({},r,((n={})[e]=t[e],n))})),r},r.prototype.warnOnInvalidChildren=function(t,e){return!0},r.prototype.mapChildrenToProps=function(t,e){var r=this,n={};return l.Children.forEach(t,(function(t){if(t&&t.props){var i=t.props,s=i.children,a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce((function(e,r){return e[L[r]||r]=t[r],e}),e)}(B(i,["children"]));switch(r.warnOnInvalidChildren(t,s),t.type){case g.LINK:case g.META:case g.NOSCRIPT:case g.SCRIPT:case g.STYLE:n=r.flattenArrayTypeChildren({child:t,arrayTypeChildren:n,newChildProps:a,nestedChildren:s});break;default:e=r.mapObjectTypeChildren({child:t,newProps:e,newChildProps:a,nestedChildren:s})}}})),e=this.mapArrayTypeChildrenToProps(n,e)},r.prototype.render=function(){var e=this.props,r=e.children,n=B(e,["children"]),i=U({},n);return r&&(i=this.mapChildrenToProps(r,i)),l.createElement(t,i)},F(r,null,[{key:"canUseDOM",set:function(e){t.canUseDOM=e}}]),r}(l.Component),e.propTypes={base:i().object,bodyAttributes:i().object,children:i().oneOfType([i().arrayOf(i().node),i().node]),defaultTitle:i().string,defer:i().bool,encodeSpecialCharacters:i().bool,htmlAttributes:i().object,link:i().arrayOf(i().object),meta:i().arrayOf(i().object),noscript:i().arrayOf(i().object),onChangeClientState:i().func,script:i().arrayOf(i().object),style:i().arrayOf(i().object),title:i().string,titleAttributes:i().object,titleTemplate:i().string},e.defaultProps={defer:!0,encodeSpecialCharacters:!0},e.peek=t.peek,e.rewind=function(){var e=t.rewind();return e||(e=ot({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),e},r}(a()((function(t){return{baseTag:H([y,R],t),bodyAttributes:K(d,t),defer:q(t,O),encode:q(t,I),htmlAttributes:K(f,t),linkTags:z(g.LINK,[_,y],t),metaTags:z(g.META,[T,m,b,S,w],t),noscriptTags:z(g.NOSCRIPT,[E],t),onChangeClientState:G(t),scriptTags:z(g.SCRIPT,[A,E],t),styleTags:z(g.STYLE,[v],t),title:V(t),titleAttributes:K(p,t)}}),(function(t){$&&X($),t.defer?$=Z((function(){J(t,(function(){$=null}))})):(J(t),$=null)}),ot)((function(){return null})));ct.renderStatic=ct.rewind},9768:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c});var n=r(7313),i=r(2342),s=r.n(i),a=function(){return a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},a.apply(this,arguments)},o=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};const c=function(t){var e=t.hlsConfig,r=t.playerRef,i=void 0===r?n.createRef():r,c=t.src,l=t.autoPlay,u=o(t,["hlsConfig","playerRef","src","autoPlay"]);return(0,n.useEffect)((function(){var t;return s().isSupported()&&function r(){null!=t&&t.destroy();var n=new(s())(a({enableWorker:!1},e));null!=i.current&&n.attachMedia(i.current),n.on(s().Events.MEDIA_ATTACHED,(function(){n.loadSource(c),n.on(s().Events.MANIFEST_PARSED,(function(){var t;l&&(null===(t=null===i||void 0===i?void 0:i.current)||void 0===t||t.play().catch((function(){return console.log("Unable to autoplay prior to user interaction with the dom.")})))}))})),n.on(s().Events.ERROR,(function(t,e){if(e.fatal)switch(e.type){case s().ErrorTypes.NETWORK_ERROR:n.startLoad();break;case s().ErrorTypes.MEDIA_ERROR:n.recoverMediaError();break;default:r()}})),t=n}(),function(){null!=t&&t.destroy()}}),[l,e,i,c]),s().isSupported()?n.createElement("video",a({ref:i},u)):n.createElement("video",a({ref:i,src:c,autoPlay:l},u))}},7864:(t,e,r)=>{"use strict";r.d(e,{M_L:()=>i,Wxs:()=>c,iqr:()=>o,lo:()=>a,nf1:()=>l,oHP:()=>s});var n=r(1260);function i(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M923 283.6a260.04 260.04 0 0 0-56.9-82.8 264.4 264.4 0 0 0-84-55.5A265.34 265.34 0 0 0 679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 0 0-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9z"}}]})(t)}function s(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 1024 1024",fill:"currentColor",fillRule:"evenodd"},child:[{tag:"path",attr:{d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.118.118 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.118.118 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.118.118 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926 224.297 857.629c-.04.041-.06.052-.083.059a.118.118 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.118.118 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512 166.371 224.297c-.041-.04-.052-.06-.059-.083a.118.118 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.118.118 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.118.118 0 0 1 .07 0Z"}}]})(t)}function a(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M923 283.6a260.04 260.04 0 0 0-56.9-82.8 264.4 264.4 0 0 0-84-55.5A265.34 265.34 0 0 0 679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 0 0-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]})(t)}function o(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 0 0-44.4 0L77.5 505a63.9 63.9 0 0 0-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0 0 18.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"}}]})(t)}function c(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attr:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 0 0 398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 0 0 0-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]})(t)}function l(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M858.5 763.6a374 374 0 0 0-80.6-119.5 375.63 375.63 0 0 0-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 0 0-80.6 119.5A371.7 371.7 0 0 0 136 901.8a8 8 0 0 0 8 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 0 0 8-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]})(t)}},8821:(t,e,r)=>{"use strict";r.d(e,{FQA:()=>c,Vs6:()=>o,Y22:()=>s,k1O:()=>a,l$c:()=>i,meP:()=>l});var n=r(1260);function i(t){return(0,n.w_)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M8 4.41c1.387-1.425 4.854 1.07 0 4.277C3.146 5.48 6.613 2.986 8 4.412z"}},{tag:"path",attr:{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"}}]})(t)}function s(t){return(0,n.w_)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M6 3a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM1 3a2 2 0 1 0 4 0 2 2 0 0 0-4 0z"}},{tag:"path",attr:{d:"M9 6h.5a2 2 0 0 1 1.983 1.738l3.11-1.382A1 1 0 0 1 16 7.269v7.462a1 1 0 0 1-1.406.913l-3.111-1.382A2 2 0 0 1 9.5 16H2a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h7zm6 8.73V7.27l-3.5 1.555v4.35l3.5 1.556zM1 8v6a1 1 0 0 0 1 1h7.5a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1z"}},{tag:"path",attr:{d:"M9 6a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM7 3a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"}}]})(t)}function a(t){return(0,n.w_)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"}}]})(t)}function o(t){return(0,n.w_)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"}}]})(t)}function c(t){return(0,n.w_)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"}}]})(t)}function l(t){return(0,n.w_)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"}}]})(t)}},6672:(t,e,r)=>{"use strict";r.d(e,{QJe:()=>s,gmG:()=>i});var n=r(1260);function i(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"}}]})(t)}function s(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"}}]})(t)}},1260:(t,e,r)=>{"use strict";r.d(e,{w_:()=>l});var n=r(7313),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=n.createContext&&n.createContext(i),a=function(){return a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},a.apply(this,arguments)},o=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};function c(t){return t&&t.map((function(t,e){return n.createElement(t.tag,a({key:e},t.attr),c(t.child))}))}function l(t){return function(e){return n.createElement(u,a({attr:a({},t.attr)},e),c(t.child))}}function u(t){var e=function(e){var r,i=t.attr,s=t.size,c=t.title,l=o(t,["attr","size","title"]),u=s||e.size||"1em";return e.className&&(r=e.className),t.className&&(r=(r?r+" ":"")+t.className),n.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,i,l,{className:r,style:a(a({color:t.color||e.color},e.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&n.createElement("title",null,c),t.children)};return void 0!==s?n.createElement(s.Consumer,null,(function(t){return e(t)})):e(i)}},2539:(t,e,r)=>{"use strict";r.d(e,{KQY:()=>a,U$P:()=>s,ZkW:()=>i,twx:()=>o});var n=r(1260);function i(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}}]})(t)}function s(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 000-1.41l-2.34-2.34a.996.996 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}}]})(t)}function a(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"}}]})(t)}function o(t){return(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"}}]})(t)}},1624:(t,e)=>{"use strict";var r,n=Symbol.for("react.element"),i=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen");function v(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case n:switch(t=t.type){case s:case o:case a:case d:case f:return t;default:switch(t=t&&t.$$typeof){case u:case l:case h:case g:case p:case c:return t;default:return e}}case i:return e}}}r=Symbol.for("react.module.reference"),e.isForwardRef=function(t){return v(t)===h}},6214:(t,e,r)=>{"use strict";t.exports=r(1624)},6367:function(t,e,r){var n;n=t=>(()=>{var e={"./node_modules/css-mediaquery/index.js":(t,e)=>{"use strict";e.match=function(t,e){return o(t).some((function(t){var r=t.inverse,n="all"===t.type||e.type===t.type;if(n&&r||!n&&!r)return!1;var i=t.expressions.every((function(t){var r=t.feature,n=t.modifier,i=t.value,s=e[r];if(!s)return!1;switch(r){case"orientation":case"scan":return s.toLowerCase()===i.toLowerCase();case"width":case"height":case"device-width":case"device-height":i=u(i),s=u(s);break;case"resolution":i=l(i),s=l(s);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":i=c(i),s=c(s);break;case"grid":case"color":case"color-index":case"monochrome":i=parseInt(i,10)||1,s=parseInt(s,10)||0}switch(n){case"min":return s>=i;case"max":return s<=i;default:return s===i}}));return i&&!r||!i&&r}))},e.parse=o;var r=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,n=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,i=/^(?:(min|max)-)?(.+)/,s=/(em|rem|px|cm|mm|in|pt|pc)?$/,a=/(dpi|dpcm|dppx)?$/;function o(t){return t.split(",").map((function(t){var e=(t=t.trim()).match(r),s=e[1],a=e[2],o=e[3]||"",c={};return c.inverse=!!s&&"not"===s.toLowerCase(),c.type=a?a.toLowerCase():"all",o=o.match(/\([^\)]+\)/g)||[],c.expressions=o.map((function(t){var e=t.match(n),r=e[1].toLowerCase().match(i);return{modifier:r[1],feature:r[2],value:e[2]}})),c}))}function c(t){var e,r=Number(t);return r||(r=(e=t.match(/^(\d+)\s*\/\s*(\d+)$/))[1]/e[2]),r}function l(t){var e=parseFloat(t);switch(String(t).match(a)[1]){case"dpcm":return e/2.54;case"dppx":return 96*e;default:return e}}function u(t){var e=parseFloat(t);switch(String(t).match(s)[1]){case"em":case"rem":return 16*e;case"cm":return 96*e/2.54;case"mm":return 96*e/2.54/10;case"in":return 96*e;case"pt":return 72*e;case"pc":return 72*e/12;default:return e}}},"./node_modules/hyphenate-style-name/index.js":(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var n=/[A-Z]/g,i=/^ms-/,s={};function a(t){return"-"+t.toLowerCase()}const o=function(t){if(s.hasOwnProperty(t))return s[t];var e=t.replace(n,a);return s[t]=i.test(e)?"-"+e:e}},"./node_modules/matchmediaquery/index.js":(t,e,r)=>{"use strict";var n=r("./node_modules/css-mediaquery/index.js").match,i="undefined"!==typeof window?window.matchMedia:null;function s(t,e,r){var s=this;if(i&&!r){var a=i.call(window,t);this.matches=a.matches,this.media=a.media,a.addListener(o)}else this.matches=n(t,e),this.media=t;function o(t){s.matches=t.matches,s.media=t.media}this.addListener=function(t){a&&a.addListener(t)},this.removeListener=function(t){a&&a.removeListener(t)},this.dispose=function(){a&&a.removeListener(o)}}t.exports=function(t,e,r){return new s(t,e,r)}},"./node_modules/object-assign/index.js":t=>{"use strict";var e=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(i){return!1}}()?Object.assign:function(t,i){for(var s,a,o=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var l in s=Object(arguments[c]))r.call(s,l)&&(o[l]=s[l]);if(e){a=e(s);for(var u=0;u<a.length;u++)n.call(s,a[u])&&(o[a[u]]=s[a[u]])}}return o}},"./node_modules/prop-types/checkPropTypes.js":(t,e,r)=>{"use strict";var n=function(){},i=r("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),s={},a=r("./node_modules/prop-types/lib/has.js");function o(t,e,r,o,c){for(var l in t)if(a(t,l)){var u;try{if("function"!==typeof t[l]){var h=Error((o||"React class")+": "+r+" type `"+l+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof t[l]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw h.name="Invariant Violation",h}u=t[l](e,l,o,r,null,i)}catch(f){u=f}if(!u||u instanceof Error||n((o||"React class")+": type specification of "+r+" `"+l+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof u+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),u instanceof Error&&!(u.message in s)){s[u.message]=!0;var d=c?c():"";n("Failed "+r+" type: "+u.message+(null!=d?d:""))}}}n=function(t){var e="Warning: "+t;"undefined"!==typeof console&&console.error(e);try{throw new Error(e)}catch(r){}},o.resetWarningCache=function(){s={}},t.exports=o},"./node_modules/prop-types/factoryWithTypeCheckers.js":(t,e,r)=>{"use strict";var n=r("./node_modules/react-is/index.js"),i=r("./node_modules/object-assign/index.js"),s=r("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),a=r("./node_modules/prop-types/lib/has.js"),o=r("./node_modules/prop-types/checkPropTypes.js"),c=function(){};function l(){return null}c=function(t){var e="Warning: "+t;"undefined"!==typeof console&&console.error(e);try{throw new Error(e)}catch(r){}},t.exports=function(t,e){var r="function"===typeof Symbol&&Symbol.iterator,u="@@iterator",h="<<anonymous>>",d={array:m("array"),bigint:m("bigint"),bool:m("boolean"),func:m("function"),number:m("number"),object:m("object"),string:m("string"),symbol:m("symbol"),any:g(l),arrayOf:function(t){return g((function(e,r,n,i,a){if("function"!==typeof t)return new p("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var o=e[r];if(!Array.isArray(o))return new p("Invalid "+i+" `"+a+"` of type `"+b(o)+"` supplied to `"+n+"`, expected an array.");for(var c=0;c<o.length;c++){var l=t(o,c,n,i,a+"["+c+"]",s);if(l instanceof Error)return l}return null}))},element:g((function(e,r,n,i,s){var a=e[r];return t(a)?null:new p("Invalid "+i+" `"+s+"` of type `"+b(a)+"` supplied to `"+n+"`, expected a single ReactElement.")})),elementType:g((function(t,e,r,i,s){var a=t[e];return n.isValidElementType(a)?null:new p("Invalid "+i+" `"+s+"` of type `"+b(a)+"` supplied to `"+r+"`, expected a single ReactElement type.")})),instanceOf:function(t){return g((function(e,r,n,i,s){if(!(e[r]instanceof t)){var a=t.name||h;return new p("Invalid "+i+" `"+s+"` of type `"+((o=e[r]).constructor&&o.constructor.name?o.constructor.name:h)+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}var o;return null}))},node:g((function(t,e,r,n,i){return y(t[e])?null:new p("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(t){return g((function(e,r,n,i,o){if("function"!==typeof t)return new p("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var c=e[r],l=b(c);if("object"!==l)return new p("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var u in c)if(a(c,u)){var h=t(c,u,n,i,o+"."+u,s);if(h instanceof Error)return h}return null}))},oneOf:function(t){return Array.isArray(t)?g((function(e,r,n,i,s){for(var a=e[r],o=0;o<t.length;o++)if(f(a,t[o]))return null;var c=JSON.stringify(t,(function(t,e){return"symbol"===E(e)?String(e):e}));return new p("Invalid "+i+" `"+s+"` of value `"+String(a)+"` supplied to `"+n+"`, expected one of "+c+".")})):(c(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),l)},oneOfType:function(t){if(!Array.isArray(t))return c("Invalid argument supplied to oneOfType, expected an instance of array."),l;for(var e=0;e<t.length;e++){var r=t[e];if("function"!==typeof r)return c("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+w(r)+" at index "+e+"."),l}return g((function(e,r,n,i,o){for(var c=[],l=0;l<t.length;l++){var u=(0,t[l])(e,r,n,i,o,s);if(null==u)return null;u.data&&a(u.data,"expectedType")&&c.push(u.data.expectedType)}return new p("Invalid "+i+" `"+o+"` supplied to `"+n+"`"+(c.length>0?", expected one of type ["+c.join(", ")+"]":"")+".")}))},shape:function(t){return g((function(e,r,n,i,a){var o=e[r],c=b(o);if("object"!==c)return new p("Invalid "+i+" `"+a+"` of type `"+c+"` supplied to `"+n+"`, expected `object`.");for(var l in t){var u=t[l];if("function"!==typeof u)return v(n,i,a,l,E(u));var h=u(o,l,n,i,a+"."+l,s);if(h)return h}return null}))},exact:function(t){return g((function(e,r,n,o,c){var l=e[r],u=b(l);if("object"!==u)return new p("Invalid "+o+" `"+c+"` of type `"+u+"` supplied to `"+n+"`, expected `object`.");var h=i({},e[r],t);for(var d in h){var f=t[d];if(a(t,d)&&"function"!==typeof f)return v(n,o,c,d,E(f));if(!f)return new p("Invalid "+o+" `"+c+"` key `"+d+"` supplied to `"+n+"`.\nBad object: "+JSON.stringify(e[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(t),null,"  "));var g=f(l,d,n,o,c+"."+d,s);if(g)return g}return null}))}};function f(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}function p(t,e){this.message=t,this.data=e&&"object"===typeof e?e:{},this.stack=""}function g(t){var r={},n=0;function i(i,a,o,l,u,d,f){if(l=l||h,d=d||o,f!==s){if(e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}if("undefined"!==typeof console){var m=l+":"+o;!r[m]&&n<3&&(c("You are manually calling a React.PropTypes validation function for the `"+d+"` prop on `"+l+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),r[m]=!0,n++)}}return null==a[o]?i?null===a[o]?new p("The "+u+" `"+d+"` is marked as required in `"+l+"`, but its value is `null`."):new p("The "+u+" `"+d+"` is marked as required in `"+l+"`, but its value is `undefined`."):null:t(a,o,l,u,d)}var a=i.bind(null,!1);return a.isRequired=i.bind(null,!0),a}function m(t){return g((function(e,r,n,i,s,a){var o=e[r];return b(o)!==t?new p("Invalid "+i+" `"+s+"` of type `"+E(o)+"` supplied to `"+n+"`, expected `"+t+"`.",{expectedType:t}):null}))}function v(t,e,r,n,i){return new p((t||"React class")+": "+e+" type `"+r+"."+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+i+"`.")}function y(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(y);if(null===e||t(e))return!0;var n=function(t){var e=t&&(r&&t[r]||t[u]);if("function"===typeof e)return e}(e);if(!n)return!1;var i,s=n.call(e);if(n!==e.entries){for(;!(i=s.next()).done;)if(!y(i.value))return!1}else for(;!(i=s.next()).done;){var a=i.value;if(a&&!y(a[1]))return!1}return!0;default:return!1}}function b(t){var e=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":function(t,e){return"symbol"===t||!!e&&("Symbol"===e["@@toStringTag"]||"function"===typeof Symbol&&e instanceof Symbol)}(e,t)?"symbol":e}function E(t){if("undefined"===typeof t||null===t)return""+t;var e=b(t);if("object"===e){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return e}function w(t){var e=E(t);switch(e){case"array":case"object":return"an "+e;case"boolean":case"date":case"regexp":return"a "+e;default:return e}}return p.prototype=Error.prototype,d.checkPropTypes=o,d.resetWarningCache=o.resetWarningCache,d.PropTypes=d,d}},"./node_modules/prop-types/index.js":(t,e,r)=>{var n=r("./node_modules/react-is/index.js");t.exports=r("./node_modules/prop-types/factoryWithTypeCheckers.js")(n.isElement,!0)},"./node_modules/prop-types/lib/ReactPropTypesSecret.js":t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"./node_modules/prop-types/lib/has.js":t=>{t.exports=Function.call.bind(Object.prototype.hasOwnProperty)},"./node_modules/react-is/cjs/react-is.development.js":(t,e)=>{"use strict";!function(){var t="function"===typeof Symbol&&Symbol.for,r=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,i=t?Symbol.for("react.fragment"):60107,s=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,o=t?Symbol.for("react.provider"):60109,c=t?Symbol.for("react.context"):60110,l=t?Symbol.for("react.async_mode"):60111,u=t?Symbol.for("react.concurrent_mode"):60111,h=t?Symbol.for("react.forward_ref"):60112,d=t?Symbol.for("react.suspense"):60113,f=t?Symbol.for("react.suspense_list"):60120,p=t?Symbol.for("react.memo"):60115,g=t?Symbol.for("react.lazy"):60116,m=t?Symbol.for("react.block"):60121,v=t?Symbol.for("react.fundamental"):60117,y=t?Symbol.for("react.responder"):60118,b=t?Symbol.for("react.scope"):60119;function E(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:var f=t.type;switch(f){case l:case u:case i:case a:case s:case d:return f;default:var m=f&&f.$$typeof;switch(m){case c:case h:case g:case p:case o:return m;default:return e}}case n:return e}}}var w=l,T=u,S=c,_=o,A=r,R=h,C=i,k=g,O=p,I=n,D=a,x=s,L=d,P=!1;function N(t){return E(t)===u}e.AsyncMode=w,e.ConcurrentMode=T,e.ContextConsumer=S,e.ContextProvider=_,e.Element=A,e.ForwardRef=R,e.Fragment=C,e.Lazy=k,e.Memo=O,e.Portal=I,e.Profiler=D,e.StrictMode=x,e.Suspense=L,e.isAsyncMode=function(t){return P||(P=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),N(t)||E(t)===l},e.isConcurrentMode=N,e.isContextConsumer=function(t){return E(t)===c},e.isContextProvider=function(t){return E(t)===o},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return E(t)===h},e.isFragment=function(t){return E(t)===i},e.isLazy=function(t){return E(t)===g},e.isMemo=function(t){return E(t)===p},e.isPortal=function(t){return E(t)===n},e.isProfiler=function(t){return E(t)===a},e.isStrictMode=function(t){return E(t)===s},e.isSuspense=function(t){return E(t)===d},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===i||t===u||t===a||t===s||t===d||t===f||"object"===typeof t&&null!==t&&(t.$$typeof===g||t.$$typeof===p||t.$$typeof===o||t.$$typeof===c||t.$$typeof===h||t.$$typeof===v||t.$$typeof===y||t.$$typeof===b||t.$$typeof===m)},e.typeOf=E}()},"./node_modules/react-is/index.js":(t,e,r)=>{"use strict";t.exports=r("./node_modules/react-is/cjs/react-is.development.js")},"./node_modules/shallow-equal/dist/index.esm.js":(t,e,r)=>{"use strict";function n(t,e){if(t===e)return!0;if(!t||!e)return!1;var r=Object.keys(t),n=Object.keys(e),i=r.length;if(n.length!==i)return!1;for(var s=0;s<i;s++){var a=r[s];if(t[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}function i(t,e){if(t===e)return!0;if(!t||!e)return!1;var r=t.length;if(e.length!==r)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}r.r(e),r.d(e,{shallowEqualArrays:()=>i,shallowEqualObjects:()=>n})},"./src/Component.ts":function(t,e,r){"use strict";var n=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=i(r("./src/useMediaQuery.ts"));e.default=function(t){var e=t.children,r=t.device,i=t.onChange,a=n(t,["children","device","onChange"]),o=(0,s.default)(a,r,i);return"function"===typeof e?e(o):o?e:null}},"./src/Context.ts":(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(0,r("react").createContext)(void 0);e.default=n},"./src/index.ts":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Context=e.toQuery=e.useMediaQuery=e.default=void 0;var i=n(r("./src/useMediaQuery.ts"));e.useMediaQuery=i.default;var s=n(r("./src/Component.ts"));e.default=s.default;var a=n(r("./src/toQuery.ts"));e.toQuery=a.default;var o=n(r("./src/Context.ts"));e.Context=o.default},"./src/mediaQuery.ts":function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)},i=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=s(r("./node_modules/prop-types/index.js")),o=a.default.oneOfType([a.default.string,a.default.number]),c={all:a.default.bool,grid:a.default.bool,aural:a.default.bool,braille:a.default.bool,handheld:a.default.bool,print:a.default.bool,projection:a.default.bool,screen:a.default.bool,tty:a.default.bool,tv:a.default.bool,embossed:a.default.bool},l={orientation:a.default.oneOf(["portrait","landscape"]),scan:a.default.oneOf(["progressive","interlace"]),aspectRatio:a.default.string,deviceAspectRatio:a.default.string,height:o,deviceHeight:o,width:o,deviceWidth:o,color:a.default.bool,colorIndex:a.default.bool,monochrome:a.default.bool,resolution:o,type:Object.keys(c)},u=i(l,["type"]),h=n({minAspectRatio:a.default.string,maxAspectRatio:a.default.string,minDeviceAspectRatio:a.default.string,maxDeviceAspectRatio:a.default.string,minHeight:o,maxHeight:o,minDeviceHeight:o,maxDeviceHeight:o,minWidth:o,maxWidth:o,minDeviceWidth:o,maxDeviceWidth:o,minColor:a.default.number,maxColor:a.default.number,minColorIndex:a.default.number,maxColorIndex:a.default.number,minMonochrome:a.default.number,maxMonochrome:a.default.number,minResolution:o,maxResolution:o},u),d=n(n({},c),h);e.default={all:d,types:c,matchers:l,features:h}},"./src/toQuery.ts":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(r("./node_modules/hyphenate-style-name/index.js")),s=n(r("./src/mediaQuery.ts"));e.default=function(t){var e=[];return Object.keys(s.default.all).forEach((function(r){var n=t[r];null!=n&&e.push(function(t,e){var r=(0,i.default)(t);return"number"===typeof e&&(e="".concat(e,"px")),!0===e?r:!1===e?"not ".concat(r):"(".concat(r,": ").concat(e,")")}(r,n))})),e.join(" and ")}},"./src/useMediaQuery.ts":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r("react"),s=n(r("./node_modules/matchmediaquery/index.js")),a=n(r("./node_modules/hyphenate-style-name/index.js")),o=r("./node_modules/shallow-equal/dist/index.esm.js"),c=n(r("./src/toQuery.ts")),l=n(r("./src/Context.ts")),u=function(t){if(t)return Object.keys(t).reduce((function(e,r){return e[(0,a.default)(r)]=t[r],e}),{})},h=function(){var t=(0,i.useRef)(!1);return(0,i.useEffect)((function(){t.current=!0}),[]),t.current},d=function(t){var e=function(){return function(t){return t.query||(0,c.default)(t)}(t)},r=(0,i.useState)(e),n=r[0],s=r[1];return(0,i.useEffect)((function(){var t=e();n!==t&&s(t)}),[t]),n};e.default=function(t,e,r){var n=function(t){var e=(0,i.useContext)(l.default),r=function(){return u(t)||u(e)},n=(0,i.useState)(r),s=n[0],a=n[1];return(0,i.useEffect)((function(){var t=r();(0,o.shallowEqualObjects)(s,t)||a(t)}),[t,e]),s}(e),a=d(t);if(!a)throw new Error("Invalid or missing MediaQuery!");var c=function(t,e){var r=function(){return(0,s.default)(t,e||{},!!e)},n=(0,i.useState)(r),a=n[0],o=n[1],c=h();return(0,i.useEffect)((function(){if(c){var t=r();return o(t),function(){t&&t.dispose()}}}),[t,e]),a}(a,n),f=function(t){var e=(0,i.useState)(t.matches),r=e[0],n=e[1];return(0,i.useEffect)((function(){var e=function(t){n(t.matches)};return t.addListener(e),n(t.matches),function(){t.removeListener(e)}}),[t]),r}(c),p=h();return(0,i.useEffect)((function(){p&&r&&r(f)}),[f]),(0,i.useEffect)((function(){return function(){c&&c.dispose()}}),[]),f}},react:e=>{"use strict";e.exports=t}},r={};function n(t){var i=r[t];if(void 0!==i)return i.exports;var s=r[t]={exports:{}};return e[t].call(s.exports,s,s.exports,n),s.exports}return n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n("./src/index.ts")})(),t.exports=n(r(7313))},4063:(t,e,r)=>{"use strict";var n,i=r(7313),s=(n=i)&&"object"===typeof n&&"default"in n?n.default:n;function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=!("undefined"===typeof window||!window.document||!window.document.createElement);t.exports=function(t,e,r){if("function"!==typeof t)throw new Error("Expected reducePropsToState to be a function.");if("function"!==typeof e)throw new Error("Expected handleStateChangeOnClient to be a function.");if("undefined"!==typeof r&&"function"!==typeof r)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(n){if("function"!==typeof n)throw new Error("Expected WrappedComponent to be a React component.");var c,l=[];function u(){c=t(l.map((function(t){return t.props}))),h.canUseDOM?e(c):r&&(c=r(c))}var h=function(t){var e,r;function i(){return t.apply(this,arguments)||this}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i.peek=function(){return c},i.rewind=function(){if(i.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var t=c;return c=void 0,l=[],t};var a=i.prototype;return a.UNSAFE_componentWillMount=function(){l.push(this),u()},a.componentDidUpdate=function(){u()},a.componentWillUnmount=function(){var t=l.indexOf(this);l.splice(t,1),u()},a.render=function(){return s.createElement(n,this.props)},i}(i.PureComponent);return a(h,"displayName","SideEffect("+function(t){return t.displayName||t.name||"Component"}(n)+")"),a(h,"canUseDOM",o),h}}},6295:(t,e,r)=>{"use strict";r.d(e,{h:()=>_});var n=r(1721),i=!("undefined"===typeof window||!window.document||!window.document.createElement);var s=void 0;function a(){return void 0===s&&(s=function(){if(!i)return!1;if(!window.addEventListener||!window.removeEventListener||!Object.defineProperty)return!1;var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}}),r=function(){};window.addEventListener("testPassiveEventSupport",r,e),window.removeEventListener("testPassiveEventSupport",r,e)}catch(n){}return t}()),s}function o(t){t.handlers===t.nextHandlers&&(t.nextHandlers=t.handlers.slice())}function c(t){this.target=t,this.events={}}c.prototype.getEventHandlers=function(t,e){var r,n=String(t)+" "+String((r=e)?!0===r?100:(r.capture<<0)+(r.passive<<1)+(r.once<<2):0);return this.events[n]||(this.events[n]={handlers:[],handleEvent:void 0},this.events[n].nextHandlers=this.events[n].handlers),this.events[n]},c.prototype.handleEvent=function(t,e,r){var n=this.getEventHandlers(t,e);n.handlers=n.nextHandlers,n.handlers.forEach((function(t){t&&t(r)}))},c.prototype.add=function(t,e,r){var n=this,i=this.getEventHandlers(t,r);o(i),0===i.nextHandlers.length&&(i.handleEvent=this.handleEvent.bind(this,t,r),this.target.addEventListener(t,i.handleEvent,r)),i.nextHandlers.push(e);var s=!0;return function(){if(s){s=!1,o(i);var a=i.nextHandlers.indexOf(e);i.nextHandlers.splice(a,1),0===i.nextHandlers.length&&(n.target&&n.target.removeEventListener(t,i.handleEvent,r),i.handleEvent=void 0)}}};var l="__consolidated_events_handlers__";function u(t,e,r,n){t[l]||(t[l]=new c(t));var i=function(t){if(t)return a()?t:!!t.capture}(n);return t[l].add(e,r,i)}var h=r(7313),d=r(6214);function f(t,e){var r,n=(r=t,!isNaN(parseFloat(r))&&isFinite(r)?parseFloat(r):"px"===r.slice(-2)?parseFloat(r.slice(0,-2)):void 0);if("number"===typeof n)return n;var i=function(t){if("%"===t.slice(-1))return parseFloat(t.slice(0,-1))/100}(t);return"number"===typeof i?i*e:void 0}var p="above",g="inside",m="below",v="invisible";function y(t){return"string"===typeof t.type}var b;var E=[];function w(t){E.push(t),b||(b=setTimeout((function(){var t;for(b=null;t=E.shift();)t()}),0));var e=!0;return function(){if(e){e=!1;var r=E.indexOf(t);-1!==r&&(E.splice(r,1),!E.length&&b&&(clearTimeout(b),b=null))}}}var T="undefined"!==typeof window,S={debug:!1,scrollableAncestor:void 0,children:void 0,topOffset:"0px",bottomOffset:"0px",horizontal:!1,onEnter:function(){},onLeave:function(){},onPositionChange:function(){},fireOnRapidScroll:!0},_=function(t){function e(e){var r;return(r=t.call(this,e)||this).refElement=function(t){r._ref=t},r}(0,n.Z)(e,t);var i=e.prototype;return i.componentDidMount=function(){var t=this;T&&(this.cancelOnNextTick=w((function(){t.cancelOnNextTick=null;var e=t.props,r=e.children;e.debug;!function(t,e){if(t&&!y(t)&&!e)throw new Error("<Waypoint> needs a DOM element to compute boundaries. The child you passed is neither a DOM element (e.g. <div>) nor does it use the innerRef prop.\n\nSee https://goo.gl/LrBNgw for more info.")}(r,t._ref),t._handleScroll=t._handleScroll.bind(t),t.scrollableAncestor=t._findScrollableAncestor(),t.scrollEventListenerUnsubscribe=u(t.scrollableAncestor,"scroll",t._handleScroll,{passive:!0}),t.resizeEventListenerUnsubscribe=u(window,"resize",t._handleScroll,{passive:!0}),t._handleScroll(null)})))},i.componentDidUpdate=function(){var t=this;T&&this.scrollableAncestor&&(this.cancelOnNextTick||(this.cancelOnNextTick=w((function(){t.cancelOnNextTick=null,t._handleScroll(null)}))))},i.componentWillUnmount=function(){T&&(this.scrollEventListenerUnsubscribe&&this.scrollEventListenerUnsubscribe(),this.resizeEventListenerUnsubscribe&&this.resizeEventListenerUnsubscribe(),this.cancelOnNextTick&&this.cancelOnNextTick())},i._findScrollableAncestor=function(){var t=this.props,e=t.horizontal,n=t.scrollableAncestor;if(n)return function(t){return"window"===t?r.g.window:t}(n);for(var i=this._ref;i.parentNode;){if((i=i.parentNode)===document.body)return window;var s=window.getComputedStyle(i),a=(e?s.getPropertyValue("overflow-x"):s.getPropertyValue("overflow-y"))||s.getPropertyValue("overflow");if("auto"===a||"scroll"===a||"overlay"===a)return i}return window},i._handleScroll=function(t){if(this._ref){var e=this._getBounds(),r=function(t){return t.viewportBottom-t.viewportTop===0?v:t.viewportTop<=t.waypointTop&&t.waypointTop<=t.viewportBottom||t.viewportTop<=t.waypointBottom&&t.waypointBottom<=t.viewportBottom||t.waypointTop<=t.viewportTop&&t.viewportBottom<=t.waypointBottom?g:t.viewportBottom<t.waypointTop?m:t.waypointTop<t.viewportTop?p:v}(e),n=this._previousPosition,i=this.props,s=(i.debug,i.onPositionChange),a=i.onEnter,o=i.onLeave,c=i.fireOnRapidScroll;if(this._previousPosition=r,n!==r){var l={currentPosition:r,previousPosition:n,event:t,waypointTop:e.waypointTop,waypointBottom:e.waypointBottom,viewportTop:e.viewportTop,viewportBottom:e.viewportBottom};s.call(this,l),r===g?a.call(this,l):n===g&&o.call(this,l),c&&(n===m&&r===p||n===p&&r===m)&&(a.call(this,{currentPosition:g,previousPosition:n,event:t,waypointTop:e.waypointTop,waypointBottom:e.waypointBottom,viewportTop:e.viewportTop,viewportBottom:e.viewportBottom}),o.call(this,{currentPosition:r,previousPosition:g,event:t,waypointTop:e.waypointTop,waypointBottom:e.waypointBottom,viewportTop:e.viewportTop,viewportBottom:e.viewportBottom}))}}},i._getBounds=function(){var t,e,r=this.props,n=r.horizontal,i=(r.debug,this._ref.getBoundingClientRect()),s=i.left,a=i.top,o=i.right,c=i.bottom,l=n?s:a,u=n?o:c;this.scrollableAncestor===window?(t=n?window.innerWidth:window.innerHeight,e=0):(t=n?this.scrollableAncestor.offsetWidth:this.scrollableAncestor.offsetHeight,e=n?this.scrollableAncestor.getBoundingClientRect().left:this.scrollableAncestor.getBoundingClientRect().top);var h=this.props,d=h.bottomOffset;return{waypointTop:l,waypointBottom:u,viewportTop:e+f(h.topOffset,t),viewportBottom:e+t-f(d,t)}},i.render=function(){var t=this,e=this.props.children;if(!e)return h.createElement("span",{ref:this.refElement,style:{fontSize:0}});if(y(e)||(0,d.isForwardRef)(e)){return h.cloneElement(e,{ref:function(r){t.refElement(r),e.ref&&("function"===typeof e.ref?e.ref(r):e.ref.current=r)}})}return h.cloneElement(e,{innerRef:this.refElement})},e}(h.PureComponent);_.above=p,_.below=m,_.inside=g,_.invisible=v,_.defaultProps=S,_.displayName="Waypoint"},784:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=r(7313);e.default=function(t,e,r){var s=i.useMemo((function(){return n({serializer:JSON.stringify,parser:JSON.parse,logger:console.log,syncData:!0},r)}),[r]),a=s.serializer,o=s.parser,c=s.logger,l=s.syncData,u=i.useState((function(){if("undefined"===typeof window)return e;try{var r=window.localStorage.getItem(t);return r?o(r):e}catch(n){return c(n),e}})),h=u[0],d=u[1];return i.useEffect((function(){if("undefined"!==typeof window){try{void 0!==h?window.localStorage.setItem(t,a(h)):window.localStorage.removeItem(t)}catch(e){c(e)}}}),[h]),i.useEffect((function(){if(l){var e=function(e){if(e.key===t&&e.storageArea===window.localStorage)try{d(e.newValue?o(e.newValue):void 0)}catch(e){c(e)}};if("undefined"!==typeof window)return window.addEventListener("storage",e),function(){return window.removeEventListener("storage",e)}}}),[t,l]),[h,d]}},2637:()=>{},8915:()=>{},7462:(t,e,r)=>{"use strict";function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n.apply(this,arguments)}r.d(e,{Z:()=>n})},1721:(t,e,r)=>{"use strict";function n(t,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n(t,e)}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)}r.d(e,{Z:()=>i})},3366:(t,e,r)=>{"use strict";function n(t,e){if(null==t)return{};var r,n,i={},s=Object.keys(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}r.d(e,{Z:()=>n})},904:(t,e,r)=>{"use strict";r.d(e,{Jn:()=>F,qX:()=>L,Xd:()=>x,Mq:()=>B,ZF:()=>U,KN:()=>j});var n=r(2339),i=r(2413),s=r(4766);const a=(t,e)=>e.some((e=>t instanceof e));let o,c;const l=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap;let p={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return u.get(t);if("objectStoreNames"===e)return t.objectStoreNames||h.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return v(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function g(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(c||(c=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.apply(y(this),r),v(l.get(this))}:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return v(t.apply(y(this),r))}:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=t.call(y(this),e,...n);return h.set(s,e.sort?e.sort():[e]),v(s)}}function m(t){return"function"===typeof t?g(t):(t instanceof IDBTransaction&&function(t){if(u.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),n()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));u.set(t,e)}(t),a(t,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,p):t)}function v(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(v(t.result)),n()},s=()=>{r(t.error),n()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&l.set(e,t)})).catch((()=>{})),f.set(e,t),e}(t);if(d.has(t))return d.get(t);const e=m(t);return e!==t&&(d.set(t,e),f.set(e,t)),e}const y=t=>f.get(t);const b=["get","getKey","getAll","getAllKeys","count"],E=["put","add","delete","clear"],w=new Map;function T(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(w.get(e))return w.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=E.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!b.includes(r))return;const s=async function(t){const e=this.transaction(t,i?"readwrite":"readonly");let s=e.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];return n&&(s=s.index(o.shift())),(await Promise.all([s[r](...o),i&&e.done]))[0]};return w.set(e,s),s}p=(t=>({...t,get:(e,r,n)=>T(e,r)||t.get(e,r,n),has:(e,r)=>!!T(e,r)||t.has(e,r)}))(p);class S{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null})).filter((t=>t)).join(" ")}}const _="@firebase/app",A="0.9.13",R=new i.Yd("@firebase/app"),C="[DEFAULT]",k={[_]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},O=new Map,I=new Map;function D(t,e){try{t.container.addComponent(e)}catch(r){R.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),r)}}function x(t){const e=t.name;if(I.has(e))return R.debug("There were multiple attempts to register component ".concat(e,".")),!1;I.set(e,t);for(const r of O.values())D(r,t);return!0}function L(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}const P={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},N=new s.LL("app","Firebase",P);class M{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new n.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw N.create("app-deleted",{appName:this._name})}}const F="9.23.0";function U(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t;if("object"!==typeof e){e={name:e}}const i=Object.assign({name:C,automaticDataCollectionEnabled:!1},e),a=i.name;if("string"!==typeof a||!a)throw N.create("bad-app-name",{appName:String(a)});if(r||(r=(0,s.aH)()),!r)throw N.create("no-options");const o=O.get(a);if(o){if((0,s.vZ)(r,o.options)&&(0,s.vZ)(i,o.config))return o;throw N.create("duplicate-app",{appName:a})}const c=new n.H0(a);for(const n of I.values())c.addComponent(n);const l=new M(r,i,c);return O.set(a,l),l}function B(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C;const e=O.get(t);if(!e&&t===C&&(0,s.aH)())return U();if(!e)throw N.create("no-app",{appName:t});return e}function j(t,e,r){var i;let s=null!==(i=k[t])&&void 0!==i?i:t;r&&(s+="-".concat(r));const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const t=['Unable to register library "'.concat(s,'" with version "').concat(e,'":')];return a&&t.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),a&&o&&t.push("and"),o&&t.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void R.warn(t.join(" "))}x(new n.wA("".concat(s,"-version"),(()=>({library:s,version:e})),"VERSION"))}const V="firebase-heartbeat-database",G=1,K="firebase-heartbeat-store";let H=null;function z(){return H||(H=function(t,e){let{blocked:r,upgrade:n,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(t,e),o=v(a);return n&&a.addEventListener("upgradeneeded",(t=>{n(v(a.result),t.oldVersion,t.newVersion,v(a.transaction),t)})),r&&a.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),o.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),o}(V,G,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(K)}}).catch((t=>{throw N.create("idb-open",{originalErrorMessage:t.message})}))),H}async function q(t,e){try{const r=(await z()).transaction(K,"readwrite"),n=r.objectStore(K);await n.put(e,W(t)),await r.done}catch(r){if(r instanceof s.ZR)R.warn(r.message);else{const t=N.create("idb-set",{originalErrorMessage:null===r||void 0===r?void 0:r.message});R.warn(t.message)}}}function W(t){return"".concat(t.name,"!").concat(t.options.appId)}class Y{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new X(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Z();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Z(),{heartbeatsToSend:e,unsentEntries:r}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const r=[];let n=t.slice();for(const i of t){const t=r.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),Q(r)>e){t.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Q(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),n=(0,s.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}}function Z(){return(new Date).toISOString().substring(0,10)}class X{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.hl)()&&(0,s.eu)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){try{const e=await z();return await e.transaction(K).objectStore(K).get(W(t))}catch(e){if(e instanceof s.ZR)R.warn(e.message);else{const t=N.create("idb-get",{originalErrorMessage:null===e||void 0===e?void 0:e.message});R.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return q(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return q(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}}}function Q(t){return(0,s.L)(JSON.stringify({version:2,heartbeats:t})).length}var $;$="",x(new n.wA("platform-logger",(t=>new S(t)),"PRIVATE")),x(new n.wA("heartbeat",(t=>new Y(t)),"PRIVATE")),j(_,A,$),j(_,A,"esm2017"),j("fire-js","")},2339:(t,e,r)=>{"use strict";r.d(e,{H0:()=>o,wA:()=>i});var n=r(4766);class i{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const s="[DEFAULT]";class a{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new n.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&t.resolve(r)}catch(r){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),n=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(n)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(const[t,r]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});r.resolve(t)}catch(e){}}}}clearInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(t)}getOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(t)||{}}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const n=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,s]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(i)&&s.resolve(n)}return n}onInit(t,e){var r;const n=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(n))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&t(s,n),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(t,e)}catch(n){}}getOrInitializeService(t){let{instanceIdentifier:e,options:r={}}=t,n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===s?void 0:i),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(a){}var i;return n||null}normalizeInstanceIdentifier(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?t:s:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new a(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},2413:(t,e,r)=>{"use strict";r.d(e,{Yd:()=>l,in:()=>i});const n=[];var i;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},a=i.INFO,o={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=function(t,e){if(e<t.logLevel)return;const r=(new Date).toISOString(),n=o[e];if(!n)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[n]("[".concat(r,"]  ").concat(t.name,":"),...s)};class l{constructor(t){this.name=t,this._logLevel=a,this._logHandler=c,this._userLogHandler=null,n.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in i))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?s[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}},5662:(t,e,r)=>{"use strict";r.d(e,{Z:()=>Wt});var n={};function i(t,e){return function(){return t.apply(e,arguments)}}r.r(n),r.d(n,{hasBrowserEnv:()=>nt,hasStandardBrowserEnv:()=>it,hasStandardBrowserWebWorkerEnv:()=>at});const{toString:s}=Object.prototype,{getPrototypeOf:a}=Object,o=(c=Object.create(null),t=>{const e=s.call(t);return c[e]||(c[e]=e.slice(8,-1).toLowerCase())});var c;const l=t=>(t=t.toLowerCase(),e=>o(e)===t),u=t=>e=>typeof e===t,{isArray:h}=Array,d=u("undefined");const f=l("ArrayBuffer");const p=u("string"),g=u("function"),m=u("number"),v=t=>null!==t&&"object"===typeof t,y=t=>{if("object"!==o(t))return!1;const e=a(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},b=l("Date"),E=l("File"),w=l("Blob"),T=l("FileList"),S=l("URLSearchParams");function _(t,e){let r,n,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),h(t))for(r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else{const n=i?Object.getOwnPropertyNames(t):Object.keys(t),s=n.length;let a;for(r=0;r<s;r++)a=n[r],e.call(null,t[a],a,t)}}function A(t,e){e=e.toLowerCase();const r=Object.keys(t);let n,i=r.length;for(;i-- >0;)if(n=r[i],e===n.toLowerCase())return n;return null}const R="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,C=t=>!d(t)&&t!==R;const k=(O="undefined"!==typeof Uint8Array&&a(Uint8Array),t=>O&&t instanceof O);var O;const I=l("HTMLFormElement"),D=(t=>{let{hasOwnProperty:e}=t;return(t,r)=>e.call(t,r)})(Object.prototype),x=l("RegExp"),L=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};_(r,((r,i)=>{let s;!1!==(s=e(r,i,t))&&(n[i]=s||r)})),Object.defineProperties(t,n)},P="abcdefghijklmnopqrstuvwxyz",N="0123456789",M={DIGIT:N,ALPHA:P,ALPHA_DIGIT:P+P.toUpperCase()+N};const F=l("AsyncFunction"),U={isArray:h,isArrayBuffer:f,isBuffer:function(t){return null!==t&&!d(t)&&null!==t.constructor&&!d(t.constructor)&&g(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||g(t.append)&&("formdata"===(e=o(t))||"object"===e&&g(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&f(t.buffer),e},isString:p,isNumber:m,isBoolean:t=>!0===t||!1===t,isObject:v,isPlainObject:y,isUndefined:d,isDate:b,isFile:E,isBlob:w,isRegExp:x,isFunction:g,isStream:t=>v(t)&&g(t.pipe),isURLSearchParams:S,isTypedArray:k,isFileList:T,forEach:_,merge:function t(){const{caseless:e}=C(this)&&this||{},r={},n=(n,i)=>{const s=e&&A(r,i)||i;y(r[s])&&y(n)?r[s]=t(r[s],n):y(n)?r[s]=t({},n):h(n)?r[s]=n.slice():r[s]=n};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&_(arguments[i],n);return r},extend:function(t,e,r){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _(e,((e,n)=>{r&&g(e)?t[n]=i(e,r):t[n]=e}),{allOwnKeys:n}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},toFlatObject:(t,e,r,n)=>{let i,s,o;const c={};if(e=e||{},null==t)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],n&&!n(o,t,e)||c[o]||(e[o]=t[o],c[o]=!0);t=!1!==r&&a(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},kindOf:o,kindOfTest:l,endsWith:(t,e,r)=>{t=String(t),(void 0===r||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return-1!==n&&n===r},toArray:t=>{if(!t)return null;if(h(t))return t;let e=t.length;if(!m(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},forEachEntry:(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let n;for(;(n=r.next())&&!n.done;){const r=n.value;e.call(t,r[0],r[1])}},matchAll:(t,e)=>{let r;const n=[];for(;null!==(r=t.exec(e));)n.push(r);return n},isHTMLForm:I,hasOwnProperty:D,hasOwnProp:D,reduceDescriptors:L,freezeMethods:t=>{L(t,((e,r)=>{if(g(t)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=t[r];g(n)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(t,e)=>{const r={},n=t=>{t.forEach((t=>{r[t]=!0}))};return h(t)?n(t):n(String(t).split(e)),r},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,r){return e.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(t,e)=>(t=+t,Number.isFinite(t)?t:e),findKey:A,global:R,isContextDefined:C,ALPHABET:M,generateString:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.ALPHA_DIGIT,r="";const{length:n}=e;for(;t--;)r+=e[Math.random()*n|0];return r},isSpecCompliantForm:function(t){return!!(t&&g(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),r=(t,n)=>{if(v(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[n]=t;const i=h(t)?[]:{};return _(t,((t,e)=>{const s=r(t,n+1);!d(s)&&(i[e]=s)})),e[n]=void 0,i}}return t};return r(t,0)},isAsyncFn:F,isThenable:t=>t&&(v(t)||g(t))&&g(t.then)&&g(t.catch)};function B(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}U.inherits(B,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:U.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const j=B.prototype,V={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{V[t]={value:t}})),Object.defineProperties(B,V),Object.defineProperty(j,"isAxiosError",{value:!0}),B.from=(t,e,r,n,i,s)=>{const a=Object.create(j);return U.toFlatObject(t,a,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),B.call(a,t.message,e,r,n,i),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const G=B;function K(t){return U.isPlainObject(t)||U.isArray(t)}function H(t){return U.endsWith(t,"[]")?t.slice(0,-2):t}function z(t,e,r){return t?t.concat(e).map((function(t,e){return t=H(t),!r&&e?"["+t+"]":t})).join(r?".":""):e}const q=U.toFlatObject(U,{},null,(function(t){return/^is[A-Z]/.test(t)}));const W=function(t,e,r){if(!U.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const n=(r=U.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!U.isUndefined(e[t])}))).metaTokens,i=r.visitor||l,s=r.dots,a=r.indexes,o=(r.Blob||"undefined"!==typeof Blob&&Blob)&&U.isSpecCompliantForm(e);if(!U.isFunction(i))throw new TypeError("visitor must be a function");function c(t){if(null===t)return"";if(U.isDate(t))return t.toISOString();if(!o&&U.isBlob(t))throw new G("Blob is not supported. Use a Buffer instead.");return U.isArrayBuffer(t)||U.isTypedArray(t)?o&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function l(t,r,i){let o=t;if(t&&!i&&"object"===typeof t)if(U.endsWith(r,"{}"))r=n?r:r.slice(0,-2),t=JSON.stringify(t);else if(U.isArray(t)&&function(t){return U.isArray(t)&&!t.some(K)}(t)||(U.isFileList(t)||U.endsWith(r,"[]"))&&(o=U.toArray(t)))return r=H(r),o.forEach((function(t,n){!U.isUndefined(t)&&null!==t&&e.append(!0===a?z([r],n,s):null===a?r:r+"[]",c(t))})),!1;return!!K(t)||(e.append(z(i,r,s),c(t)),!1)}const u=[],h=Object.assign(q,{defaultVisitor:l,convertValue:c,isVisitable:K});if(!U.isObject(t))throw new TypeError("data must be an object");return function t(r,n){if(!U.isUndefined(r)){if(-1!==u.indexOf(r))throw Error("Circular reference detected in "+n.join("."));u.push(r),U.forEach(r,(function(r,s){!0===(!(U.isUndefined(r)||null===r)&&i.call(e,r,U.isString(s)?s.trim():s,n,h))&&t(r,n?n.concat(s):[s])})),u.pop()}}(t),e};function Y(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function Z(t,e){this._pairs=[],t&&W(t,this,e)}const X=Z.prototype;X.append=function(t,e){this._pairs.push([t,e])},X.toString=function(t){const e=t?function(e){return t.call(this,e,Y)}:Y;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const Q=Z;function $(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function J(t,e,r){if(!e)return t;const n=r&&r.encode||$,i=r&&r.serialize;let s;if(s=i?i(e,r):U.isURLSearchParams(e)?e.toString():new Q(e,r).toString(n),s){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}const tt=class{constructor(){this.handlers=[]}use(t,e,r){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){U.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},et={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},rt={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Q,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},nt="undefined"!==typeof window&&"undefined"!==typeof document,it=(st="undefined"!==typeof navigator&&navigator.product,nt&&["ReactNative","NativeScript","NS"].indexOf(st)<0);var st;const at="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,ot={...n,...rt};const ct=function(t){function e(t,r,n,i){let s=t[i++];const a=Number.isFinite(+s),o=i>=t.length;if(s=!s&&U.isArray(n)?n.length:s,o)return U.hasOwnProp(n,s)?n[s]=[n[s],r]:n[s]=r,!a;n[s]&&U.isObject(n[s])||(n[s]=[]);return e(t,r,n[s],i)&&U.isArray(n[s])&&(n[s]=function(t){const e={},r=Object.keys(t);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],e[s]=t[s];return e}(n[s])),!a}if(U.isFormData(t)&&U.isFunction(t.entries)){const r={};return U.forEachEntry(t,((t,n)=>{e(function(t){return U.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),n,r,0)})),r}return null};const lt={transitional:et,adapter:["xhr","http"],transformRequest:[function(t,e){const r=e.getContentType()||"",n=r.indexOf("application/json")>-1,i=U.isObject(t);i&&U.isHTMLForm(t)&&(t=new FormData(t));if(U.isFormData(t))return n&&n?JSON.stringify(ct(t)):t;if(U.isArrayBuffer(t)||U.isBuffer(t)||U.isStream(t)||U.isFile(t)||U.isBlob(t))return t;if(U.isArrayBufferView(t))return t.buffer;if(U.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return W(t,new ot.classes.URLSearchParams,Object.assign({visitor:function(t,e,r,n){return ot.isNode&&U.isBuffer(t)?(this.append(e,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((s=U.isFileList(t))||r.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return W(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return i||n?(e.setContentType("application/json",!1),function(t,e,r){if(U.isString(t))try{return(e||JSON.parse)(t),U.trim(t)}catch(n){if("SyntaxError"!==n.name)throw n}return(r||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||lt.transitional,r=e&&e.forcedJSONParsing,n="json"===this.responseType;if(t&&U.isString(t)&&(r&&!this.responseType||n)){const r=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(i){if(r){if("SyntaxError"===i.name)throw G.from(i,G.ERR_BAD_RESPONSE,this,null,this.response);throw i}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ot.classes.FormData,Blob:ot.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};U.forEach(["delete","get","head","post","put","patch"],(t=>{lt.headers[t]={}}));const ut=lt,ht=U.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),dt=Symbol("internals");function ft(t){return t&&String(t).trim().toLowerCase()}function pt(t){return!1===t||null==t?t:U.isArray(t)?t.map(pt):String(t)}function gt(t,e,r,n,i){return U.isFunction(n)?n.call(this,e,r):(i&&(e=r),U.isString(e)?U.isString(n)?-1!==e.indexOf(n):U.isRegExp(n)?n.test(e):void 0:void 0)}class mt{constructor(t){t&&this.set(t)}set(t,e,r){const n=this;function i(t,e,r){const i=ft(e);if(!i)throw new Error("header name must be a non-empty string");const s=U.findKey(n,i);(!s||void 0===n[s]||!0===r||void 0===r&&!1!==n[s])&&(n[s||e]=pt(t))}const s=(t,e)=>U.forEach(t,((t,r)=>i(t,r,e)));return U.isPlainObject(t)||t instanceof this.constructor?s(t,e):U.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim())?s((t=>{const e={};let r,n,i;return t&&t.split("\n").forEach((function(t){i=t.indexOf(":"),r=t.substring(0,i).trim().toLowerCase(),n=t.substring(i+1).trim(),!r||e[r]&&ht[r]||("set-cookie"===r?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)})),e})(t),e):null!=t&&i(e,t,r),this}get(t,e){if(t=ft(t)){const r=U.findKey(this,t);if(r){const t=this[r];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}(t);if(U.isFunction(e))return e.call(this,t,r);if(U.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=ft(t)){const r=U.findKey(this,t);return!(!r||void 0===this[r]||e&&!gt(0,this[r],r,e))}return!1}delete(t,e){const r=this;let n=!1;function i(t){if(t=ft(t)){const i=U.findKey(r,t);!i||e&&!gt(0,r[i],i,e)||(delete r[i],n=!0)}}return U.isArray(t)?t.forEach(i):i(t),n}clear(t){const e=Object.keys(this);let r=e.length,n=!1;for(;r--;){const i=e[r];t&&!gt(0,this[i],i,t,!0)||(delete this[i],n=!0)}return n}normalize(t){const e=this,r={};return U.forEach(this,((n,i)=>{const s=U.findKey(r,i);if(s)return e[s]=pt(n),void delete e[i];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,r)=>e.toUpperCase()+r))}(i):String(i).trim();a!==i&&delete e[i],e[a]=pt(n),r[a]=!0})),this}concat(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return U.forEach(this,((r,n)=>{null!=r&&!1!==r&&(e[n]=t&&U.isArray(r)?r.join(", "):r)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((t=>{let[e,r]=t;return e+": "+r})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((t=>e.set(t))),e}static accessor(t){const e=(this[dt]=this[dt]={accessors:{}}).accessors,r=this.prototype;function n(t){const n=ft(t);e[n]||(!function(t,e){const r=U.toCamelCase(" "+e);["get","set","has"].forEach((n=>{Object.defineProperty(t,n+r,{value:function(t,r,i){return this[n].call(this,e,t,r,i)},configurable:!0})}))}(r,t),e[n]=!0)}return U.isArray(t)?t.forEach(n):n(t),this}}mt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),U.reduceDescriptors(mt.prototype,((t,e)=>{let{value:r}=t,n=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(t){this[n]=t}}})),U.freezeMethods(mt);const vt=mt;function yt(t,e){const r=this||ut,n=e||r,i=vt.from(n.headers);let s=n.data;return U.forEach(t,(function(t){s=t.call(r,s,i.normalize(),e?e.status:void 0)})),i.normalize(),s}function bt(t){return!(!t||!t.__CANCEL__)}function Et(t,e,r){G.call(this,null==t?"canceled":t,G.ERR_CANCELED,e,r),this.name="CanceledError"}U.inherits(Et,G,{__CANCEL__:!0});const wt=Et;const Tt=ot.hasStandardBrowserEnv?{write:function(t,e,r,n,i,s){const a=[];a.push(t+"="+encodeURIComponent(e)),U.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),U.isString(n)&&a.push("path="+n),U.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function St(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const _t=ot.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let r;function n(r){let n=r;return t&&(e.setAttribute("href",n),n=e.href),e.setAttribute("href",n),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return r=n(window.location.href),function(t){const e=U.isString(t)?n(t):t;return e.protocol===r.protocol&&e.host===r.host}}():function(){return!0};const At=function(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i,s=0,a=0;return e=void 0!==e?e:1e3,function(o){const c=Date.now(),l=n[a];i||(i=c),r[s]=o,n[s]=c;let u=a,h=0;for(;u!==s;)h+=r[u++],u%=t;if(s=(s+1)%t,s===a&&(a=(a+1)%t),c-i<e)return;const d=l&&c-l;return d?Math.round(1e3*h/d):void 0}};function Rt(t,e){let r=0;const n=At(50,250);return i=>{const s=i.loaded,a=i.lengthComputable?i.total:void 0,o=s-r,c=n(o);r=s;const l={loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:c||void 0,estimated:c&&a&&s<=a?(a-s)/c:void 0,event:i};l[e?"download":"upload"]=!0,t(l)}}const Ct={http:null,xhr:"undefined"!==typeof XMLHttpRequest&&function(t){return new Promise((function(e,r){let n=t.data;const i=vt.from(t.headers).normalize(),s=t.responseType;let a,o;function c(){t.cancelToken&&t.cancelToken.unsubscribe(a),t.signal&&t.signal.removeEventListener("abort",a)}if(U.isFormData(n))if(ot.hasStandardBrowserEnv||ot.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if(!1!==(o=i.getContentType())){const[t,...e]=o?o.split(";").map((t=>t.trim())).filter(Boolean):[];i.setContentType([t||"multipart/form-data",...e].join("; "))}let l=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",r=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.set("Authorization","Basic "+btoa(e+":"+r))}const u=St(t.baseURL,t.url);function h(){if(!l)return;const n=vt.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(t,e,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?e(new G("Request failed with status code "+r.status,[G.ERR_BAD_REQUEST,G.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):t(r)}((function(t){e(t),c()}),(function(t){r(t),c()}),{data:s&&"text"!==s&&"json"!==s?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:n,config:t,request:l}),l=null}if(l.open(t.method.toUpperCase(),J(u,t.params,t.paramsSerializer),!0),l.timeout=t.timeout,"onloadend"in l?l.onloadend=h:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(h)},l.onabort=function(){l&&(r(new G("Request aborted",G.ECONNABORTED,t,l)),l=null)},l.onerror=function(){r(new G("Network Error",G.ERR_NETWORK,t,l)),l=null},l.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const n=t.transitional||et;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),r(new G(e,n.clarifyTimeoutError?G.ETIMEDOUT:G.ECONNABORTED,t,l)),l=null},ot.hasStandardBrowserEnv){const e=_t(u)&&t.xsrfCookieName&&Tt.read(t.xsrfCookieName);e&&i.set(t.xsrfHeaderName,e)}void 0===n&&i.setContentType(null),"setRequestHeader"in l&&U.forEach(i.toJSON(),(function(t,e){l.setRequestHeader(e,t)})),U.isUndefined(t.withCredentials)||(l.withCredentials=!!t.withCredentials),s&&"json"!==s&&(l.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&l.addEventListener("progress",Rt(t.onDownloadProgress,!0)),"function"===typeof t.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Rt(t.onUploadProgress)),(t.cancelToken||t.signal)&&(a=e=>{l&&(r(!e||e.type?new wt(null,t,l):e),l.abort(),l=null)},t.cancelToken&&t.cancelToken.subscribe(a),t.signal&&(t.signal.aborted?a():t.signal.addEventListener("abort",a)));const d=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(u);d&&-1===ot.protocols.indexOf(d)?r(new G("Unsupported protocol "+d+":",G.ERR_BAD_REQUEST,t)):l.send(n||null)}))}};U.forEach(Ct,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(r){}Object.defineProperty(t,"adapterName",{value:e})}}));const kt=t=>"- ".concat(t),Ot=t=>U.isFunction(t)||null===t||!1===t,It=t=>{t=U.isArray(t)?t:[t];const{length:e}=t;let r,n;const i={};for(let s=0;s<e;s++){let e;if(r=t[s],n=r,!Ot(r)&&(n=Ct[(e=String(r)).toLowerCase()],void 0===n))throw new G("Unknown adapter '".concat(e,"'"));if(n)break;i[e||"#"+s]=n}if(!n){const t=Object.entries(i).map((t=>{let[e,r]=t;return"adapter ".concat(e," ")+(!1===r?"is not supported by the environment":"is not available in the build")}));let r=e?t.length>1?"since :\n"+t.map(kt).join("\n"):" "+kt(t[0]):"as no adapter specified";throw new G("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return n};function Dt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new wt(null,t)}function xt(t){Dt(t),t.headers=vt.from(t.headers),t.data=yt.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return It(t.adapter||ut.adapter)(t).then((function(e){return Dt(t),e.data=yt.call(t,t.transformResponse,e),e.headers=vt.from(e.headers),e}),(function(e){return bt(e)||(Dt(t),e&&e.response&&(e.response.data=yt.call(t,t.transformResponse,e.response),e.response.headers=vt.from(e.response.headers))),Promise.reject(e)}))}const Lt=t=>t instanceof vt?t.toJSON():t;function Pt(t,e){e=e||{};const r={};function n(t,e,r){return U.isPlainObject(t)&&U.isPlainObject(e)?U.merge.call({caseless:r},t,e):U.isPlainObject(e)?U.merge({},e):U.isArray(e)?e.slice():e}function i(t,e,r){return U.isUndefined(e)?U.isUndefined(t)?void 0:n(void 0,t,r):n(t,e,r)}function s(t,e){if(!U.isUndefined(e))return n(void 0,e)}function a(t,e){return U.isUndefined(e)?U.isUndefined(t)?void 0:n(void 0,t):n(void 0,e)}function o(r,i,s){return s in e?n(r,i):s in t?n(void 0,r):void 0}const c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(t,e)=>i(Lt(t),Lt(e),!0)};return U.forEach(Object.keys(Object.assign({},t,e)),(function(n){const s=c[n]||i,a=s(t[n],e[n],n);U.isUndefined(a)&&s!==o||(r[n]=a)})),r}const Nt="1.6.1",Mt={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{Mt[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}}));const Ft={};Mt.transitional=function(t,e,r){function n(t,e){return"[Axios v1.6.1] Transitional option '"+t+"'"+e+(r?". "+r:"")}return(r,i,s)=>{if(!1===t)throw new G(n(i," has been removed"+(e?" in "+e:"")),G.ERR_DEPRECATED);return e&&!Ft[i]&&(Ft[i]=!0,console.warn(n(i," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(r,i,s)}};const Ut={assertOptions:function(t,e,r){if("object"!==typeof t)throw new G("options must be an object",G.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const s=n[i],a=e[s];if(a){const e=t[s],r=void 0===e||a(e,s,t);if(!0!==r)throw new G("option "+s+" must be "+r,G.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new G("Unknown option "+s,G.ERR_BAD_OPTION)}},validators:Mt},Bt=Ut.validators;class jt{constructor(t){this.defaults=t,this.interceptors={request:new tt,response:new tt}}request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=Pt(this.defaults,e);const{transitional:r,paramsSerializer:n,headers:i}=e;void 0!==r&&Ut.assertOptions(r,{silentJSONParsing:Bt.transitional(Bt.boolean),forcedJSONParsing:Bt.transitional(Bt.boolean),clarifyTimeoutError:Bt.transitional(Bt.boolean)},!1),null!=n&&(U.isFunction(n)?e.paramsSerializer={serialize:n}:Ut.assertOptions(n,{encode:Bt.function,serialize:Bt.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=i&&U.merge(i.common,i[e.method]);i&&U.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete i[t]})),e.headers=vt.concat(s,i);const a=[];let o=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,a.unshift(t.fulfilled,t.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(t){c.push(t.fulfilled,t.rejected)}));let u,h=0;if(!o){const t=[xt.bind(this),void 0];for(t.unshift.apply(t,a),t.push.apply(t,c),u=t.length,l=Promise.resolve(e);h<u;)l=l.then(t[h++],t[h++]);return l}u=a.length;let d=e;for(h=0;h<u;){const t=a[h++],e=a[h++];try{d=t(d)}catch(f){e.call(this,f);break}}try{l=xt.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=c.length;h<u;)l=l.then(c[h++],c[h++]);return l}getUri(t){return J(St((t=Pt(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}U.forEach(["delete","get","head","options"],(function(t){jt.prototype[t]=function(e,r){return this.request(Pt(r||{},{method:t,url:e,data:(r||{}).data}))}})),U.forEach(["post","put","patch"],(function(t){function e(e){return function(r,n,i){return this.request(Pt(i||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}jt.prototype[t]=e(),jt.prototype[t+"Form"]=e(!0)}));const Vt=jt;class Gt{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const r=this;this.promise.then((t=>{if(!r._listeners)return;let e=r._listeners.length;for(;e-- >0;)r._listeners[e](t);r._listeners=null})),this.promise.then=t=>{let e;const n=new Promise((t=>{r.subscribe(t),e=t})).then(t);return n.cancel=function(){r.unsubscribe(e)},n},t((function(t,n,i){r.reason||(r.reason=new wt(t,n,i),e(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;return{token:new Gt((function(e){t=e})),cancel:t}}}const Kt=Gt;const Ht={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ht).forEach((t=>{let[e,r]=t;Ht[r]=e}));const zt=Ht;const qt=function t(e){const r=new Vt(e),n=i(Vt.prototype.request,r);return U.extend(n,Vt.prototype,r,{allOwnKeys:!0}),U.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return t(Pt(e,r))},n}(ut);qt.Axios=Vt,qt.CanceledError=wt,qt.CancelToken=Kt,qt.isCancel=bt,qt.VERSION=Nt,qt.toFormData=W,qt.AxiosError=G,qt.Cancel=qt.CanceledError,qt.all=function(t){return Promise.all(t)},qt.spread=function(t){return function(e){return t.apply(null,e)}},qt.isAxiosError=function(t){return U.isObject(t)&&!0===t.isAxiosError},qt.mergeConfig=Pt,qt.AxiosHeaders=vt,qt.formToJSON=t=>ct(U.isHTMLForm(t)?new FormData(t):t),qt.getAdapter=It,qt.HttpStatusCode=zt,qt.default=qt;const Wt=qt},4146:(t,e,r)=>{"use strict";function n(t){var e,r,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=n(t[e]))&&(i&&(i+=" "),i+=r);else for(e in t)t[e]&&(i&&(i+=" "),i+=e);return i}r.d(e,{Z:()=>i});const i=function(){for(var t,e,r=0,i="";r<arguments.length;)(t=arguments[r++])&&(e=n(t))&&(i&&(i+=" "),i+=e);return i}},421:(t,e,r)=>{"use strict";r.d(e,{ZF:()=>n.ZF});var n=r(904);(0,n.KN)("firebase","9.23.0","app")},3749:(t,e,r)=>{"use strict";r.d(e,{Ab:()=>n.Ab,ET:()=>n.ET,IO:()=>n.IO,JU:()=>n.JU,QT:()=>n.QT,ar:()=>n.ar,b9:()=>n.b9,cf:()=>n.cf,hJ:()=>n.hJ,oe:()=>n.oe,pl:()=>n.pl,r7:()=>n.r7,vr:()=>n.vr});var n=r(851)},2036:(t,e,r)=>{"use strict";r.d(e,{Ix:()=>A,Am:()=>N});var n=r(7313);function i(t){var e,r,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=i(t[e]))&&(n&&(n+=" "),n+=r);else for(e in t)t[e]&&(n&&(n+=" "),n+=e);return n}const s=function(){for(var t,e,r=0,n="";r<arguments.length;)(t=arguments[r++])&&(e=i(t))&&(n&&(n+=" "),n+=e);return n},a=t=>"number"==typeof t&&!isNaN(t),o=t=>"string"==typeof t,c=t=>"function"==typeof t,l=t=>o(t)||c(t)?t:null,u=t=>(0,n.isValidElement)(t)||o(t)||c(t)||a(t);function h(t){let{enter:e,exit:r,appendPosition:i=!1,collapse:s=!0,collapseDuration:a=300}=t;return function(t){let{children:o,position:c,preventExitTransition:l,done:u,nodeRef:h,isIn:d}=t;const f=i?"".concat(e,"--").concat(c):e,p=i?"".concat(r,"--").concat(c):r,g=(0,n.useRef)(0);return(0,n.useLayoutEffect)((()=>{const t=h.current,e=f.split(" "),r=n=>{n.target===h.current&&(t.dispatchEvent(new Event("d")),t.removeEventListener("animationend",r),t.removeEventListener("animationcancel",r),0===g.current&&"animationcancel"!==n.type&&t.classList.remove(...e))};t.classList.add(...e),t.addEventListener("animationend",r),t.addEventListener("animationcancel",r)}),[]),(0,n.useEffect)((()=>{const t=h.current,e=()=>{t.removeEventListener("animationend",e),s?function(t,e,r){void 0===r&&(r=300);const{scrollHeight:n,style:i}=t;requestAnimationFrame((()=>{i.minHeight="initial",i.height=n+"px",i.transition="all ".concat(r,"ms"),requestAnimationFrame((()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,r)}))}))}(t,u,a):u()};d||(l?e():(g.current=1,t.className+=" ".concat(p),t.addEventListener("animationend",e)))}),[d]),n.createElement(n.Fragment,null,o)}}function d(t,e){return null!=t?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const f={list:new Map,emitQueue:new Map,on(t,e){return this.list.has(t)||this.list.set(t,[]),this.list.get(t).push(e),this},off(t,e){if(e){const r=this.list.get(t).filter((t=>t!==e));return this.list.set(t,r),this}return this.list.delete(t),this},cancelEmit(t){const e=this.emitQueue.get(t);return e&&(e.forEach(clearTimeout),this.emitQueue.delete(t)),this},emit(t){this.list.has(t)&&this.list.get(t).forEach((e=>{const r=setTimeout((()=>{e(...[].slice.call(arguments,1))}),0);this.emitQueue.has(t)||this.emitQueue.set(t,[]),this.emitQueue.get(t).push(r)}))}},p=t=>{let{theme:e,type:r,...i}=t;return n.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===e?"currentColor":"var(--toastify-icon-color-".concat(r,")"),...i})},g={info:function(t){return n.createElement(p,{...t},n.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return n.createElement(p,{...t},n.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return n.createElement(p,{...t},n.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return n.createElement(p,{...t},n.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return n.createElement("div",{className:"Toastify__spinner"})}};function m(t){const[,e]=(0,n.useReducer)((t=>t+1),0),[r,i]=(0,n.useState)([]),s=(0,n.useRef)(null),h=(0,n.useRef)(new Map).current,p=t=>-1!==r.indexOf(t),m=(0,n.useRef)({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:p,getToast:t=>h.get(t)}).current;function v(t){let{containerId:e}=t;const{limit:r}=m.props;!r||e&&m.containerId!==e||(m.count-=m.queue.length,m.queue=[])}function y(t){i((e=>null==t?[]:e.filter((e=>e!==t))))}function b(){const{toastContent:t,toastProps:e,staleId:r}=m.queue.shift();w(t,e,r)}function E(t,r){let{delay:i,staleId:p,...v}=r;if(!u(t)||function(t){return!s.current||m.props.enableMultiContainer&&t.containerId!==m.props.containerId||h.has(t.toastId)&&null==t.updateId}(v))return;const{toastId:E,updateId:T,data:S}=v,{props:_}=m,A=()=>y(E),R=null==T;R&&m.count++;const C={..._,style:_.toastStyle,key:m.toastKey++,...Object.fromEntries(Object.entries(v).filter((t=>{let[e,r]=t;return null!=r}))),toastId:E,updateId:T,data:S,closeToast:A,isIn:!1,className:l(v.className||_.toastClassName),bodyClassName:l(v.bodyClassName||_.bodyClassName),progressClassName:l(v.progressClassName||_.progressClassName),autoClose:!v.isLoading&&(k=v.autoClose,O=_.autoClose,!1===k||a(k)&&k>0?k:O),deleteToast(){const t=d(h.get(E),"removed");h.delete(E),f.emit(4,t);const r=m.queue.length;if(m.count=null==E?m.count-m.displayedToast:m.count-1,m.count<0&&(m.count=0),r>0){const t=null==E?m.props.limit:1;if(1===r||1===t)m.displayedToast++,b();else{const e=t>r?r:t;m.displayedToast=e;for(let t=0;t<e;t++)b()}}else e()}};var k,O;C.iconOut=function(t){let{theme:e,type:r,isLoading:i,icon:s}=t,l=null;const u={theme:e,type:r};return!1===s||(c(s)?l=s(u):(0,n.isValidElement)(s)?l=(0,n.cloneElement)(s,u):o(s)||a(s)?l=s:i?l=g.spinner():(t=>t in g)(r)&&(l=g[r](u))),l}(C),c(v.onOpen)&&(C.onOpen=v.onOpen),c(v.onClose)&&(C.onClose=v.onClose),C.closeButton=_.closeButton,!1===v.closeButton||u(v.closeButton)?C.closeButton=v.closeButton:!0===v.closeButton&&(C.closeButton=!u(_.closeButton)||_.closeButton);let I=t;(0,n.isValidElement)(t)&&!o(t.type)?I=(0,n.cloneElement)(t,{closeToast:A,toastProps:C,data:S}):c(t)&&(I=t({closeToast:A,toastProps:C,data:S})),_.limit&&_.limit>0&&m.count>_.limit&&R?m.queue.push({toastContent:I,toastProps:C,staleId:p}):a(i)?setTimeout((()=>{w(I,C,p)}),i):w(I,C,p)}function w(t,e,r){const{toastId:n}=e;r&&h.delete(r);const s={content:t,props:e};h.set(n,s),i((t=>[...t,n].filter((t=>t!==r)))),f.emit(4,d(s,null==s.props.updateId?"added":"updated"))}return(0,n.useEffect)((()=>(m.containerId=t.containerId,f.cancelEmit(3).on(0,E).on(1,(t=>s.current&&y(t))).on(5,v).emit(2,m),()=>{h.clear(),f.emit(3,m)})),[]),(0,n.useEffect)((()=>{m.props=t,m.isToastActive=p,m.displayedToast=r.length})),{getToastToRender:function(e){const r=new Map,n=Array.from(h.values());return t.newestOnTop&&n.reverse(),n.forEach((t=>{const{position:e}=t.props;r.has(e)||r.set(e,[]),r.get(e).push(t)})),Array.from(r,(t=>e(t[0],t[1])))},containerRef:s,isToastActive:p}}function v(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function y(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function b(t){const[e,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),a=(0,n.useRef)(null),o=(0,n.useRef)({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,l=(0,n.useRef)(t),{autoClose:u,pauseOnHover:h,closeToast:d,onClick:f,closeOnClick:p}=t;function g(e){if(t.draggable){"touchstart"===e.nativeEvent.type&&e.nativeEvent.preventDefault(),o.didMove=!1,document.addEventListener("mousemove",w),document.addEventListener("mouseup",T),document.addEventListener("touchmove",w),document.addEventListener("touchend",T);const r=a.current;o.canCloseOnClick=!0,o.canDrag=!0,o.boundingRect=r.getBoundingClientRect(),r.style.transition="",o.x=v(e.nativeEvent),o.y=y(e.nativeEvent),"x"===t.draggableDirection?(o.start=o.x,o.removalDistance=r.offsetWidth*(t.draggablePercent/100)):(o.start=o.y,o.removalDistance=r.offsetHeight*(80===t.draggablePercent?1.5*t.draggablePercent:t.draggablePercent/100))}}function m(e){if(o.boundingRect){const{top:r,bottom:n,left:i,right:s}=o.boundingRect;"touchend"!==e.nativeEvent.type&&t.pauseOnHover&&o.x>=i&&o.x<=s&&o.y>=r&&o.y<=n?E():b()}}function b(){r(!0)}function E(){r(!1)}function w(r){const n=a.current;o.canDrag&&n&&(o.didMove=!0,e&&E(),o.x=v(r),o.y=y(r),o.delta="x"===t.draggableDirection?o.x-o.start:o.y-o.start,o.start!==o.x&&(o.canCloseOnClick=!1),n.style.transform="translate".concat(t.draggableDirection,"(").concat(o.delta,"px)"),n.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function T(){document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",T),document.removeEventListener("touchmove",w),document.removeEventListener("touchend",T);const e=a.current;if(o.canDrag&&o.didMove&&e){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),void t.closeToast();e.style.transition="transform 0.2s, opacity 0.2s",e.style.transform="translate".concat(t.draggableDirection,"(0)"),e.style.opacity="1"}}(0,n.useEffect)((()=>{l.current=t})),(0,n.useEffect)((()=>(a.current&&a.current.addEventListener("d",b,{once:!0}),c(t.onOpen)&&t.onOpen((0,n.isValidElement)(t.children)&&t.children.props),()=>{const t=l.current;c(t.onClose)&&t.onClose((0,n.isValidElement)(t.children)&&t.children.props)})),[]),(0,n.useEffect)((()=>(t.pauseOnFocusLoss&&(document.hasFocus()||E(),window.addEventListener("focus",b),window.addEventListener("blur",E)),()=>{t.pauseOnFocusLoss&&(window.removeEventListener("focus",b),window.removeEventListener("blur",E))})),[t.pauseOnFocusLoss]);const S={onMouseDown:g,onTouchStart:g,onMouseUp:m,onTouchEnd:m};return u&&h&&(S.onMouseEnter=E,S.onMouseLeave=b),p&&(S.onClick=t=>{f&&f(t),o.canCloseOnClick&&d()}),{playToast:b,pauseToast:E,isRunning:e,preventExitTransition:i,toastRef:a,eventHandlers:S}}function E(t){let{closeToast:e,theme:r,ariaLabel:i="close"}=t;return n.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(r),type:"button",onClick:t=>{t.stopPropagation(),e(t)},"aria-label":i},n.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},n.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function w(t){let{delay:e,isRunning:r,closeToast:i,type:a="default",hide:o,className:l,style:u,controlledProgress:h,progress:d,rtl:f,isIn:p,theme:g}=t;const m=o||h&&0===d,v={...u,animationDuration:"".concat(e,"ms"),animationPlayState:r?"running":"paused",opacity:m?0:1};h&&(v.transform="scaleX(".concat(d,")"));const y=s("Toastify__progress-bar",h?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(g),"Toastify__progress-bar--".concat(a),{"Toastify__progress-bar--rtl":f}),b=c(l)?l({rtl:f,type:a,defaultClassName:y}):s(y,l);return n.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:b,style:v,[h&&d>=1?"onTransitionEnd":"onAnimationEnd"]:h&&d<1?null:()=>{p&&i()}})}const T=t=>{const{isRunning:e,preventExitTransition:r,toastRef:i,eventHandlers:a}=b(t),{closeButton:o,children:l,autoClose:u,onClick:h,type:d,hideProgressBar:f,closeToast:p,transition:g,position:m,className:v,style:y,bodyClassName:T,bodyStyle:S,progressClassName:_,progressStyle:A,updateId:R,role:C,progress:k,rtl:O,toastId:I,deleteToast:D,isIn:x,isLoading:L,iconOut:P,closeOnClick:N,theme:M}=t,F=s("Toastify__toast","Toastify__toast-theme--".concat(M),"Toastify__toast--".concat(d),{"Toastify__toast--rtl":O},{"Toastify__toast--close-on-click":N}),U=c(v)?v({rtl:O,position:m,type:d,defaultClassName:F}):s(F,v),B=!!k||!u,j={closeToast:p,type:d,theme:M};let V=null;return!1===o||(V=c(o)?o(j):(0,n.isValidElement)(o)?(0,n.cloneElement)(o,j):E(j)),n.createElement(g,{isIn:x,done:D,position:m,preventExitTransition:r,nodeRef:i},n.createElement("div",{id:I,onClick:h,className:U,...a,style:y,ref:i},n.createElement("div",{...x&&{role:C},className:c(T)?T({type:d}):s("Toastify__toast-body",T),style:S},null!=P&&n.createElement("div",{className:s("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!L})},P),n.createElement("div",null,l)),V,n.createElement(w,{...R&&!B?{key:"pb-".concat(R)}:{},rtl:O,theme:M,delay:u,isRunning:e,isIn:x,closeToast:p,hide:f,type:d,style:A,className:_,controlledProgress:B,progress:k||0})))},S=function(t,e){return void 0===e&&(e=!1),{enter:"Toastify--animate Toastify__".concat(t,"-enter"),exit:"Toastify--animate Toastify__".concat(t,"-exit"),appendPosition:e}},_=h(S("bounce",!0)),A=(h(S("slide",!0)),h(S("zoom")),h(S("flip")),(0,n.forwardRef)(((t,e)=>{const{getToastToRender:r,containerRef:i,isToastActive:a}=m(t),{className:o,style:u,rtl:h,containerId:d}=t;function f(t){const e=s("Toastify__toast-container","Toastify__toast-container--".concat(t),{"Toastify__toast-container--rtl":h});return c(o)?o({position:t,rtl:h,defaultClassName:e}):s(e,l(o))}return(0,n.useEffect)((()=>{e&&(e.current=i.current)}),[]),n.createElement("div",{ref:i,className:"Toastify",id:d},r(((t,e)=>{const r=e.length?{...u}:{...u,pointerEvents:"none"};return n.createElement("div",{className:f(t),style:r,key:"container-".concat(t)},e.map(((t,r)=>{let{content:i,props:s}=t;return n.createElement(T,{...s,isIn:a(s.toastId),style:{...s.style,"--nth":r+1,"--len":e.length},key:"toast-".concat(s.key)},i)})))})))})));A.displayName="ToastContainer",A.defaultProps={position:"top-right",transition:_,autoClose:5e3,closeButton:E,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let R,C=new Map,k=[],O=1;function I(){return""+O++}function D(t){return t&&(o(t.toastId)||a(t.toastId))?t.toastId:I()}function x(t,e){return C.size>0?f.emit(0,t,e):k.push({content:t,options:e}),e.toastId}function L(t,e){return{...e,type:e&&e.type||t,toastId:D(e)}}function P(t){return(e,r)=>x(e,L(t,r))}function N(t,e){return x(t,L("default",e))}N.loading=(t,e)=>x(t,L("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),N.promise=function(t,e,r){let n,{pending:i,error:s,success:a}=e;i&&(n=o(i)?N.loading(i,r):N.loading(i.render,{...r,...i}));const l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(t,e,i)=>{if(null==e)return void N.dismiss(n);const s={type:t,...l,...r,data:i},a=o(e)?{render:e}:e;return n?N.update(n,{...s,...a}):N(a.render,{...s,...a}),i},h=c(t)?t():t;return h.then((t=>u("success",a,t))).catch((t=>u("error",s,t))),h},N.success=P("success"),N.info=P("info"),N.error=P("error"),N.warning=P("warning"),N.warn=N.warning,N.dark=(t,e)=>x(t,L("default",{theme:"dark",...e})),N.dismiss=t=>{C.size>0?f.emit(1,t):k=k.filter((e=>null!=t&&e.options.toastId!==t))},N.clearWaitingQueue=function(t){return void 0===t&&(t={}),f.emit(5,t)},N.isActive=t=>{let e=!1;return C.forEach((r=>{r.isToastActive&&r.isToastActive(t)&&(e=!0)})),e},N.update=function(t,e){void 0===e&&(e={}),setTimeout((()=>{const r=function(t,e){let{containerId:r}=e;const n=C.get(r||R);return n&&n.getToast(t)}(t,e);if(r){const{props:n,content:i}=r,s={delay:100,...n,...e,toastId:e.toastId||t,updateId:I()};s.toastId!==t&&(s.staleId=t);const a=s.render||i;delete s.render,x(a,s)}}),0)},N.done=t=>{N.update(t,{progress:1})},N.onChange=t=>(f.on(4,t),()=>{f.off(4,t)}),N.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},N.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},f.on(2,(t=>{R=t.containerId||t,C.set(R,t),k.forEach((t=>{f.emit(0,t.content,t.options)})),k=[]})).on(3,(t=>{C.delete(t.containerId||t),0===C.size&&f.off(0).off(1).off(5)}))}}]);